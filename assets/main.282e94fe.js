var lu=Object.defineProperty,au=Object.defineProperties;var cu=Object.getOwnPropertyDescriptors;var Os=Object.getOwnPropertySymbols;var uu=Object.prototype.hasOwnProperty,du=Object.prototype.propertyIsEnumerable;var er=(t,e,n)=>e in t?lu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,z=(t,e)=>{for(var n in e||(e={}))uu.call(e,n)&&er(t,n,e[n]);if(Os)for(var n of Os(e))du.call(e,n)&&er(t,n,e[n]);return t},j=(t,e)=>au(t,cu(e));var oo=(t,e,n)=>(er(t,typeof e!="symbol"?e+"":e,n),n);import{r as y,j as zr,Y as Wr,a as Nt,b as Cl,D as Eo,c as fu,d as hu,e as gu,f as pu,g as mu,h as _u,U as xu,i as Ie,P as uo,W as yu,k as Cu,m as Eu,E as tr,l as Nu,R as Tu}from"./vendor.fa96dc44.js";const wu=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}};wu();const As=window.location.hostname,bu=As!=="playground.lexical.dev"&&As!=="lexical-playground.vercel.app",wn={disableBeforeInput:!1,emptyEditor:bu,isAutocomplete:!1,isCharLimit:!1,isCharLimitUtf8:!1,isCollab:!1,isRichText:!0,measureTypingPerf:!1,showNestedEditorTreeView:!1,showTreeView:!0},Ps=new URLSearchParams(window.location.search);var yl;for(const t of Object.keys(wn))if(Ps.has(t))try{const e=JSON.parse((yl=Ps.get(t))!=null?yl:"true");wn[t]=Boolean(e)}catch{console.warn(`Unable to parse query parameter "${t}"`)}wn.disableBeforeInput&&delete window.InputEvent.prototype.getTargetRanges;const No=y.exports.createContext(null);function El(t,e){let n=null;t!=null&&(n=t[1]);function o(){return e!=null?e:n!=null?n.getTheme():null}return{getTheme:o}}function $(){const t=y.exports.useContext(No);if(t==null)throw Error("LexicalComposerContext.useLexicalComposerContext: cannot find a LexicalComposerContext");return t}const je=()=>window.getSelection(),Nl=1,Mn=3,Tt=0,Tl=1,Bt=2,Su=0,wl=1,bl=2,Sl=3,kl=1,vl=1<<1,Er=1<<2,Nr=1<<3,Dl=1<<4,Ll=1<<5,Ol=1<<6,Fs=1,Ms=1<<1,Al=1,Pl=2,Fl=3,Ml=4,Ur="\u200B",Rl="\u0591-\u07FF\uFB1D-\uFDFD\uFE70-\uFEFC",Il="A-Za-z\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u0300-\u0590\u0800-\u1FFF\u200E\u2C00-\uFB1C\uFE00-\uFE6F\uFEFD-\uFFFF",ku=new RegExp("^[^"+Il+"]*["+Rl+"]"),vu=new RegExp("^[^"+Rl+"]*["+Il+"]"),Kt={bold:kl,code:Dl,italic:vl,strikethrough:Er,subscript:Ll,superscript:Ol,underline:Nr},Rs={center:Pl,justify:Ml,left:Al,right:Fl},Du={inert:Sl,normal:Su,segmented:bl,token:wl},ht=typeof window!="undefined"&&typeof window.document!="undefined"&&typeof window.document.createElement!="undefined",Lu=ht&&"documentMode"in document?document.documentMode:null,ge=ht&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),To=ht&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),jr=ht&&"InputEvent"in window&&!Lu?"getTargetRanges"in new window.InputEvent("input"):!1,Gr=ht&&/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),Yr=ht&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;let Ou=0;function Bl(){return""+Ou++}function Au(t,e){const n=t._nodes.get(e);if(n===void 0)throw Error(`registeredNode: Type ${e} not found`);return n}const Pu=typeof queueMicrotask=="function"?queueMicrotask:t=>{Promise.resolve().then(t)};function Fu(t){const e=document.activeElement,n=e!==null?e.nodeName:null;return!re(Me(t))||n!=="INPUT"&&n!=="TEXTAREA"}function Kl(t,e,n){const o=t.getRootElement();try{return o!==null&&o.contains(e)&&o.contains(n)&&e!==null&&Fu(e)&&$l(e)===t}catch{return!1}}function $l(t){let e=t;for(;e!=null;){const n=e.__lexicalEditor;if(n!=null&&!n.isReadOnly())return n;e=e.parentNode}return null}function Mu(t){return ku.test(t)?"rtl":vu.test(t)?"ltr":null}function et(t){return t.isToken()||t.isInert()}function wo(t){let e=t;for(;e!=null;){if(e.nodeType===Mn)return e;e=e.firstChild}return null}function Hl(t,e,n){const o=Kt[e];return t&o&&(n===null||(n&o)===0)?t^o:n===null||n&o?t|o:t}function Rn(t){return b(t)||ce(t)||re(t)}function Ru(t,e){if(e!=null){t.__key=e;return}Y(),ca();const n=ae(),o=Je(),r=Bl();o._nodeMap.set(r,t),S(t)?n._dirtyElements.set(r,!0):n._dirtyLeaves.add(r),n._cloneNotNeeded.add(r),n._dirtyType=Tl,t.__key=r}function Iu(t,e,n){let o=t;for(;o!==null;){if(n.has(o))return;const r=e.get(o);if(r===void 0)break;n.set(o,!1),o=r.__parent}}function fo(t){const e=t.getParent();if(e!==null){const o=e.getWritable().__children,r=o.indexOf(t.__key);if(r===-1)throw Error("Node is not a child of its parent");Rt(t),o.splice(r,1)}}function $t(t){ca();const e=t.getLatest(),n=e.__parent,o=Je(),r=ae(),s=o._nodeMap,i=r._dirtyElements;n!==null&&Iu(n,s,i);const l=e.__key;r._dirtyType=Tl,S(t)?i.set(l,!0):r._dirtyLeaves.add(l)}function Rt(t){const e=t.getPreviousSibling(),n=t.getNextSibling();e!==null&&$t(e),n!==null&&$t(n)}function _e(t){Y();const e=ae(),n=e._compositionKey;if(t!==n){if(e._compositionKey=t,n!==null){const o=M(n);o!==null&&o.getWritable()}if(t!==null){const o=M(t);o!==null&&o.getWritable()}}}function lt(){return ae()._compositionKey}function M(t,e){const o=(e||Je())._nodeMap.get(t);return o===void 0?null:o}function zl(t,e){const n=ae(),o=t["__lexicalKey_"+n._key];return o!==void 0?M(o,e):null}function Me(t,e){let n=t;for(;n!=null;){const o=zl(n,e);if(o!==null)return o;n=n.parentNode}return null}function Wl(t){const e=t._decorators,n=Object.assign({},e);return t._pendingDecorators=n,n}function Is(t){return t.read(e=>se().getTextContent())}function Bu(t,e){Re(t,()=>{const n=Je();if(n.isEmpty())return;if(e==="root"){se().markDirty();return}const o=n._nodeMap;for(const[,r]of o)r.markDirty()},t._pendingEditorState===null?{tag:"history-merge"}:void 0)}function se(){return Ul(Je())}function Ul(t){return t._nodeMap.get("root")}function ie(t){const e=Je();t!==null&&Object.isFrozen(t)&&console.warn("$setSelection called on frozen selection object. Ensure selection is cloned before passing in."),e._selection=t}function Ku(){Y();const t=ae();ga(t)}function ro(t){const e=ae(),n=$u(t,e);if(n===null){const o=e.getRootElement();return t===o?M("root"):null}return M(n)}function Bs(t,e){return e?t.getTextContentSize():0}function $u(t,e){let n=t;for(;n!=null;){const o=n["__lexicalKey_"+e._key];if(o!==void 0)return o;n=n.parentNode}return null}function Hu(t){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)}function qr(t){const e=[];let n=t;for(;n!==null;)e.push(n),n=n._parentEditor;return e}function zu(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function jl(t,e){const n=je();if(n===null)return;const o=n.anchorNode;let{anchorOffset:r,focusOffset:s}=n;if(o!==null&&o.nodeType===Mn){const i=Me(o);if(b(i)){let l=o.nodeValue;const a=e!==null&&e.data;if(l===Ur&&a){const c=a.length;l=a,r=c,s=c}Vr(i,l,r,s,e!==null)}}}function Vr(t,e,n,o,r){let s=t;if(s.isAttached()&&(r||!s.isDirty())){const i=s.isComposing();let l=e;(i||r)&&e[e.length-1]===Ur&&(l=e.slice(0,-1));const a=s.getTextContent();if(r||l!==a){if(l===""){if(_e(null),!Gr&&!Yr){const f=ae();setTimeout(()=>{f.update(()=>{s.isAttached()&&s.remove()})},20)}else s.remove();return}const c=s.getParent(),u=Vo();if(et(s)||lt()!==null&&!i||c!==null&&w(u)&&!c.canInsertTextBefore()&&u.anchor.offset===0){s.markDirty();return}const d=T();if(!w(d)||n===null||o===null){s.setTextContent(l);return}if(d.setTextNodeRange(s,n,s,o),s.isSegmented()){const f=s.getTextContent(),h=K(f);s.replace(h),s=h}s.setTextContent(l)}}}function Wu(t,e){if(e.isSegmented())return!0;if(!t.isCollapsed())return!1;const n=t.anchor.offset,o=e.getParentOrThrow(),r=e.isToken(),s=n===0&&(!e.canInsertTextBefore()||!o.canInsertTextBefore()||r),i=e.getTextContentSize()===n&&(!e.canInsertTextBefore()||!o.canInsertTextBefore()||r);return s||i}function Gl(t,e,n){const o=t.anchor,r=t.focus,s=o.getNode(),i=je(),l=i!==null?i.anchorNode:null,a=o.key,c=ae().getElementByKey(a);return a!==r.key||!b(s)||o.offset!==r.offset&&!s.isComposing()||(n||s.isDirty())&&e.length>1||c!==null&&!s.isComposing()&&l!==wo(c)||s.getFormat()!==t.format||Wu(t,s)}function Uu(t,e,n,o){return t===9&&!e&&!n&&!o}function ju(t,e,n,o){return t===66&&!e&&Bo(n,o)}function Gu(t,e,n,o){return t===73&&!e&&Bo(n,o)}function Yu(t,e,n,o){return t===85&&!e&&Bo(n,o)}function qu(t,e){return Yl(t)&&!e}function Vu(t,e){return Yl(t)&&e}function Xu(t,e){return ge&&e&&t===79}function Ju(t,e,n){return bn(t)&&(ge?e:n)}function Qu(t,e,n){return Sn(t)&&(ge?e:n)}function Zu(t,e){return ge&&e&&bn(t)}function ed(t,e){return ge&&e&&Sn(t)}function td(t,e,n,o){return ge?e||n?!1:bn(t)||t===72&&o:o||e||n?!1:bn(t)}function nd(t,e,n,o,r){return ge?n||o||r?!1:Sn(t)||t===68&&e:e||o||r?!1:Sn(t)}function od(t,e,n,o){return t===90&&!e&&Bo(n,o)}function rd(t,e,n,o){return ge?t===90&&n&&e:t===89&&o||t===90&&o&&e}function sd(t){return t===37}function id(t){return t===39}function ld(t){return t===38}function ad(t){return t===40}function cd(t,e,n,o,r){return sd(t)&&!e&&!r&&!o}function ud(t,e,n,o,r){return id(t)&&!e&&!r&&!o}function dd(t,e,n,o,r){return ld(t)&&!e&&!r}function fd(t,e,n,o,r){return ad(t)&&!e&&!r}function hd(t,e,n,o){return t||e||n||o}function Bo(t,e){return ge?t:e}function Yl(t){return t===13}function bn(t){return t===8}function gd(t){return t===27}function Sn(t){return t===46}function ho(t,e){const n=t[e];if(typeof n=="string"){const o=n.split(" ");return t[e]=o,o}return n}function Xr(t,e,n,o,r){if(n.size===0)return;const s=o.__type,i=o.__key,l=e.get(s);if(l===void 0)throw Error(`Type ${s} not in registeredNodes`);const a=l.klass;let c=t.get(a);c===void 0&&(c=new Map,t.set(a,c)),c.has(i)||c.set(i,r)}function Ks(t,e,n){const o=t.getParent();let r=n,s=t;return o!==null&&(e&&n===0?(r=s.getIndexWithinParent(),s=o):!e&&n===s.getChildrenSize()&&(r=s.getIndexWithinParent()+1,s=o)),s.getChildAtIndex(e?r-1:r)}function ql(t,e){const n=t.offset;if(t.type==="element"){const o=t.getNode();return Ks(o,e,n)}else{const o=t.getNode();if(e&&n===0||!e&&n===o.getTextContentSize()){const r=e?o.getPreviousSibling():o.getNextSibling();return r===null?Ks(o.getParentOrThrow(),e,o.getIndexWithinParent()+(e?0:1)):r}}return null}function Vl(){const t=window.event,e=t&&t.inputType;return e==="insertFromPaste"||e==="insertFromPasteAsQuotation"}function P(t,e,n){return da(t,e,n)}function pd(t,e){const n=t._decorators;let r=t._pendingDecorators||n;const s=e._nodeMap;let i;for(i in r)s.has(i)||(r===n&&(r=Wl(t)),delete r[i])}function Xl(t,e,n,o,r){const s=t.__children,i=s.length;for(let l=0;l<i;l++){const a=s[l],c=o.get(a);c!==void 0&&c.__parent===e&&(S(c)&&Xl(c,a,n,o,r),n.has(a)||r.delete(a),o.delete(a))}}function md(t,e,n,o){const r=t._nodeMap,s=e._nodeMap;for(const i of n){const l=s.get(i);l!==void 0&&!l.isAttached()&&(r.has(i)||n.delete(i),s.delete(i))}for(const[i]of o){const l=s.get(i);l!==void 0&&(l.isAttached()||(S(l)&&Xl(l,i,r,s,o),r.has(i)||o.delete(i),s.delete(i)))}}function $s(t,e){const n=t.__mode,o=t.__format,r=t.__style,s=e.__mode,i=e.__format,l=e.__style;return(n===null||n===s)&&(o===null||o===i)&&(r===null||r===l)}function Hs(t,e){const n=t.mergeWithSibling(e),o=ae()._normalizedNodes;return o.add(t.__key),o.add(e.__key),n}function Jl(t){let e=t;if(e.__text===""&&e.isSimpleText()&&!e.isUnmergeable()){e.remove();return}let n;for(;(n=e.getPreviousSibling())!==null&&b(n)&&n.isSimpleText()&&!n.isUnmergeable();)if(n.__text==="")n.remove();else if($s(n,e)){e=Hs(n,e);break}else break;let o;for(;(o=e.getNextSibling())!==null&&b(o)&&o.isSimpleText()&&!o.isUnmergeable();)if(o.__text==="")o.remove();else if($s(e,o)){e=Hs(e,o);break}else break}function _d(t,e){Y();const n=ae();return Jr(t,e,n,null)}function Jr(t,e,n,o,r={originalSelection:null}){const s=t.__type,i=n._nodes.get(s);if(i===void 0)throw Error(`createNodeFromParse: type "${s}" + not found`);for(const f in t){const h=t[f];if(h!=null&&typeof h=="object"){const g=h.editorState;if(g!=null){const p=Un();p._nodes=n._nodes,p._parentEditor=n._parentEditor,p._pendingEditorState=ua(g,p),t[f]=p}}}const l=i.klass,a=t.__key;t.__key=void 0;const c=l.clone(t);t.__key=a;const u=c.__key;if(V(c)&&Je()._nodeMap.set("root",c),c.__parent=o,S(c)){const f=t.__children;for(let h=0;h<f.length;h++){const g=f[h],p=e.get(g);if(p!==void 0){const C=Jr(p,e,n,u,r).__key;c.__children.push(C)}}c.__indent=t.__indent,c.__format=t.__format,c.__dir=t.__dir}else b(c)&&(c.__format=t.__format,c.__style=t.__style,c.__mode=t.__mode,c.__detail=t.__detail,c.__marks=t.__marks);const d=r!=null?r.originalSelection:void 0;if(d!=null){let f=r.remappedSelection;if(d.type==="range"){const h=d.anchor,g=d.focus;f==null&&(a===h.key||a===g.key)&&(r.remappedSelection=f={anchor:z({},h),focus:z({},g),type:"range"}),f!=null&&f.type==="range"&&(a===h.key&&(f.anchor.key=u),a===g.key&&(f.focus.key=u))}else if(d.type==="node"){const h=d.nodes,g=h.indexOf(a);g!==-1&&(f==null&&(r.remappedSelection=f={nodes:[...h],type:"node"}),f.type==="node"&&f.nodes.splice(g,1,u))}else if(d.type==="grid"){const h=d.gridKey,g=d.anchor.key,p=d.focus.key;f==null&&(h===a||h===g||h===p)&&(r.remappedSelection=f=j(z({},d),{type:"grid"})),f!=null&&f.type==="grid"&&(h===a&&(f.gridKey=u),g===a&&(f.anchor.key=u),p===a&&(f.focus.key=u))}}return c}function I(){return{}}const nt=I(),In=I(),Fe=I(),at=I(),Ht=I(),qe=I(),Ko=I(),bo=I(),zt=I(),Wt=I(),he=I(),Vt=I(),Xt=I(),$o=I(),Ho=I(),wt=I(),kn=I(),Ut=I(),vt=I(),zo=I(),Jt=I(),Wo=I(),ut=I(),yt=I(),Qr=I(),Mt=I(),Zr=I(),es=I(),ts=I(),Ql=I(),xd=I(),ns=I(),Uo=I(),os=I(),Zl=I(),yd=I(),pt=Object.freeze({}),Tr=30,So=[["keydown",kd],["compositionstart",bd],["compositionend",Sd],["input",wd],["click",Cd],["cut",pt],["copy",pt],["dragstart",pt],["paste",pt],["focus",pt],["blur",pt]];jr?So.push(["beforeinput",Td]):So.push(["drop",pt]);let jo=0,xn=0,wr=!1,yn=!1;function zs(t,e){if(t===null)return!1;const n=t.firstChild,o=t.nodeType;return o===Nl&&n!=null&&n===t.lastChild&&n.nodeName==="BR"?!0:o===Mn&&e!==0&&e!==t.nodeValue.length}function Ws(t,e,n){if(wr){wr=!1;const{anchorNode:o,anchorOffset:r,focusNode:s,focusOffset:i}=t;if(zs(o,r)&&zs(s,i))return}Re(e,()=>{if(!n){ie(null);return}const o=T();if(w(o)){const r=o.anchor,s=r.getNode();if(o.isCollapsed())t.type==="Range"&&(o.dirty=!0),r.type==="text"?o.format=s.getFormat():r.type==="element"&&(o.format=0);else{const i=o.focus,l=i.getNode();let a=0;r.type==="text"&&(a|=s.getFormat()),i.type==="text"&&!s.is(l)&&(a|=l.getFormat()),o.format=a}}P(e,nt)})}function Cd(t,e){Re(e,()=>{const n=T();if(w(n)){const o=n.anchor;if(o.type==="element"&&o.offset===0&&n.isCollapsed()&&se().getChildrenSize()===1&&o.getNode().getTopLevelElementOrThrow().isEmpty()){const r=Vo();r!==null&&n.is(r)&&(je().removeAllRanges(),n.dirty=!0)}}P(e,In,t)})}function Ed(t,e){if(e.getTargetRanges){const n=e.getTargetRanges()[0];n&&t.applyDOMRange(n)}}function Nd(t,e){return t!==e||S(t)||S(e)||!et(t)||!et(e)}function Td(t,e){const n=t.inputType;if(!(n==="deleteCompositionText"||To&&Vl())){if(n==="insertCompositionText"){const o=t.data;o&&Re(e,()=>{const r=T();if(w(r)){const s=r.anchor,i=s.getNode(),l=i.getPreviousSibling();if(s.offset===0&&b(i)&&b(l)&&i.getTextContent()===" "&&l.getFormat()!==r.format){const a=l.getTextContent();if(o.indexOf(a)===0){const c=o.slice(a.length);P(e,qe,c),setTimeout(()=>{Re(e,()=>{i.select()})},Tr)}}}});return}Re(e,()=>{const o=T();if(n==="deleteContentBackward"){if(o===null){const c=Vo();if(!w(c))return;ie(c.clone())}_e(null),t.preventDefault(),jo=0,P(e,Fe,!0),setTimeout(()=>{e.update(()=>{_e(null)})},Tr);return}if(!w(o))return;const r=t.data;!o.dirty&&o.isCollapsed()&&!V(o.anchor.getNode())&&Ed(o,t);const s=o.anchor,i=o.focus,l=s.getNode(),a=i.getNode();if(n==="insertText"){if(r===`
`)t.preventDefault(),P(e,at);else if(r===`

`)t.preventDefault(),P(e,Ht);else if(r==null&&t.dataTransfer){const c=t.dataTransfer.getData("text/plain");t.preventDefault(),o.insertRawText(c)}else r!=null&&Gl(o,r,!0)&&(t.preventDefault(),P(e,qe,r));return}switch(t.preventDefault(),n){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":{P(e,qe,t);break}case"insertFromComposition":{_e(null),P(e,qe,t);break}case"insertLineBreak":{_e(null),P(e,at);break}case"insertParagraph":{_e(null),yn?(yn=!1,P(e,at)):P(e,Ht);break}case"insertFromPaste":case"insertFromPasteAsQuotation":{P(e,Ko,t);break}case"deleteByComposition":{Nd(l,a)&&P(e,bo);break}case"deleteByDrag":case"deleteByCut":{P(e,bo);break}case"deleteContent":{P(e,Fe,!1);break}case"deleteWordBackward":{P(e,zt,!0);break}case"deleteWordForward":{P(e,zt,!1);break}case"deleteHardLineBackward":case"deleteSoftLineBackward":{P(e,Wt,!0);break}case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":{P(e,Wt,!1);break}case"formatStrikeThrough":{P(e,he,"strikethrough");break}case"formatBold":{P(e,he,"bold");break}case"formatItalic":{P(e,he,"italic");break}case"formatUnderline":{P(e,he,"underline");break}case"historyUndo":{P(e,Vt);break}case"historyRedo":{P(e,Xt);break}}})}}function wd(t,e){t.stopPropagation(),Re(e,()=>{const n=T(),o=t.data;o!=null&&w(n)&&Gl(n,o,!1)?(P(e,qe,o),e._compositionKey!==null&&(jo=0,_e(null))):jl(e,null),Ku()})}function bd(t,e){Re(e,()=>{const n=T();if(w(n)&&!e.isComposing()){const o=n.anchor;_e(o.key),(t.timeStamp<jo+Tr||To&&o.type==="element"||!n.isCollapsed()||n.anchor.getNode().getFormat()!==n.format)&&P(e,qe," ")}})}function Sd(t,e){Re(e,()=>{const n=e._compositionKey;_e(null);const o=t.data;if(n!==null&&o!=null){if(o===""){const r=M(n),s=wo(e.getElementByKey(n));s!==null&&b(r)&&Vr(r,s.nodeValue,null,null,!0);return}else if(o[o.length-1]===`
`){const r=T();if(w(r)){const s=r.focus;r.anchor.set(s.key,s.offset,s.type),P(e,Ut,null);return}}}jl(e,t)})}function kd(t,e){if(jo=t.timeStamp,e.isComposing())return;const{keyCode:n,shiftKey:o,ctrlKey:r,metaKey:s,altKey:i}=t;ud(n,r,o,i,s)?P(e,$o,t):cd(n,r,o,i,s)?P(e,Ho,t):dd(n,r,o,i,s)?P(e,wt,t):fd(n,r,o,i,s)?P(e,kn,t):Vu(n,o)?(yn=!0,P(e,Ut,t)):Xu(n,r)?(t.preventDefault(),yn=!0,P(e,at,!0)):qu(n,o)?(yn=!1,P(e,Ut,t)):td(n,i,s,r)?bn(n)?P(e,vt,t):(t.preventDefault(),P(e,Fe,!0)):gd(n)?P(e,zo,t):nd(n,r,o,i,s)?Sn(n)?P(e,Jt,t):(t.preventDefault(),P(e,Fe,!1)):Ju(n,i,r)?(t.preventDefault(),P(e,zt,!0)):Qu(n,i,r)?(t.preventDefault(),P(e,zt,!1)):Zu(n,s)?(t.preventDefault(),P(e,Wt,!0)):ed(n,s)?(t.preventDefault(),P(e,Wt,!1)):ju(n,i,s,r)?(t.preventDefault(),P(e,he,"bold")):Yu(n,i,s,r)?(t.preventDefault(),P(e,he,"underline")):Gu(n,i,s,r)?(t.preventDefault(),P(e,he,"italic")):Uu(n,i,r,s)?P(e,Wo,t):od(n,o,s,r)?(t.preventDefault(),P(e,Vt)):rd(n,o,s,r)&&(t.preventDefault(),P(e,Xt)),hd(r,o,i,s)&&P(e,yd,t)}function ea(t){let e=t.__lexicalEventHandles;return e===void 0&&(e=[],t.__lexicalEventHandles=e),e}const It=new Map;function ta(t){const e=je(),n=$l(e.anchorNode);if(n===null)return;const o=qr(n),r=o[o.length-1],s=r._key,i=It.get(s),l=i||r;l!==n&&Ws(e,l,!1),Ws(e,n,!0),n!==r?It.set(s,n):i&&It.delete(s)}function vd(t,e){xn===0&&t.ownerDocument.addEventListener("selectionchange",ta),xn++,t.__lexicalEditor=e;const n=ea(t);for(let o=0;o<So.length;o++){const[r,s]=So[o],i=typeof s=="function"?l=>{e.isReadOnly()||s(l,e)}:l=>{if(!e.isReadOnly())switch(r){case"cut":return P(e,ts,l);case"copy":return P(e,es,l);case"paste":return P(e,Ko,l);case"dragstart":return P(e,Zr,l);case"focus":return P(e,os,l);case"blur":return P(e,Zl,l);case"drop":return P(e,Qr,l)}};t.addEventListener(r,i),n.push(()=>{t.removeEventListener(r,i)})}}function Dd(t){xn!==0&&(xn--,xn===0&&t.ownerDocument.removeEventListener("selectionchange",ta));const e=t.__lexicalEditor;e!=null&&(Ld(e),t.__lexicalEditor=null);const n=ea(t);for(let o=0;o<n.length;o++)n[o]();t.__lexicalEventHandles=[]}function Ld(t){if(t._parentEditor!==null){const e=qr(t),o=e[e.length-1]._key;It.get(o)===t&&It.delete(o)}else It.delete(t._key)}function Od(){wr=!0}let xe="",ye="",mt="",vn,we,Dn,na=!1,rs=!1,Go,go=null,br,Sr,Ln,jt,kr,On;function Yo(t,e){const n=Ln.get(t);if(e!==null){const o=ls(t);e.removeChild(o)}if(jt.has(t)||we._keyToDOMMap.delete(t),S(n)){const o=n.__children;ss(o,0,o.length-1,null)}n!==void 0&&Xr(On,Dn,Go,n,"destroyed")}function ss(t,e,n,o){let r=e;for(;r<=n;++r){const s=t[r];s!==void 0&&Yo(s,o)}}function dn(t,e){t.setProperty("text-align",e)}function oa(t,e){t.style.setProperty("padding-inline-start",e===0?"":e*40+"px")}function ra(t,e){const n=t.style;e===0?dn(n,""):e===Al?dn(n,"left"):e===Pl?dn(n,"center"):e===Fl?dn(n,"right"):e===Ml&&dn(n,"justify")}function qo(t,e,n){const o=jt.get(t);if(o===void 0)throw Error("createNode: node does not exist in nodeMap");const r=o.createDOM(vn,we);if(Hd(t,r,we),b(o)?r.setAttribute("data-lexical-text","true"):re(o)&&r.setAttribute("data-lexical-decorator","true"),S(o)){const s=o.__indent;s!==0&&oa(r,s);const i=o.__children,l=i.length;if(l!==0){const c=l-1;Ad(i,c,o,r)}const a=o.__format;a!==0&&ra(r,a),sa(null,i,r)}else{const s=o.getTextContent();if(re(o)){const i=o.decorate(we);i!==null&&la(t,i),r.contentEditable="false"}else if(b(o)&&(o.isDirectionless()||(ye+=s),o.isInert())){const i=r.style;i.pointerEvents="none",i.userSelect="none",r.contentEditable="false",i.setProperty("-webkit-user-select","none")}xe+=s,mt+=s}if(e!==null)if(n!=null)e.insertBefore(r,n);else{const s=e.__lexicalLineBreak;s!=null?e.insertBefore(r,s):e.appendChild(r)}return Object.freeze(o),Xr(On,Dn,Go,o,"created"),r}function Ad(t,e,n,o){const r=ye;ye="",is(t,0,e,o,null),ia(n,o),ye=r}function is(t,e,n,o,r){const s=xe;xe="";let i=e;for(;i<=n;++i)qo(t[i],o,r);o.__lexicalTextContent=xe,xe=s+xe}function Us(t,e){const n=t[t.length-1],o=e.get(n);return ce(o)||re(o)}function sa(t,e,n){const o=t!==null&&(t.length===0||Us(t,Ln)),r=e!==null&&(e.length===0||Us(e,jt));if(o){if(!r){const s=n.__lexicalLineBreak;s!=null&&n.removeChild(s),n.__lexicalLineBreak=null}}else if(r){const s=document.createElement("br");n.__lexicalLineBreak=s,n.appendChild(s)}}function ia(t,e){const n=e.__lexicalDirTextContent,o=e.__lexicalDir;if(n!==ye||o!==go){const r=ye==="",s=r?go:Mu(ye);if(s!==o){const i=e.classList,l=vn.theme;let a=o!==null?l[o]:void 0,c=s!==null?l[s]:void 0;if(a!==void 0){if(typeof a=="string"){const u=a.split(" ");a=l[o]=u}i.remove(...a)}if(s===null||r&&s==="ltr")e.removeAttribute("dir");else{if(c!==void 0){if(typeof c=="string"){const u=c.split(" ");c=l[s]=u}i.add(...c)}e.dir=s}if(!rs){const u=t.getWritable();u.__dir=s}}go=s,e.__lexicalDirTextContent=ye,e.__lexicalDir=s}}function Pd(t,e,n,o){const r=ye;ye="",Fd(t,e,o),ia(n,o),ye=r}function Fd(t,e,n){const o=xe;xe="";const r=t.length,s=e.length;if(r===1&&s===1){const i=t[0],l=e[0];if(i===l)Cn(i,n);else{const a=ls(i),c=qo(l,null,null);n.replaceChild(c,a),Yo(i,null)}}else if(r===0)s!==0&&is(e,0,s-1,n,null);else if(s===0){if(r!==0){const l=n.__lexicalLineBreak==null;ss(t,0,r-1,l?null:n),l&&(n.textContent="")}}else Rd(t,e,r,s,n);n.__lexicalTextContent=xe,xe=o+xe}function Cn(t,e){const n=Ln.get(t);let o=jt.get(t);if(n===void 0||o===void 0)throw Error("reconcileNode: prevNode or nextNode does not exist in nodeMap");const r=na||Sr.has(t)||br.has(t),s=ko(we,t);if(n===o&&!r){if(S(n)){const i=s.__lexicalTextContent;i!==void 0&&(xe+=i,mt+=i);const l=s.__lexicalDirTextContent;l!==void 0&&(ye+=l)}else{const i=n.getTextContent();b(n)&&!n.isDirectionless()&&(ye+=i),mt+=i,xe+=i}return s}if(n!==o&&r&&Xr(On,Dn,Go,o,"updated"),o.updateDOM(n,s,vn)){const i=qo(t,null,null);if(e===null)throw Error("reconcileNode: parentDOM is null");return e.replaceChild(i,s),Yo(t,null),i}if(S(n)&&S(o)){const i=o.__indent;i!==n.__indent&&oa(s,i);const l=o.__format;l!==n.__format&&ra(s,l);const a=n.__children,c=o.__children;(a!==c||r)&&(Pd(a,c,o,s),V(o)||sa(a,c,s))}else{const i=o.getTextContent();if(re(o)){const l=o.decorate(we);l!==null&&la(t,l)}else b(o)&&!o.isDirectionless()&&(ye+=i);xe+=i,mt+=i}return!rs&&V(o)&&o.__cachedText!==mt&&(o=o.getWritable(),o.__cachedText=mt),Object.freeze(o),s}function la(t,e){let n=we._pendingDecorators;const o=we._decorators;if(n===null){if(o[t]===e)return;n=Wl(we)}n[t]=e}function Md(t){return t.firstChild}function nr(t){return t.nextSibling}function Rd(t,e,n,o,r){const s=n-1,i=o-1;let l,a,c=Md(r),u=0,d=0;for(;u<=s&&d<=i;){const g=t[u],p=e[d];if(g===p)c=nr(Cn(p,r)),u++,d++;else{l===void 0&&(l=new Set(t)),a===void 0&&(a=new Set(e));const _=a.has(g),C=l.has(p);if(!_)c=nr(ls(g)),Yo(g,r),u++;else if(!C)qo(p,r,c),d++;else{const x=ko(we,p);x===c?c=nr(Cn(p,r)):(c!=null?r.insertBefore(x,c):r.appendChild(x),Cn(p,r)),u++,d++}}}const f=u>s,h=d>i;if(f&&!h){const g=e[i+1],p=g===void 0?null:we.getElementByKey(g);is(e,d,i,r,p)}else h&&!f&&ss(t,u,s,r)}function Id(t,e,n,o,r,s){xe="",mt="",ye="",na=o===Bt,go=null,we=n,vn=n._config,Dn=n._nodes,Go=we._listeners.mutation,br=r,Sr=s,Ln=t._nodeMap,jt=e._nodeMap,rs=e._readOnly,kr=new Map(n._keyToDOMMap);const i=new Map;return On=i,Cn("root",null),we=void 0,Dn=void 0,br=void 0,Sr=void 0,Ln=void 0,jt=void 0,vn=void 0,kr=void 0,On=void 0,i}function Bd(t,e,n,o,r,s,i){const l=i._observer;let a=null;if(s&&l!==null){const u=i._dirtyType,d=i._dirtyElements,f=i._dirtyLeaves;l.disconnect();try{a=Id(e,n,i,u,d,f)}finally{l.observe(t,{characterData:!0,childList:!0,subtree:!0})}}const c=je();return!i._readOnly&&c!==null&&(s||r===null||r.dirty)&&$d(o,r,i,c),a}function Kd(t,e,n){const o=e.nodeType===Mn?e.parentNode:e;if(o!==null){const r=o.getBoundingClientRect();if(r.bottom>window.innerHeight)o.scrollIntoView(!1);else if(r.top<0)o.scrollIntoView();else if(n){const s=n.getBoundingClientRect();r.bottom>s.bottom?o.scrollIntoView(!1):r.top<s.top&&o.scrollIntoView()}t._updateTags.add("scroll-into-view")}}function $d(t,e,n,o){const r=o.anchorNode,s=o.focusNode,i=o.anchorOffset,l=o.focusOffset,a=document.activeElement,c=n._rootElement;if(n._updateTags.has("collaboration")&&a!==c)return;if(!w(e)){t!==null&&Kl(n,r,s)&&o.removeAllRanges();return}const u=e.anchor,d=e.focus;Object.freeze(u),Object.freeze(d),Object.freeze(e);const f=u.key,h=d.key,g=ko(n,f),p=ko(n,h),_=u.offset,C=d.offset;let x=g,E=p,N=!1;if(u.type==="text"?x=wo(g):N=!0,d.type==="text"?E=wo(p):N=!0,!(x===null||E===null)){if(!N&&i===_&&l===C&&r===x&&s===E&&!(o.type==="Range"&&e.isCollapsed())){c!==null&&(a===null||!c.contains(a))&&c.focus({preventScroll:!0});return}try{o.setBaseAndExtent(x,_,E,C),e.isCollapsed()&&c===a&&Kd(n,x,c),Od()}catch{}}}function Hd(t,e,n){const o=n._keyToDOMMap;e["__lexicalKey_"+n._key]=t,o.set(t,e)}function ls(t){const e=kr.get(t);if(e===void 0)throw Error(`Reconciliation: could not find DOM element for node key "${t}"`);return e}function ko(t,e){const n=t._keyToDOMMap.get(e);if(n===void 0)throw Error(`Reconciliation: could not find DOM element for node key "${e}"`);return n}let be=null,Ee=null,Se=!1,or=!1,vo=0;function aa(){return Se}function Y(){if(Se)throw Error("Cannot use method in read-only mode.")}function ca(){if(vo>99)throw Error("One or more transforms are endlessly triggering additional transforms. May have encountered infinite recursion caused by transforms that have their preconditions too lose and/or conflict with each other.")}function Je(){if(be===null)throw Error("Unable to find an active editor state. State helpers or node methods can only be used synchronously during the callback of editor.update() or editorState.read().");return be}function ae(){if(Ee===null)throw Error("Unable to find an active editor. This method can only be used synchronously during the callback of editor.update().");return Ee}function js(t,e,n){const o=e.__type,r=Au(t,o);let s=n.get(o);s===void 0&&(s=Array.from(r.transforms),n.set(o,s));const i=s.length;for(let l=0;l<i&&(s[l](e),!!e.isAttached());l++);}function Gs(t,e){return t!==void 0&&t.__key!==e&&t.isAttached()}function zd(t,e){const n=e._dirtyLeaves,o=t._nodeMap;for(const r of n){const s=o.get(r);b(s)&&s.isAttached()&&s.isSimpleText()&&!s.isUnmergeable()&&Jl(s)}}function Wd(t,e){const n=e._dirtyLeaves,o=e._dirtyElements,r=t._nodeMap,s=lt(),i=new Map;let l=n,a=l.size,c=o,u=c.size;for(;a>0||u>0;){if(a>0){e._dirtyLeaves=new Set;for(const d of l){const f=r.get(d);b(f)&&f.isAttached()&&f.isSimpleText()&&!f.isUnmergeable()&&Jl(f),f!==void 0&&Gs(f,s)&&js(e,f,i),n.add(d)}if(l=e._dirtyLeaves,a=l.size,a>0){vo++;continue}}e._dirtyLeaves=new Set,e._dirtyElements=new Map;for(const d of c){const f=d[0],h=d[1];if(f==="root"||!h)continue;const g=r.get(f);g!==void 0&&Gs(g,s)&&js(e,g,i),o.set(f,h)}l=e._dirtyLeaves,a=l.size,c=e._dirtyElements,u=c.size,vo++}e._dirtyLeaves=n,e._dirtyElements=o}function ua(t,e){const n=new Map,o=new Hn(n),r={originalSelection:t._selection},s=be,i=Se,l=Ee;be=o,Se=!1,Ee=e;try{const a=new Map(t._nodeMap),c=a.get("root");Jr(c,a,e,null,r)}finally{be=s,Se=i,Ee=l}return o._selection=ff(r.remappedSelection||r.originalSelection),o}function Ud(t,e){const n=be,o=Se,r=Ee;be=t,Se=!0,Ee=null;try{return e()}finally{be=n,Se=o,Ee=r}}function jd(t){const e=t._nodeMap;e.set=()=>{throw new Error("Cannot call set() on a frozen Lexical node map")},e.clear=()=>{throw new Error("Cannot call clear() on a frozen Lexical node map")},e.delete=()=>{throw new Error("Cannot call delete() on a frozen Lexical node map")}}function Ct(t){const e=t._pendingEditorState,n=t._rootElement;if(n===null||e===null)return;const o=t._editorState,r=o._selection,s=e._selection,i=t._dirtyType!==Tt;t._pendingEditorState=null,t._editorState=e;const l=be,a=Se,c=Ee,u=t._updating;Ee=t,be=e,Se=!1,t._updating=!0;try{const _=Bd(n,o,e,r,s,i,t);_!==null&&Yd(t,o,e,_)}catch(_){t._onError(_),or||(Ta(t,null,n,e),pa(t),t._dirtyType=Bt,or=!0,Ct(t),or=!1);return}finally{t._updating=u,be=l,Se=a,Ee=c}e._readOnly=!0,jd(e);const d=t._dirtyLeaves,f=t._dirtyElements,h=t._normalizedNodes,g=t._updateTags;i&&(t._dirtyType=Tt,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements=new Map,t._normalizedNodes=new Set,t._updateTags=new Set),pd(t,e);const p=t._pendingDecorators;p!==null&&(t._decorators=p,t._pendingDecorators=null,An("decorator",t,!0,p)),Gd(t,o,e),An("update",t,!0,{dirtyElements:f,dirtyLeaves:d,editorState:e,normalizedNodes:h,prevEditorState:o,tags:g}),Vd(t),qd(t)}function Gd(t,e,n){const o=Is(e),r=Is(n);o!==r&&An("textcontent",t,!0,r)}function Yd(t,e,n,o){t._listeners.mutation.forEach((s,i)=>{const l=o.get(s);l!==void 0&&i(l)})}function An(t,e,n,...o){const r=e._updating;e._updating=n;try{const s=Array.from(e._listeners[t]);for(let i=0;i<s.length;i++)s[i](...o)}finally{e._updating=r}}function da(t,e,n){if(t._updating===!1||Ee!==t){let r=!1;return t.update(()=>{r=da(t,e,n)}),r}const o=qr(t);for(let r=4;r>=0;r--)for(let s=0;s<o.length;s++){const a=o[s]._commands.get(e);if(a!==void 0){const c=a[r];if(c!==void 0){for(const u of c)if(u(n,t)===!0)return!0}}}return!1}function qd(t){const e=t._updates;if(e.length!==0){const[n,o]=e.shift();fa(t,n,o)}}function Vd(t){const e=t._deferred;if(t._deferred=[],e.length!==0){const n=t._updating;t._updating=!0;try{for(let o=0;o<e.length;o++)e[o]()}finally{t._updating=n}}}function Ys(t,e){const n=t._updates;let o=e||!1;for(;n.length!==0;){const[r,s]=n.shift();let i,l;s!==void 0&&(i=s.onUpdate,l=s.tag,s.skipTransforms&&(o=!0),i&&t._deferred.push(i),l&&t._updateTags.add(l)),r()}return o}function fa(t,e,n){const o=t._updateTags;let r,s,i=!1;n!==void 0&&(r=n.onUpdate,s=n.tag,s!=null&&o.add(s),i=n.skipTransforms),r&&t._deferred.push(r);const l=t._editorState;let a=t._pendingEditorState,c=!1;a===null&&(a=t._pendingEditorState=_f(l),c=!0);const u=be,d=Se,f=Ee,h=t._updating;be=a,Se=!1,t._updating=!0,Ee=t;try{c&&(a._selection=uf(t));const p=t._compositionKey;e(),i=Ys(t,i),hf(a,t),t._dirtyType!==Tt&&(i?zd(a,t):Wd(a,t),Ys(t),md(l,a,t._dirtyLeaves,t._dirtyElements));const _=t._compositionKey;p!==_&&(a._flushSync=!0);const C=a._selection;if(w(C)){const x=a._nodeMap,E=C.anchor.key,N=C.focus.key;if(x.get(E)===void 0||x.get(N)===void 0)throw Error("updateEditor: selection has been lost because the previously selected nodes have been removed and selection wasn't moved to another node. Ensure selection changes after removing/replacing a selected node.")}else Le(C)&&C._nodes.size===0&&(a._selection=null)}catch(p){t._onError(p),t._pendingEditorState=l,t._dirtyType=Bt,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),Ct(t);return}finally{be=u,Se=d,Ee=f,t._updating=h,vo=0}t._dirtyType!==Tt||mf(a,t)?a._flushSync?(a._flushSync=!1,Ct(t)):c&&Pu(()=>{Ct(t)}):(a._flushSync=!1,c&&(o.clear(),t._deferred=[],t._pendingEditorState=null))}function Re(t,e,n){t._updating?t._updates.push([e,n]):fa(t,e,n)}const Xd=100;let vr=!1,as=0;function Jd(){return vr}function Qd(t){as=t.timeStamp}function Zd(){as===0&&window.addEventListener("textInput",Qd,!0)}function rr(t,e,n){return e.__lexicalLineBreak===t||t["__lexicalKey_"+n._key]!==void 0}function ef(t){return t.getEditorState().read(()=>{const e=T();return e!==null?e.clone():null})}function tf(t,e,n){const o=je();let r=null,s=null;o!==null&&o.anchorNode===t&&(r=o.anchorOffset,s=o.focusOffset);const i=t.nodeValue;Vr(e,i,r,s,!1)}function ha(t,e,n){vr=!0;const o=performance.now()-as>Xd;try{Re(t,()=>{const r=new Map,s=t.getRootElement(),i=t._editorState;let l=!1,a="";for(let d=0;d<e.length;d++){const f=e[d],h=f.type,g=f.target;let p=Me(g,i);if(!re(p)){if(h==="characterData")o&&g.nodeType===Mn&&b(p)&&p.isAttached()&&tf(g,p,t);else if(h==="childList"){l=!0;const _=f.addedNodes;for(let E=0;E<_.length;E++){const N=_[E],k=zl(N),D=N.parentNode;if(D!=null&&k===null&&(N.nodeName!=="BR"||!rr(N,D,t))){if(To){const A=N.innerText||N.nodeValue;A&&(a+=A)}D.removeChild(N)}}const C=f.removedNodes,x=C.length;if(x>0){let E=0;for(let N=0;N<x;N++){const k=C[N];k.nodeName==="BR"&&rr(k,g,t)&&(g.appendChild(k),E++)}x!==E&&(g===s&&(p=Ul(i)),r.set(g,p))}}}}if(r.size>0)for(const[d,f]of r)if(S(f)){const h=f.__children;let g=d.firstChild;for(let p=0;p<h.length;p++){const _=h[p],C=t.getElementByKey(_);C!==null&&(g==null?(d.appendChild(C),g=C):g!==C&&d.replaceChild(C,g),g=g.nextSibling)}}else b(f)&&f.markDirty();const c=n.takeRecords();if(c.length>0){for(let d=0;d<c.length;d++){const f=c[d],h=f.addedNodes,g=f.target;for(let p=0;p<h.length;p++){const _=h[p],C=_.parentNode;C!=null&&_.nodeName==="BR"&&!rr(_,g,t)&&C.removeChild(_)}}n.takeRecords()}const u=T()||ef(t);u!==null&&(l&&(u.dirty=!0,ie(u)),To&&Vl()&&u.insertRawText(a))})}finally{vr=!1}}function ga(t){const e=t._observer;if(e!==null){const n=e.takeRecords();ha(t,n,e)}}function pa(t){Zd(),t._observer=new MutationObserver((e,n)=>{ha(t,e,n)})}class nf{constructor(e,n,o){this.key=e,this.offset=n,this.type=o}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){let n=this.getNode(),o=e.getNode();const r=this.offset,s=e.offset;return S(n)&&(n=n.getDescendantByIndex(r)),S(o)&&(o=o.getDescendantByIndex(s)),n===o?r<s:n.isBefore(o)}getNode(){const e=this.key,n=M(e);if(n===null)throw Error("Point.getNode: node not found");return n}set(e,n,o){const r=T(),s=this.key;this.key=e,this.offset=n,this.type=o,aa()||(lt()===s&&_e(e),r!==null&&(r.anchor===this||r.focus===this)&&(r.dirty=!0))}}function Te(t,e,n){return new nf(t,e,n)}function sr(t,e){const n=e.__key;let o=t.offset,r="element";if(b(e)){r="text";const s=e.getTextContentSize();o>s&&(o=s)}t.set(n,o,r)}function qs(t,e){if(S(e)){const n=e.getLastDescendant();S(n)||b(n)?sr(t,n):sr(t,e)}else b(e)&&sr(t,e)}function Vs(t,e,n){const o=t.getNode(),r=o.getChildAtIndex(t.offset),s=K(),i=V(o)?U().append(s):s;s.setFormat(n),r===null?o.append(i):r.insertBefore(i),t.is(e)&&e.set(s.__key,0,"text"),t.set(s.__key,0,"text")}function it(t,e,n,o){t.key=e,t.offset=n,t.type=o}class Bn{constructor(e){this.dirty=!1,this._nodes=e}is(e){if(!Le(e))return!1;const n=this._nodes,o=e._nodes;return n.size===o.size&&Array.from(n).every(r=>o.has(r))}add(e){this.dirty=!0,this._nodes.add(e)}delete(e){this.dirty=!0,this._nodes.delete(e)}clear(){this.dirty=!0,this._nodes.clear()}has(e){return this._nodes.has(e)}clone(){return new Bn(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}getNodes(){const e=this._nodes,n=[];for(const o of e){const r=M(o);r!==null&&n.push(r)}return n}getTextContent(){const e=this.getNodes();let n="";for(let o=0;o<e.length;o++)n+=e[o].getTextContent();return n}}function w(t){return t instanceof Dt}class Kn{constructor(e,n,o){this.gridKey=e,this.anchor=n,this.focus=o,this.dirty=!1}is(e){return Z(e)?this.gridKey===e.gridKey&&this.anchor.is(this.focus):!1}set(e,n,o){this.dirty=!0,this.gridKey=e,this.anchor.key=n,this.focus.key=o}clone(){return new Kn(this.gridKey,this.anchor,this.focus)}isCollapsed(){return!1}isBackward(){return this.focus.isBefore(this.anchor)}getCharacterOffsets(){return po(this)}extract(){return this.getNodes()}insertRawText(e){}insertText(){}getShape(){const e=M(this.anchor.key);if(!e)throw Error("getNodes: expected to find AnchorNode");const n=e.getIndexWithinParent(),o=e.getParentOrThrow().getIndexWithinParent(),r=M(this.focus.key);if(!r)throw Error("getNodes: expected to find FocusNode");const s=r.getIndexWithinParent(),i=r.getParentOrThrow().getIndexWithinParent(),l=Math.min(n,s),a=Math.max(n,s),c=Math.min(o,i),u=Math.max(o,i);return{fromX:Math.min(l,a),fromY:Math.min(c,u),toX:Math.max(l,a),toY:Math.max(c,u)}}getNodes(){const e=new Set,{fromX:n,fromY:o,toX:r,toY:s}=this.getShape(),i=M(this.gridKey);if(!vf(i))throw Error("getNodes: expected to find GridNode");e.add(i);const l=i.getChildren();for(let a=o;a<=s;a++){const c=l[a];if(e.add(c),!Df(c))throw Error("getNodes: expected to find GridRowNode");const u=c.getChildren();for(let d=n;d<=r;d++){const f=u[d];if(!kf(f))throw Error("getNodes: expected to find GridCellNode");e.add(f);const h=f.getChildren();for(;h.length>0;){const g=h.shift();e.add(g),S(g)&&h.unshift(...g.getChildren())}}}return Array.from(e)}getTextContent(){const e=this.getNodes();let n="";for(let o=0;o<e.length;o++)n+=e[o].getTextContent();return n}}function Z(t){return t instanceof Kn}class Dt{constructor(e,n,o){this.anchor=e,this.focus=n,this.dirty=!1,this.format=o}is(e){return w(e)?this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format:!1}isBackward(){return this.focus.isBefore(this.anchor)}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this.anchor,n=this.focus;let o=e.getNode(),r=n.getNode();return S(o)&&(o=o.getDescendantByIndex(e.offset)),S(r)&&(r=r.getDescendantByIndex(n.offset)),o.is(r)?S(o)&&(o.getChildrenSize()>0||o.excludeFromCopy())?[]:[o]:o.getNodesBetween(r)}setTextNodeRange(e,n,o,r){it(this.anchor,e.__key,n,"text"),it(this.focus,o.__key,r,"text"),this.dirty=!0}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const n=e[0],o=e[e.length-1],r=this.anchor,s=this.focus,i=r.isBefore(s),[l,a]=po(this);let c="",u=!0;for(let d=0;d<e.length;d++){const f=e[d];if(S(f)&&!f.isInline())u||(c+=`
`),f.isEmpty()?u=!1:u=!0;else if(u=!1,b(f)){let h=f.getTextContent();f===n?f===o?h=l<a?h.slice(l,a):h.slice(a,l):h=i?h.slice(l):h.slice(a):f===o&&(h=i?h.slice(0,a):h.slice(0,l)),c+=h}else(re(f)||ce(f))&&(f!==o||!this.isCollapsed())&&(c+=f.getTextContent())}return c}applyDOMRange(e){const n=ae(),r=n.getEditorState()._selection,s=_a(e.startContainer,e.startOffset,e.endContainer,e.endOffset,n,r);if(s===null)return;const[i,l]=s;it(this.anchor,i.key,i.offset,i.type),it(this.focus,l.key,l.offset,l.type)}clone(){const e=this.anchor,n=this.focus;return new Dt(Te(e.key,e.offset,e.type),Te(n.key,n.offset,n.type),this.format)}toggleFormat(e){this.format=Hl(this.format,e,null),this.dirty=!0}hasFormat(e){const n=Kt[e];return(this.format&n)!==0}insertRawText(e){const n=e.split(/\r?\n/);if(n.length===1)this.insertText(e);else{const o=[],r=n.length;for(let s=0;s<r;s++){const i=n[s];i!==""&&o.push(K(i)),s!==r-1&&o.push(dt())}this.insertNodes(o)}}insertText(e){const n=this.anchor,o=this.focus,r=this.isCollapsed()||n.isBefore(o),s=this.format;r&&n.type==="element"?Vs(n,o,s):!r&&o.type==="element"&&Vs(o,n,s);const i=this.getNodes(),l=i.length,a=r?n:o,c=r?o:n,u=a.offset,d=c.offset;let f=i[0];if(!b(f))throw Error("insertText: first node is not a text node");const g=f.getTextContent().length,p=f.getParentOrThrow(),_=l-1;let C=i[_];if(this.isCollapsed()&&u===g&&(f.isSegmented()||f.isToken()||!f.canInsertTextAfter()||!p.canInsertTextAfter())){let x=f.getNextSibling();if((!b(x)||et(x)||x.isSegmented())&&(x=K(),p.canInsertTextAfter()?f.insertAfter(x):p.insertAfter(x)),x.select(0,0),f=x,e!==""){this.insertText(e);return}}else if(this.isCollapsed()&&u===0&&(f.isSegmented()||f.isToken()||!f.canInsertTextBefore()||!p.canInsertTextBefore())){let x=f.getPreviousSibling();if((!b(x)||et(x)||x.isSegmented())&&(x=K(),p.canInsertTextBefore()?f.insertBefore(x):p.insertBefore(x)),x.select(),f=x,e!==""){this.insertText(e);return}}else if(f.isSegmented()&&u!==g){const x=K(f.getTextContent());f.replace(x),f=x}else if(!this.isCollapsed()&&e!==""){const x=C.getParent();if(!p.canInsertTextBefore()||!p.canInsertTextAfter()||S(x)&&(!x.canInsertTextBefore()||!x.canInsertTextAfter())){this.insertText(""),ma(this.anchor,this.focus,null),this.insertText(e);return}}if(l===1){if(et(f)){const N=K(e);N.select(),f.replace(N);return}const x=f.getFormat();if(u===d&&x!==s)if(f.getTextContent()==="")f.setFormat(s);else{const N=K(e);if(N.setFormat(s),N.select(),u===0)f.insertBefore(N);else{const[k]=f.splitText(u);k.insertAfter(N)}N.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);return}const E=d-u;f=f.spliceText(u,E,e,!0),f.getTextContent()===""?f.remove():f.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length)}else{const x=new Set([...f.getParentKeys(),...C.getParentKeys()]),E=S(f)?f:f.getParentOrThrow(),N=S(C)?C:C.getParentOrThrow();if(c.type==="text"&&(d!==0||C.getTextContent()==="")||c.type==="element"&&C.getIndexWithinParent()<d)if(b(C)&&!et(C)&&d!==C.getTextContentSize()){if(C.isSegmented()){const L=K(C.getTextContent());C.replace(L),C=L}C=C.spliceText(0,d,""),x.add(C.__key)}else{const L=C.getParentOrThrow();!L.canBeEmpty()&&L.getChildrenSize()===1?L.remove():C.remove()}else x.add(C.__key);const k=N.getChildren(),D=new Set(i),A=E.is(N);if(!N.canBeEmpty()&&E!==N)E.append(N);else{for(let L=k.length-1;L>=0;L--){const R=k[L];if(R.is(f)||S(R)&&R.isParentOf(f))break;R.isAttached()&&(!D.has(R)||R.is(C)?A||f.insertAfter(R):R.remove())}if(!A){let L=N,R=null;for(;L!==null;){const B=L.getChildren(),H=B.length;(H===0||B[H-1].is(R))&&(x.delete(L.__key),R=L),L=L.getParent()}}}if(!et(f))f=f.spliceText(u,g-u,e,!0),f.getTextContent()===""?f.remove():f.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);else if(u===g)f.select();else{const L=K(e);L.select(),f.replace(L)}for(let L=1;L<l;L++){const R=i[L],B=R.__key;x.has(B)||R.remove()}}}removeText(){this.insertText("")}formatText(e){const n=this.getNodes(),r=n.length-1;let s=n[0],i=n[r];if(this.isCollapsed()){this.toggleFormat(e),_e(null);return}const l=this.anchor,a=this.focus,c=a.offset;let u=0,d=s.getTextContent().length;for(let _=0;_<n.length;_++){const C=n[_];if(b(C)){u=C.getFormatFlags(e,null);break}}let f=l.offset,h,g;const p=l.isBefore(a);if(h=p?f:c,g=p?c:f,h===s.getTextContentSize()){const _=s.getNextSibling();b(_)&&(f=0,h=0,s=_,d=_.getTextContent().length,u=s.getFormatFlags(e,null))}if(s.is(i)){if(b(s)){if(l.type==="element"&&a.type==="element"){s.setFormat(u),s.select(h,g),this.format=u;return}if(h=f>c?c:f,g=f>c?f:c,h===g)return;if(h===0&&g===d)s.setFormat(u),s.select(h,g);else{const _=s.splitText(h,g),C=h===0?_[0]:_[1];C.setFormat(u),C.select(0,g-h)}this.format=u}}else{b(s)&&(h!==0&&([,s]=s.splitText(h),h=0),s.setFormat(u));let _=u;if(b(i)){_=i.getFormatFlags(e,u);const x=i.getTextContent().length;g!==0&&(g!==x&&([i]=i.splitText(g)),i.setFormat(_))}for(let C=1;C<r;C++){const x=n[C],E=x.__key;if(b(x)&&E!==s.__key&&E!==i.__key&&!x.isToken()){const N=x.getFormatFlags(e,_);x.setFormat(N)}}}}insertNodes(e,n){this.isCollapsed()||this.removeText();const o=this.anchor,r=o.offset,s=o.getNode();let i=s;if(o.type==="element"){const g=o.getNode(),p=g.getChildAtIndex(r-1);p===null?i=g:i=p}const l=[],a=s.getNextSiblings(),c=V(s)?null:s.getTopLevelElementOrThrow();if(b(s)){const p=s.getTextContent().length;if(r===0&&p!==0){const _=s.getPreviousSibling();_!==null?i=_:i=s.getParentOrThrow(),l.push(s)}else if(r===p)i=s;else{if(et(s))return!1;{let _;[i,_]=s.splitText(r),l.push(_)}}}const u=i;l.push(...a);const d=e[0];let f=!1,h=null;for(let g=0;g<e.length;g++){const p=e[g];if(S(p)){if(p.is(d)){if(S(i)&&i.isEmpty()&&i.canReplaceWith(p)){i.replace(p),i=p,f=!0;continue}const _=p.getFirstDescendant();if(Rn(_)){let C=_.getParentOrThrow();for(;C.isInline();)C=C.getParentOrThrow();const x=C.getChildren(),E=x.length;if(S(i))for(let N=0;N<E;N++)h=x[N],i.append(h);else{for(let N=E-1;N>=0;N--)h=x[N],i.insertAfter(h);i=i.getParentOrThrow()}if(C.remove(),f=!0,C.is(p))continue}}if(b(i)){if(c===null)throw Error("insertNode: topLevelElement is root node");i=c}}else if(f&&!re(p)&&V(i.getParent()))throw Error("insertNodes: cannot insert a non-element into a root node");if(f=!1,S(i))if(h=p,re(p)&&p.isTopLevel())i=i.insertAfter(p);else if(S(p)){if(!p.canBeEmpty()&&p.isEmpty())continue;if(V(i)){const _=i.getChildAtIndex(r);_!==null?_.insertBefore(p):i.append(p),i=p}else i=i.insertAfter(p)}else{const _=i.getFirstChild();_!==null?_.insertBefore(p):i.append(p),i=p}else if(!S(p)||re(i)&&i.isTopLevel())h=p,i=i.insertAfter(p);else{i=p.getParentOrThrow(),g--;continue}}if(n)if(b(u))u.select();else{const g=i.getPreviousSibling();if(b(g))g.select();else{const p=i.getIndexWithinParent();i.getParentOrThrow().select(p,p)}}if(S(i)){const g=b(h)?h:i.getLastDescendant();if(n||(g===null?i.select():b(g)?g.select():g.selectNext()),l.length!==0)for(let p=l.length-1;p>=0;p--){const _=l[p],C=_.getParentOrThrow();if(S(i)&&!S(_))i.append(_),i=_;else if(!S(i)&&!S(_))i.insertBefore(_),i=_;else if(S(_)&&!_.canInsertAfter(i)){const x=C.constructor.clone(C);if(!S(x))throw Error("insertNodes: cloned parent clone is not an element");x.append(_),i.insertAfter(x)}else i.insertAfter(_);C.isEmpty()&&!C.canBeEmpty()&&C.remove()}}else if(!n)if(b(i))i.select();else{const g=i.getParentOrThrow(),p=i.getIndexWithinParent()+1;g.select(p,p)}return!0}insertParagraph(){this.isCollapsed()||this.removeText();const e=this.anchor,n=e.offset;let o,r=[],s=[];if(e.type==="text"){const a=e.getNode();r=a.getNextSiblings().reverse(),o=a.getParentOrThrow();const c=o.isInline(),u=c?o.getTextContentSize():a.getTextContentSize();if(n===0)r.push(a);else if(c&&(s=o.getNextSiblings()),n!==u&&(!c||n!==a.getTextContentSize())){const[,d]=a.splitText(n);r.push(d)}}else{if(o=e.getNode(),V(o)){const a=U(),c=o.getChildAtIndex(n);a.select(),c!==null?c.insertBefore(a):o.append(a);return}r=o.getChildren().slice(n).reverse()}const i=r.length;if(n===0&&i>0&&o.isInline()){o.getParentOrThrow().insertBefore(U());return}const l=o.insertNewAfter(this);if(l===null)this.insertLineBreak();else if(S(l)){const a=o.getFirstChild();if(n===0&&(o.is(e.getNode())||a&&a.is(e.getNode()))&&i>0){o.insertBefore(l);return}let u=null;const d=s.length,f=l.getParentOrThrow();if(d>0)for(let h=0;h<d;h++){const g=s[h];f.append(g)}if(i!==0)for(let h=0;h<i;h++){const g=r[h];u===null?l.append(g):u.insertBefore(g),u=g}!l.canBeEmpty()&&l.getChildrenSize()===0?(l.selectPrevious(),l.remove()):l.selectStart()}}insertLineBreak(e){const n=dt(),o=this.anchor;if(o.type==="element"){const r=o.getNode();V(r)&&this.insertParagraph()}e?this.insertNodes([n],!0):this.insertNodes([n])&&n.selectNext(0,0)}getCharacterOffsets(){return po(this)}extract(){const e=this.getNodes(),n=e.length,o=n-1,r=this.anchor,s=this.focus;let i=e[0],l=e[o];const[a,c]=po(this);if(n===0)return[];if(n===1){if(b(i)){const d=a>c?c:a,f=a>c?a:c,h=i.splitText(d,f),g=d===0?h[0]:h[1];return g!=null?[g]:[]}return[i]}const u=r.isBefore(s);if(b(i)){const d=u?a:c;d===i.getTextContentSize()?e.shift():d!==0&&([,i]=i.splitText(d),e[0]=i)}if(b(l)){const f=l.getTextContent().length,h=u?c:a;h===0?e.pop():h!==f&&([l]=l.splitText(h),e[o]=l)}return e}modify(e,n,o){const r=this.focus,s=this.anchor,i=e==="move",l=ql(r,n);if(re(l)&&!l.isIsolated()){const c=n?l.getPreviousSibling():l.getNextSibling();if(b(c)){const u=c.__key,d=n?c.getTextContent().length:0;r.set(u,d,"text"),i&&s.set(u,d,"text");return}else{const u=l.getParentOrThrow();let d,f;S(c)?(f=c.__key,d=n?c.getChildrenSize():0):(d=l.getIndexWithinParent(),f=u.__key,n||d++),r.set(f,d,"element"),i&&s.set(f,d,"element");return}}const a=je();if(rf(a,e,n?"backward":"forward",o),a.rangeCount>0){const c=a.getRangeAt(0);this.applyDOMRange(c),!i&&(a.anchorNode!==c.startContainer||a.anchorOffset!==c.startOffset)&&of(this)}}deleteCharacter(e){if(this.isCollapsed()){const n=this.anchor,o=this.focus;let r=n.getNode();if(!e&&(n.type==="element"&&n.offset===r.getChildrenSize()||n.type==="text"&&n.offset===r.getTextContentSize())){const s=r.getNextSibling()||r.getParentOrThrow().getNextSibling();if(S(s)&&!s.canExtractContents())return}if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&n.offset===0&&(n.type==="element"?n.getNode():n.getNode().getParentOrThrow()).collapseAtStart(this))return}else{const s=o.type==="text"?o.getNode():null;if(r=n.type==="text"?n.getNode():null,s!==null&&s.isSegmented()){const i=o.offset,l=s.getTextContentSize();if(s.is(r)||e&&i!==l||!e&&i!==0){Js(s,e,i);return}}else if(r!==null&&r.isSegmented()){const i=n.offset,l=r.getTextContentSize();if(r.is(s)||e&&i!==0||!e&&i!==l){Js(r,e,i);return}}sf(this,e)}}this.removeText()}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.removeText()}deleteWord(e){this.isCollapsed()&&this.modify("extend",e,"word"),this.removeText()}}function Le(t){return t instanceof Bn}function Xs(t){const e=t.offset;if(t.type==="text")return e;const n=t.getNode();return e===n.getChildrenSize()?n.getTextContent().length:0}function po(t){const e=t.anchor,n=t.focus;return e.type==="element"&&n.type==="element"&&e.key===n.key&&e.offset===n.offset?[0,0]:[Xs(e),Xs(n)]}function of(t){const e=t.focus,n=t.anchor,o=n.key,r=n.offset,s=n.type;it(n,e.key,e.offset,e.type),it(e,o,r,s)}function rf(t,e,n,o){t.modify(e,n,o)}function sf(t,e){const n=t.anchor,o=t.focus,r=n.getNode(),s=o.getNode();if(r===s&&n.type==="text"&&o.type==="text"){const i=n.offset,l=o.offset,a=i<l,c=a?i:l,u=a?l:i,d=u-1;if(c!==d){const f=r.getTextContent().slice(c,u);Hu(f)||(e?o.offset=d:n.offset=d)}}}function Js(t,e,n){const o=t,s=o.getTextContent().split(/\s/g),i=s.length;let l=0,a=0;for(let u=0;u<i;u++){const d=s[u],f=u===i-1;if(a=l,l+=d.length,e&&l===n||l>n||f){s.splice(u,1),f&&(a=void 0);break}}const c=s.join(" ");c===""?o.remove():(o.setTextContent(c),o.select(a,a))}function lf(t,e,n){const o=t.getParent();return n===null||o===null||!o.canBeEmpty()||o!==n.getNode()}function Qs(t,e,n){let o=e,r;if(t.nodeType===Nl){let s=!1;const i=t.childNodes,l=i.length;o===l&&(s=!0,o=l-1);const a=i[o];if(r=ro(a),b(r))o=Bs(r,s);else{let c=ro(t);if(c===null)return null;if(S(c)){let u=c.getChildAtIndex(o);if(S(u)&&lf(u,o,n)){const d=s?u.getLastDescendant():u.getFirstDescendant();d===null?(c=u,o=0):(u=d,c=u.getParentOrThrow())}b(u)?(r=u,c=null,o=Bs(r,s)):u!==c&&s&&o++}else{const u=c.getIndexWithinParent();e===0&&re(c)&&ro(t)===c?o=u:o=u+1,c=c.getParentOrThrow()}if(S(c))return Te(c.__key,o,"element")}}else r=ro(t);return b(r)?Te(r.__key,o,"text"):null}function Zs(t,e,n){const o=t.offset,r=t.getNode();if(o===0){const s=r.getPreviousSibling(),i=r.getParent();if(!e)S(s)&&!n&&s.isInline()?(t.key=s.__key,t.offset=s.getChildrenSize(),t.type="element"):b(s)&&!s.isInert()&&(t.key=s.__key,t.offset=s.getTextContent().length);else if((n||!e)&&s===null&&S(i)&&i.isInline()){const l=i.getPreviousSibling();b(l)&&(t.key=l.__key,t.offset=l.getTextContent().length)}}else if(o===r.getTextContent().length){const s=r.getNextSibling(),i=r.getParent();if(e&&S(s)&&s.isInline())t.key=s.__key,t.offset=0,t.type="element";else if((n||e)&&s===null&&S(i)&&i.isInline()){const l=i.getNextSibling();b(l)&&(t.key=l.__key,t.offset=0)}}}function ma(t,e,n){if(t.type==="text"&&e.type==="text"){const o=t.isBefore(e),r=t.is(e);Zs(t,o,r),Zs(e,!o,r),r&&(e.key=t.key,e.offset=t.offset,e.type=t.type);const s=ae();if(s.isComposing()&&s._compositionKey!==t.key&&w(n)){const i=n.anchor,l=n.focus;it(t,i.key,i.offset,i.type),it(e,l.key,l.offset,l.type)}}}function _a(t,e,n,o,r,s){if(t===null||n===null||!Kl(r,t,n))return null;const i=Qs(t,e,w(s)?s.anchor:null);if(i===null)return null;const l=Qs(n,o,w(s)?s.focus:null);return l===null?null:(ma(i,l,s),[i,l])}function xa(t,e,n,o,r,s){const i=Je(),l=new Dt(Te(t,e,r),Te(n,o,s),0);return l.dirty=!0,i._selection=l,l}function Pn(){const t=Te("root",0,"element"),e=Te("root",0,"element");return new Dt(t,e,0)}function af(){return new Bn(new Set)}function ei(){const t=Te("root",0,"element"),e=Te("root",0,"element");return new Kn("root",t,e)}function cf(){const t=window.event;return t&&t.type}function uf(t){const n=t.getEditorState()._selection,o=je();return Le(n)||Z(n)?n.clone():df(n,o,t)}function df(t,e,n){const o=cf(),r=o==="selectionchange",s=!Jd()&&(r||o==="beforeinput"||o==="compositionstart"||o==="compositionend"||o==="click"&&window.event.detail===3||o===void 0);let i,l,a,c;if(!w(t)||s){if(e===null)return null;i=e.anchorNode,l=e.focusNode,a=e.anchorOffset,c=e.focusOffset}else return t.clone();const u=_a(i,a,l,c,n,t);if(u===null)return null;const[d,f]=u;return new Dt(d,f,w(t)?t.format:0)}function T(){return Je()._selection}function Vo(){return ae()._editorState._selection}function ff(t){if(t!==null){if(t.type==="range")return new Dt(Te(t.anchor.key,t.anchor.offset,t.anchor.type),Te(t.focus.key,t.focus.offset,t.focus.type),0);if(t.type==="node")return new Bn(new Set(t.nodes));if(t.type==="grid")return new Kn(t.gridKey,Te(t.anchor.key,t.anchor.offset,t.anchor.type),Te(t.focus.key,t.focus.offset,t.focus.type))}return null}function Do(t,e,n,o=1){const r=t.anchor,s=t.focus,i=r.getNode(),l=s.getNode();if(!e.is(i)&&!e.is(l))return;const a=e.__key;if(t.isCollapsed()){const g=r.offset;if(n<=g){const p=Math.max(0,g+o);r.set(a,p,"element"),s.set(a,p,"element"),ti(t)}return}const c=t.isBackward(),u=c?s:r,d=u.getNode(),f=c?r:s,h=f.getNode();if(e.is(d)){const g=u.offset;n<=g&&u.set(a,Math.max(0,g+o),"element")}if(e.is(h)){const g=f.offset;n<=g&&f.set(a,Math.max(0,g+o),"element")}ti(t)}function ti(t){const e=t.anchor,n=e.offset,o=t.focus,r=o.offset,s=e.getNode(),i=o.getNode();if(t.isCollapsed()){if(!S(s))return;const l=s.getChildrenSize(),a=n>=l,c=a?s.getChildAtIndex(l-1):s.getChildAtIndex(n);if(b(c)){let u=0;a&&(u=c.getTextContentSize()),e.set(c.__key,u,"text"),o.set(c.__key,u,"text")}return}if(S(s)){const l=s.getChildrenSize(),a=n>=l,c=a?s.getChildAtIndex(l-1):s.getChildAtIndex(n);if(b(c)){let u=0;a&&(u=c.getTextContentSize()),e.set(c.__key,u,"text")}}if(S(i)){const l=i.getChildrenSize(),a=r>=l,c=a?i.getChildAtIndex(l-1):i.getChildAtIndex(r);if(b(c)){let u=0;a&&(u=c.getTextContentSize()),o.set(c.__key,u,"text")}}}function hf(t,e){const o=e.getEditorState()._selection,r=t._selection;if(w(r)){const s=r.anchor,i=r.focus;let l;if(s.type==="text"&&(l=s.getNode(),l.selectionTransform(o,r)),i.type==="text"){const a=i.getNode();l!==a&&a.selectionTransform(o,r)}}}function Lo(t,e,n,o,r){let s=null,i=0,l=null;o!==null?(s=o.__key,b(o)?(i=o.getTextContentSize(),l="text"):S(o)&&(i=o.getChildrenSize(),l="element")):r!==null&&(s=r.__key,b(r)?l="text":S(r)&&(l="element")),s!==null&&l!==null?t.set(s,i,l):(i=e.getIndexWithinParent(),i===-1&&(i=n.getChildrenSize()),t.set(n.__key,i,"element"))}function ni(t,e,n,o,r){t.type==="text"?(t.key=n,e||(t.offset+=r)):t.offset>o.getIndexWithinParent()&&(t.offset-=1)}function Dr(t,e,n){Y();const o=t.__key,r=t.getParent();if(r===null)return;const s=T();let i=!1;if(w(s)&&e){const d=s.anchor,f=s.focus;d.key===o&&(Lo(d,t,r,t.getPreviousSibling(),t.getNextSibling()),i=!0),f.key===o&&(Lo(f,t,r,t.getPreviousSibling(),t.getNextSibling()),i=!0)}const a=r.getWritable().__children,c=a.indexOf(o);if(c===-1)throw Error("Node is not a child of its parent");Rt(t),a.splice(c,1);const u=t.getWritable();u.__parent=null,w(s)&&e&&!i&&Do(s,r,c,-1),!n&&r!==null&&!V(r)&&!r.canBeEmpty()&&r.isEmpty()&&Dr(r,e),r!==null&&V(r)&&r.isEmpty()&&r.selectEnd()}function oi(t){const e=M(t);if(e===null)throw Error(`Expected node with key ${t} to exist but it's not in the nodeMap.`);return e}class Xo{static getType(){throw Error(`LexicalNode: Node ${this.name} does not implement .getType().`)}static clone(e){throw Error(`LexicalNode: Node ${this.name} does not implement .clone().`)}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,Ru(this,e);{const n=Object.getPrototypeOf(this);["getType","clone"].forEach(o=>{n.constructor.hasOwnProperty(o)||console.warn(`${this.constructor.name} must implement static "${o}" method`)}),this.__type!=="root"&&(Y(),gf(this.__type,this.constructor))}}getType(){return this.__type}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const n=M(e);if(n===null)break;e=n.__parent}return!1}isSelected(){const e=T();if(e==null)return!1;const o=new Set(e.getNodes().map(r=>r.__key)).has(this.__key);return b(this)?o:w(e)&&e.anchor.type==="element"&&e.focus.type==="element"&&e.anchor.key===e.focus.key&&e.anchor.offset===e.focus.offset?!1:o}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();return e===null?-1:e.__children.indexOf(this.__key)}getParent(){const e=this.getLatest().__parent;return e===null?null:M(e)}getParentOrThrow(){const e=this.getParent();if(e===null)throw Error(`Expected node ${this.__key} to have a parent.`);return e}getTopLevelElement(){let e=this;for(;e!==null;){const n=e.getParent();if(V(n)&&S(e))return e;e=n}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();if(e===null)throw Error(`Expected node ${this.__key} to have a top parent element.`);return e}getParents(){const e=[];let n=this.getParent();for(;n!==null;)e.push(n),n=n.getParent();return e}getParentKeys(){const e=[];let n=this.getParent();for(;n!==null;)e.push(n.__key),n=n.getParent();return e}getPreviousSibling(){const e=this.getParent();if(e===null)return null;const n=e.__children,o=n.indexOf(this.__key);return o<=0?null:M(n[o-1])}getPreviousSiblings(){const e=this.getParent();if(e===null)return[];const n=e.__children,o=n.indexOf(this.__key);return n.slice(0,o).map(r=>oi(r))}getNextSibling(){const e=this.getParent();if(e===null)return null;const n=e.__children,o=n.length,r=n.indexOf(this.__key);return r>=o-1?null:M(n[r+1])}getNextSiblings(){const e=this.getParent();if(e===null)return[];const n=e.__children,o=n.indexOf(this.__key);return n.slice(o+1).map(r=>oi(r))}getCommonAncestor(e){const n=this.getParents(),o=e.getParents();S(this)&&n.unshift(this),S(e)&&o.unshift(e);const r=n.length,s=o.length;if(r===0||s===0||n[r-1]!==o[s-1])return null;const i=new Set(o);for(let l=0;l<r;l++){const a=n[l];if(i.has(a))return a}return null}is(e){return e==null?!1:this.__key===e.__key}isBefore(e){if(e.isParentOf(this))return!0;if(this.isParentOf(e))return!1;const n=this.getCommonAncestor(e);let o=0,r=0,s=this;for(;;){const i=s.getParentOrThrow();if(i===n){o=i.__children.indexOf(s.__key);break}s=i}for(s=e;;){const i=s.getParentOrThrow();if(i===n){r=i.__children.indexOf(s.__key);break}s=i}return o<r}isParentOf(e){const n=this.__key;if(n===e.__key)return!1;let o=e;for(;o!==null;){if(o.__key===n)return!0;o=o.getParent()}return!1}getNodesBetween(e){const n=this.isBefore(e),o=[],r=new Set;let s=this,i=null;for(;;){const l=s.__key;if(r.has(l)||(r.add(l),o.push(s)),s===e)break;const a=S(s)?n?s.getFirstChild():s.getLastChild():null;if(a!==null){i===null&&(i=s),s=a;continue}const c=n?s.getNextSibling():s.getPreviousSibling();if(c!==null){s=c;continue}const u=s.getParentOrThrow();if(r.has(u.__key)||o.push(u),u===e)break;let d=null,f=u;u.is(i)&&(i=null);do{if(f===null)throw Error("getNodesBetween: ancestor is null");d=n?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),f!==null&&(f.is(i)&&(i=null),d===null&&!r.has(f.__key)&&o.push(f))}while(d===null);s=d}return n||o.reverse(),o}isDirty(){const n=ae()._dirtyLeaves;return n!==null&&n.has(this.__key)}isComposing(){return this.__key===lt()}getLatest(){const e=M(this.__key);if(e===null)throw Error("getLatest: node not found");return e}getWritable(){Y();const e=Je(),n=ae(),o=e._nodeMap,r=this.__key,s=this.getLatest(),i=s.__parent,l=n._cloneNotNeeded;if(l.has(r))return $t(s),s;const c=s.constructor.clone(s);if(c.__parent=i,S(s)&&S(c))c.__children=Array.from(s.__children),c.__indent=s.__indent,c.__format=s.__format,c.__dir=s.__dir;else if(b(s)&&b(c)){const u=s.__marks;c.__format=s.__format,c.__style=s.__style,c.__mode=s.__mode,c.__detail=s.__detail,c.__marks=u===null?u:Array.from(u)}return l.add(r),c.__key=r,$t(c),o.set(r,c),c}getTextContent(e,n){return""}getTextContentSize(e,n){return this.getTextContent(e,n).length}createDOM(e,n){throw Error("createDOM: base method not extended")}updateDOM(e,n,o){throw Error("updateDOM: base method not extended")}exportDOM(e){if(re(this)){const o=e.getElementByKey(this.getKey());return{element:o?o.cloneNode():null}}return{element:this.createDOM(e._config,e)}}static importDOM(){return null}remove(e){Y(),Dr(this,!0,e)}replace(e){Y();const n=this.__key,o=e.getWritable();fo(o);const r=this.getParentOrThrow(),i=r.getWritable().__children,l=i.indexOf(this.__key),a=o.__key;if(l===-1)throw Error("Node is not a child of its parent");i.splice(l,0,a),o.__parent=r.__key,Dr(this,!1),Rt(o);const c=T();if(w(c)){const u=c.anchor,d=c.focus;u.key===n&&qs(u,o),d.key===n&&qs(d,o)}return lt()===n&&_e(a),o}insertAfter(e){Y();const n=this.getWritable(),o=e.getWritable(),r=o.getParent(),s=T(),i=e.getIndexWithinParent();let l=!1,a=!1;if(r!==null&&(fo(o),w(s))){const h=r.__key,g=s.anchor,p=s.focus;l=g.type==="element"&&g.key===h&&g.offset===i+1,a=p.type==="element"&&p.key===h&&p.offset===i+1}const c=this.getParentOrThrow().getWritable(),u=o.__key;o.__parent=n.__parent;const d=c.__children,f=d.indexOf(n.__key);if(f===-1)throw Error("Node is not a child of its parent");if(d.splice(f+1,0,u),Rt(o),w(s)){Do(s,c,f+1);const h=c.__key;l&&s.anchor.set(h,f+2,"element"),a&&s.focus.set(h,f+2,"element")}return e}insertBefore(e){Y();const n=this.getWritable(),o=e.getWritable();fo(o);const r=this.getParentOrThrow().getWritable(),s=o.__key;o.__parent=n.__parent;const i=r.__children,l=i.indexOf(n.__key);if(l===-1)throw Error("Node is not a child of its parent");i.splice(l,0,s),Rt(o);const a=T();return w(a)&&Do(a,r,l),e}selectPrevious(e,n){Y();const o=this.getPreviousSibling(),r=this.getParentOrThrow();if(o===null)return r.select(0,0);if(S(o))return o.select();if(!b(o)){const s=o.getIndexWithinParent()+1;return r.select(s,s)}return o.select(e,n)}selectNext(e,n){Y();const o=this.getNextSibling(),r=this.getParentOrThrow();if(o===null)return r.select();if(S(o))return o.select(0,0);if(!b(o)){const s=o.getIndexWithinParent();return r.select(s,s)}return o.select(e,n)}markDirty(){this.getWritable()}}function gf(t,e){const n=ae()._nodes.get(t);if(n===void 0)throw Error(`Create node: Attempted to create node ${e.name} that was not previously registered on the editor. You can use register your custom nodes.`);const o=n.klass;if(o!==e)throw Error(`Create node: Type ${t} in node ${e.name} does not match registered node ${o.name} with the same type`)}class gt extends Xo{constructor(e){super(e);{const n=Object.getPrototypeOf(this);["decorate"].forEach(o=>{n.hasOwnProperty(o)||console.warn(`${this.constructor.name} must implement "${o}" method`)})}}decorate(e){throw Error("decorate: base method not extended")}isIsolated(){return!1}isTopLevel(){return!1}}function re(t){return t instanceof gt}class Oe extends Xo{constructor(e){super(e);this.__children=[],this.__format=0,this.__indent=0,this.__dir=null}getFormat(){return this.getLatest().__format}getIndent(){return this.getLatest().__indent}getChildren(){const n=this.getLatest().__children,o=[];for(let r=0;r<n.length;r++){const s=M(n[r]);s!==null&&o.push(s)}return o}getChildrenKeys(){return this.getLatest().__children}getChildrenSize(){return this.getLatest().__children.length}isEmpty(){return this.getChildrenSize()===0}isDirty(){const n=ae()._dirtyElements;return n!==null&&n.has(this.__key)}getAllTextNodes(e){const n=[],r=this.getLatest().__children;for(let s=0;s<r.length;s++){const i=M(r[s]);if(b(i)&&(e||!i.isInert()))n.push(i);else if(S(i)){const l=i.getAllTextNodes(e);n.push(...l)}}return n}getFirstDescendant(){let e=this.getFirstChild();for(;e!==null;){if(S(e)){const n=e.getFirstChild();if(n!==null){e=n;continue}}break}return e}getLastDescendant(){let e=this.getLastChild();for(;e!==null;){if(S(e)){const n=e.getLastChild();if(n!==null){e=n;continue}}break}return e}getDescendantByIndex(e){const n=this.getChildren(),o=n.length;if(o===0)return this;if(e>=o){const s=n[o-1];return S(s)&&s.getLastDescendant()||s}const r=n[e];return S(r)&&r.getFirstDescendant()||r}getFirstChild(){const n=this.getLatest().__children;return n.length===0?null:M(n[0])}getFirstChildOrThrow(){const e=this.getFirstChild();if(e===null)throw Error(`Expected node ${this.__key} to have a first child.`);return e}getLastChild(){const n=this.getLatest().__children,o=n.length;return o===0?null:M(n[o-1])}getChildAtIndex(e){const r=this.getLatest().__children[e];return r===void 0?null:M(r)}getTextContent(e,n){let o="";const r=this.getChildren(),s=r.length;for(let i=0;i<s;i++){const l=r[i];o+=l.getTextContent(e,n),S(l)&&i!==s-1&&!l.isInline()&&(o+=`

`)}return o}getDirection(){return this.getLatest().__dir}hasFormat(e){const n=Rs[e];return(this.getFormat()&n)!==0}select(e,n){Y();const o=T();let r=e,s=n;const i=this.getChildrenSize();r===void 0&&(r=i),s===void 0&&(s=i);const l=this.__key;if(w(o))o.anchor.set(l,r,"element"),o.focus.set(l,s,"element"),o.dirty=!0;else return xa(l,r,l,s,"element","element");return o}selectStart(){const e=this.getFirstDescendant();return S(e)||b(e)?e.select(0,0):e!==null?e.selectPrevious():this.select(0,0)}selectEnd(){const e=this.getLastDescendant();return S(e)||b(e)?e.select():e!==null?e.selectNext():this.select()}clear(){Y();const e=this.getWritable();return this.getChildren().forEach(o=>o.remove()),e}append(...e){return Y(),this.splice(this.getChildrenSize(),0,e)}setDirection(e){Y();const n=this.getWritable();return n.__dir=e,n}setFormat(e){Y();const n=this.getWritable();return n.__format=Rs[e],this}setIndent(e){Y();const n=this.getWritable();return n.__indent=e,this}splice(e,n,o){Y();const r=this.getWritable(),s=r.__key,i=r.__children,l=o.length,a=[];for(let f=0;f<l;f++){const h=o[f],g=h.getWritable();if(h.__key===s)throw Error("append: attemtping to append self");fo(g),g.__parent=s;const p=g.__key;a.push(p)}const c=this.getChildAtIndex(e-1);c&&$t(c);const u=this.getChildAtIndex(e+n);u&&$t(u);let d;if(e===i.length?(i.push(...a),d=[]):d=i.splice(e,n,...a),d.length){const f=T();if(w(f)){const h=new Set(d),g=new Set(a),p=E=>{let N=E.getNode();for(;N;){const k=N.__key;if(h.has(k)&&!g.has(k))return!0;N=N.getParent()}return!1},{anchor:_,focus:C}=f;p(_)&&Lo(_,_.getNode(),this,c,u),p(C)&&Lo(C,C.getNode(),this,c,u);const x=d.length;for(let E=0;E<x;E++){const N=M(d[E]);if(N!=null){const k=N.getWritable();k.__parent=null}}i.length===0&&!this.canBeEmpty()&&!V(this)&&this.remove()}}return r}insertNewAfter(e){return null}canInsertTab(){return!1}collapseAtStart(e){return!1}excludeFromCopy(){return!1}canExtractContents(){return!0}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}canMergeWith(e){return!1}}function S(t){return t instanceof Oe}class $n extends Oe{static getType(){return"root"}static clone(){return new $n}constructor(){super("root");this.__cachedText=null}getTopLevelElementOrThrow(){throw Error("getTopLevelElementOrThrow: root nodes are not top level elements")}getTextContent(e,n){const o=this.__cachedText;return(aa()||ae()._dirtyType===Tt)&&o!==null&&(!e||n!==!1)?o:super.getTextContent(e,n)}remove(){throw Error("remove: cannot be called on root nodes")}replace(e){throw Error("replace: cannot be called on root nodes")}insertBefore(e){throw Error("insertBefore: cannot be called on root nodes")}insertAfter(e){throw Error("insertAfter: cannot be called on root nodes")}updateDOM(e,n){return!1}append(...e){for(let n=0;n<e.length;n++){const o=e[n];if(!S(o)&&!re(o))throw Error("rootNode.append: Only element or decorator nodes can be appended to the root node")}return super.append(...e)}toJSON(){return{__children:this.__children,__dir:this.__dir,__format:this.__format,__indent:this.__indent,__key:"root",__parent:null,__type:"root"}}}function pf(){return new $n}function V(t){return t instanceof $n}function mf(t,e){const n=e.getEditorState()._selection,o=t._selection;if(o!==null){if(o.dirty||!o.is(n))return!0}else if(n!==null)return!0;return!1}function _f(t){return new Hn(new Map(t._nodeMap))}function ya(){return new Hn(new Map([["root",pf()]]))}class Hn{constructor(e,n){this._nodeMap=e,this._selection=n||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e){return Ud(this,e)}clone(e){const n=new Hn(this._nodeMap,e===void 0?this._selection:e);return n._readOnly=!0,n}toJSON(e){const n=this._selection;return{_nodeMap:Array.from(this._nodeMap.entries()),_selection:w(n)?{anchor:{key:n.anchor.key,offset:n.anchor.offset,type:n.anchor.type},focus:{key:n.focus.key,offset:n.focus.offset,type:n.focus.type},type:"range"}:Le(n)?{nodes:Array.from(n._nodes),type:"node"}:Z(n)?{anchor:{key:n.anchor.key,offset:n.anchor.offset,type:n.anchor.type},focus:{key:n.focus.key,offset:n.focus.offset,type:n.focus.type},gridKey:n.gridKey,type:"grid"}:null}}}class zn extends Xo{static getType(){return"linebreak"}static clone(e){return new zn(e.__key)}constructor(e){super(e)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}static importDOM(){return{br:e=>({conversion:xf,priority:0})}}}function xf(t){return{node:dt()}}function dt(){return new zn}function ce(t){return t instanceof zn}function Ca(t,e,n){const o=t.length,r=e.length;let s=0,i=0;for(;s<o&&s<r&&t[s]===e[s]&&s<n;)s++;for(;i+s<o&&i+s<r&&t[o-i-1]===e[r-i-1];)i++;for(;i+s<o&&i+s<r&&t[s]===e[s];)s++;return{index:s,insert:e.slice(s,r-i),remove:o-s-i}}function ir(t,e){return e&Dl?"code":e&Ll?"sub":e&Ol?"sup":null}function lr(t,e){return e&kl?"strong":e&vl?"em":"span"}function Ea(t,e,n,o,r){const s=o.classList;let i=ho(r,"base");i!==void 0&&s.add(...i),i=ho(r,"underlineStrikethrough");let l=!1;const a=e&Nr&&e&Er,c=n&Nr&&n&Er;i!==void 0&&(c?(l=!0,a||s.add(...i)):a&&s.remove(...i));for(const u in Kt){const f=Kt[u];if(i=ho(r,u),i!==void 0)if(n&f){if(l&&(u==="underline"||u==="strikethrough")){e&f&&s.remove(...i);continue}((e&f)===0||a&&u==="underline"||u==="strikethrough")&&s.add(...i)}else e&f&&s.remove(...i)}}function yf(t,e){const n=t.length,o=e.length;let r=0,s=0;for(;r<n&&r<o&&t[r]===e[r];)r++;for(;s+r<n&&s+r<o&&t[n-s-1]===e[o-s-1];)s++;return[r,n-r-s,e.slice(r,o-s)]}function Na(t,e,n){const o=e.firstChild,r=n.isComposing(),i=t+(r?Ur:"");if(o==null)e.textContent=i;else{const l=o.nodeValue;if(l!==i)if(r){const[a,c,u]=yf(l,i);c!==0&&o.deleteData(a,c),o.insertData(a,u)}else o.nodeValue=i}}function ri(t,e,n,o,r,s){Na(r,t,e);const l=s.theme.text;l!==void 0&&Ea(n,0,o,t,l)}function si(t,e,n,o,r){for(let s=0;s<e.length;s++){const{id:i,start:l,end:a}=e[s];let c=l,u=a;c!==null&&c>=n&&(n+o>=c&&(c=n+o),c+=r-o),u!==null&&u>=n&&(n+o>=u&&(u=n),u+=r-o),(c!==l||u!==a)&&(c===null&&u===null||c!==null&&u!==null&&c>=u?t.deleteMark(i):t.setMark(i,c,u))}}class Ne extends Xo{static getType(){return"text"}static clone(e){return new Ne(e.__text,e.__key)}constructor(e,n){super(n);this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0,this.__marks=null}getFormat(){return this.getLatest().__format}getMark(e){const o=this.getLatest().__marks;if(o!==null)for(let r=0;r<o.length;r++){const s=o[r];if(s.id===e)return s}return null}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===wl}isSegmented(){return this.getLatest().__mode===bl}isInert(){return this.getLatest().__mode===Sl}isDirectionless(){return(this.getLatest().__detail&Fs)!==0}isUnmergeable(){return(this.getLatest().__detail&Ms)!==0}hasFormat(e){const n=Kt[e];return(this.getFormat()&n)!==0}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(e,n){return!e&&this.isInert()||n===!1&&this.isDirectionless()?"":this.getLatest().__text}getFormatFlags(e,n){const r=this.getLatest().__format;return Hl(r,e,n)}createDOM(e){const n=this.__format,o=ir(this,n),r=lr(this,n),s=o===null?r:o,i=document.createElement(s);let l=i;o!==null&&(l=document.createElement(r),i.appendChild(l));const a=this.__text;ri(l,this,r,n,a,e);const c=this.__style;return c!==""&&(i.style.cssText=c),i}updateDOM(e,n,o){const r=this.__text,s=e.__format,i=this.__format,l=ir(this,s),a=ir(this,i),c=lr(this,s),u=lr(this,i);if((l===null?c:l)!==(a===null?u:a))return!0;if(l===a&&c!==u){const x=n.firstChild;if(x==null)throw Error("updateDOM: prevInnerDOM is null or undefined");const E=document.createElement(u);return ri(E,this,u,i,r,o),n.replaceChild(E,x),!1}let h=n;if(a!==null&&l!==null&&(h=n.firstChild,h==null))throw Error("updateDOM: innerDOM is null or undefined");Na(r,h,this);const p=o.theme.text;p!==void 0&&s!==i&&Ea(u,s,i,h,p);const _=e.__style,C=this.__style;return _!==C&&(n.style.cssText=C),!1}static importDOM(){return{"#text":e=>({conversion:Nf,priority:0}),b:e=>({conversion:Ef,priority:0}),em:e=>({conversion:so,priority:0}),i:e=>({conversion:so,priority:0}),span:e=>({conversion:Cf,priority:0}),strong:e=>({conversion:so,priority:0}),u:e=>({conversion:so,priority:0})}}selectionTransform(e,n){}setFormat(e){Y();const n=this.getWritable();return n.__format=e,n}setStyle(e){Y();const n=this.getWritable();return n.__style=e,n}toggleFormat(e){const n=Kt[e];return this.setFormat(this.getFormat()^n)}toggleDirectionless(){Y();const e=this.getWritable();return e.__detail^=Fs,e}toggleUnmergeable(){Y();const e=this.getWritable();return e.__detail^=Ms,e}setMark(e,n,o){Y();const r=this.getWritable();let s=r.__marks,i=!1;s===null&&(r.__marks=s=[]);const l={end:o,id:e,start:n};Object.freeze(l);for(let a=0;a<s.length;a++)if(s[a].id===e){i=!0,s.splice(a,1,l);break}i||s.push(l)}deleteMark(e){Y();const n=this.getWritable(),o=n.__marks;if(o!==null){for(let r=0;r<o.length;r++)if(o[r].id===e){o.splice(r,1);break}o.length===0&&(n.__marks=null)}}setMode(e){Y();const n=Du[e],o=this.getWritable();return o.__mode=n,o}setTextContent(e){Y();const n=this.getWritable();if(n.__marks!==null){const r=T();let s=e.length;if(w(r)&&r.isCollapsed()){const l=r.anchor;l.key===this.__key&&(s=l.offset)}const i=Ca(n.__text,e,s);this.spliceText(i.index,i.remove,i.insert)}else n.__text=e;return n}select(e,n){Y();let o=e,r=n;const s=T(),i=this.getTextContent(),l=this.__key;if(typeof i=="string"){const a=i.length;o===void 0&&(o=a),r===void 0&&(r=a)}else o=0,r=0;if(w(s)){const a=lt();(a===s.anchor.key||a===s.focus.key)&&_e(l),s.setTextNodeRange(this,o,this,r)}else return xa(l,o,l,r,"text","text");return s}spliceText(e,n,o,r){Y();const s=this.getWritable(),i=s.__text,l=o.length;let a=e;a<0&&(a=l+a,a<0&&(a=0));const c=T();if(r&&w(c)){const f=e+l;c.setTextNodeRange(s,f,s,f)}const u=i.slice(0,a)+o+i.slice(a+n),d=s.__marks;return d!==null&&si(s,d,e,n,l),s.__text=u,s}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){Y();const n=this.getLatest(),o=n.getTextContent(),r=n.__key,s=lt(),i=new Set(e),l=[],a=o.length;let c="";for(let H=0;H<a;H++)c!==""&&i.has(H)&&(l.push(c),c=""),c+=o[H];c!==""&&l.push(c);const u=l.length;if(u===0)return[];if(l[0]===o)return[n];const d=l[0],f=n.getParentOrThrow(),h=f.__key;let g;const p=n.getFormat(),_=n.getStyle(),C=n.__detail,x=n.__marks;let E=!1;n.isSegmented()?(g=K(d),g.__parent=h,g.__format=p,g.__style=_,g.__detail=C,g.__marks=x,E=!0):(g=n.getWritable(),g.__text=d);const N=T(),k=[g];let D=d.length;for(let H=1;H<u;H++){const q=l[H],ne=q.length,Q=K(q).getWritable();Q.__format=p,Q.__style=_,Q.__detail=C;const oe=Q.__key,He=D+ne;if(w(N)){const de=N.anchor,ee=N.focus;de.key===r&&de.type==="text"&&de.offset>D&&de.offset<=He&&(de.key=oe,de.offset-=D,N.dirty=!0),ee.key===r&&ee.type==="text"&&ee.offset>D&&ee.offset<=He&&(ee.key=oe,ee.offset-=D,N.dirty=!0)}s===r&&_e(oe),D=He,Q.__parent=h,k.push(Q)}if(x!==null)for(let H=0;H<x.length;H++){const{id:q,start:ne,end:Q}=x[H];let oe=!1,He=!1,de=0;for(let ee=0;ee<u;ee++){const At=k[ee],ln=de+l[ee].length,an=!oe&&ne!==null&&ln>ne-(ne===0?1:0)?ne-de:null,cn=!He&&Q!==null&&ln>=Q?Q-de:null;if(an!==null||cn!==null){if(an!==null&&(oe=!0),cn!==null&&(He=!0),At.setMark(q,an,cn),oe&&He)break}else At.deleteMark(q);de=ln}}Rt(this);const L=f.getWritable().__children,R=L.indexOf(r),B=k.map(H=>H.__key);return E?(L.splice(R,0,...B),this.remove()):L.splice(R,1,...B),w(N)&&Do(N,f,R,u-1),k}mergeWithSibling(e){const n=e===this.getPreviousSibling();if(!n&&e!==this.getNextSibling())throw Error("mergeWithSibling: sibling must be a previous or next sibling");const o=this.__key,r=e.__key,s=this.__text,i=s.length;lt()===r&&_e(o);const a=T();if(w(a)){const g=a.anchor,p=a.focus;g!==null&&g.key===r&&(ni(g,n,o,e,i),a.dirty=!0),p!==null&&p.key===r&&(ni(p,n,o,e,i),a.dirty=!0)}const c=e.__text,u=c.length,d=n?c+s:s+c;this.setTextContent(d);const f=this.getWritable(),h=e.getLatest().__marks;return h!==null&&si(f,h,n?u:0,0,i),e.remove(),f}isTextEntity(){return!1}}function Cf(t){const n=t.style.fontWeight==="700";return{forChild:o=>(b(o)&&n&&o.toggleFormat("bold"),o),node:null}}function Ef(t){const n=t.style.fontWeight==="normal";return{forChild:o=>(b(o)&&!n&&o.toggleFormat("bold"),o),node:null}}function Nf(t){return{node:K(t.textContent)}}const Tf={em:"italic",i:"italic",strong:"bold",u:"underline"};function so(t){const e=Tf[t.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:n=>(b(n)&&n.toggleFormat(e),n),node:null}}function K(t=""){return new Ne(t)}function b(t){return t instanceof Ne}class Wn extends Oe{static getType(){return"paragraph"}static clone(e){return new Wn(e.__key)}createDOM(e){const n=document.createElement("p"),o=ho(e.theme,"paragraph");return o!==void 0&&n.classList.add(...o),n}updateDOM(e,n){return!1}static importDOM(){return{p:e=>({conversion:wf,priority:0})}}exportDOM(e){const{element:n}=super.exportDOM(e);return n&&this.getTextContentSize()===0&&n.append(document.createElement("br")),{element:n}}insertNewAfter(){const e=U(),n=this.getDirection();return e.setDirection(n),this.insertAfter(e),e}collapseAtStart(){const e=this.getChildren();if(e.length===0||b(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function wf(){return{node:U()}}function U(){return new Wn}function Gt(t){return t instanceof Wn}const F=0,J=1,ii=3,me=4;function Ta(t,e,n,o){const r=t._keyToDOMMap;r.clear(),t._editorState=ya(),t._pendingEditorState=o,t._compositionKey=null,t._dirtyType=Tt,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),t._normalizedNodes=new Set,t._updateTags=new Set,t._updates=[];const s=t._observer;s!==null&&(s.disconnect(),t._observer=null),e!==null&&(e.textContent=""),n!==null&&(n.textContent="",r.set("root",n))}function bf(t){const e=new Map,n=new Set;return t.forEach(o=>{const r=o.klass.importDOM;if(n.has(r))return;n.add(r);const s=r();s!==null&&Object.keys(s).forEach(i=>{let l=e.get(i);l===void 0&&(l=[],e.set(i,l)),l.push(s[i])})}),e}function Un(t){const e=t||{},n=e.namespace||zu(),o=e.theme||{},r=e.parentEditor||null,s=e.disableEvents||!1,i=ya(),l=e.editorState,a=[$n,Ne,zn,Wn,...e.nodes||[]],c=e.onError,u=e.readOnly||!1,d=new Map;for(let h=0;h<a.length;h++){const g=a[h],p=g.getType();d.set(p,{klass:g,transforms:new Set})}const f=new Sf(i,r,d,{disableEvents:s,namespace:n,theme:o},c,bf(d),u);return l!==void 0&&(f._pendingEditorState=l,f._dirtyType=Bt),f}class Sf{constructor(e,n,o,r,s,i,l){this._parentEditor=n,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,mutation:new Map,readonly:new Set,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=r,this._nodes=o,this._decorators={},this._pendingDecorators=null,this._dirtyType=Tt,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=Bl(),this._onError=s,this._htmlConversions=i,this._readOnly=!1}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const n=this._listeners.update;return n.add(e),()=>{n.delete(e)}}registerReadOnlyListener(e){const n=this._listeners.readonly;return n.add(e),()=>{n.delete(e)}}registerDecoratorListener(e){const n=this._listeners.decorator;return n.add(e),()=>{n.delete(e)}}registerTextContentListener(e){const n=this._listeners.textcontent;return n.add(e),()=>{n.delete(e)}}registerRootListener(e){const n=this._listeners.root;return e(this._rootElement,null),n.add(e),()=>{e(null,this._rootElement),n.delete(e)}}registerCommand(e,n,o){if(o===void 0)throw Error('Listener for type "command" requires a "priority".');const r=this._commands;r.has(e)||r.set(e,[new Set,new Set,new Set,new Set,new Set]);const s=r.get(e);if(s===void 0)throw Error(`registerCommand: Command ${e} not found in command map`);const i=s[o];return i.add(n),()=>{i.delete(n),s.every(l=>l.size===0)&&r.delete(e)}}registerMutationListener(e,n){if(this._nodes.get(e.getType())===void 0)throw Error(`Node ${e.name} has not been registered. Ensure node has been passed to createEditor.`);const r=this._listeners.mutation;return r.set(n,e),()=>{r.delete(n)}}registerNodeTransform(e,n){const o=e.getType(),r=this._nodes.get(o);if(r===void 0)throw Error(`Node ${e.name} has not been registered. Ensure node has been passed to createEditor.`);const s=r.transforms;return s.add(n),Bu(this,o),()=>{s.delete(n)}}hasNodes(e){for(let n=0;n<e.length;n++){const r=e[n].getType();if(!this._nodes.has(r))return!1}return!0}dispatchCommand(e,n){return P(this,e,n)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const n=this._rootElement;if(e!==n){const o=this._pendingEditorState||this._editorState;if(this._rootElement=e,Ta(this,n,e,o),n!==null&&(this._config.disableEvents||Dd(n)),e!==null){const r=e.style;r.userSelect="text",r.whiteSpace="pre-wrap",r.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._dirtyType=Bt,pa(this),this._updateTags.add("history-merge"),Ct(this),this._config.disableEvents||vd(e,this)}An("root",this,!1,e,n)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,n){if(e.isEmpty())throw Error("setEditorState: the editor state is empty. Ensure the editor state's root node never becomes empty.");ga(this);const o=this._pendingEditorState,r=this._updateTags,s=n!==void 0?n.tag:null;o!==null&&!o.isEmpty()&&(s!=null&&r.add(s),Ct(this)),this._pendingEditorState=e,this._dirtyType=Bt,this._compositionKey=null,s!=null&&r.add(s),Ct(this)}parseEditorState(e){const n=JSON.parse(e);return ua(n,this)}update(e,n){Re(this,e,n)}focus(e){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Re(this,()=>{const o=T(),r=se();o!==null?o.dirty=!0:r.getChildrenSize()!==0&&r.selectEnd()},{onUpdate:()=>{n.removeAttribute("autocapitalize"),e&&e()}}))}blur(){const e=this._rootElement;e!==null&&e.blur();const n=je();n!==null&&n.removeAllRanges()}isReadOnly(){return this._readOnly}setReadOnly(e){this._readOnly=e,An("readonly",this,!0,e)}toJSON(){return{editorState:this._editorState}}}class wa extends Oe{constructor(e,n){super(n)}}function kf(t){return t instanceof wa}class ba extends Oe{}function vf(t){return t instanceof ba}class Sa extends Oe{}function Df(t){return t instanceof Sa}const Qe=ht?y.exports.useLayoutEffect:y.exports.useEffect,m=zr.exports.jsx,v=zr.exports.jsxs,X=zr.exports.Fragment;function Lf({initialConfig:t,children:e}){const n=y.exports.useMemo(()=>{const{theme:o,namespace:r,editor__DEPRECATED:s,nodes:i,onError:l}=t,a=El(null,o);let c=s||null;if(c===null){const u=Un({namespace:r,nodes:i,onError:d=>l(d,u),readOnly:!0,theme:o});c=u}return[c,a]},[]);return Qe(()=>{const o=t.readOnly,[r]=n;r.setReadOnly(o||!1)},[]),m(No.Provider,{value:n,children:e})}const ka=y.exports.createContext({setOption:(t,e)=>{},settings:{}}),Of=({children:t})=>{const[e,n]=y.exports.useState(wn),o=y.exports.useCallback((s,i)=>{n(l=>j(z({},l),{[s]:i})),wn[s]===i?li(s,null):li(s,i)},[]),r=y.exports.useMemo(()=>({setOption:o,settings:e}),[o,e]);return m(ka.Provider,{value:r,children:t})},cs=()=>y.exports.useContext(ka);function li(t,e){const n=new URL(window.location.href),o=new URLSearchParams(n.search);e!==null?o.has(t)?o.set(t,String(e)):o.append(t,String(e)):o.has(t)&&o.delete(t),n.search=o.toString(),window.history.pushState(null,"",n.toString())}function Be(t,...e){e.forEach(n=>{n!=null&&typeof n=="string"&&t.classList.add(...n.split(" "))})}function us(t,...e){e.forEach(n=>{t.classList.remove(...n.split(" "))})}function Af(t,e){const n=[],o=(t||se()).getLatest(),r=e||(S(o)?o.getLastDescendant():o);let s=o,i=Pf(s);for(;s!==null&&!s.is(r);)if(n.push({depth:i,node:s}),S(s)&&s.getChildrenSize()>0)s=s.getFirstChild(),i++;else{let l=null;for(;l===null&&s!==null;)l=s.getNextSibling(),l===null?(s=s.getParent(),i--):s=l}return s!==null&&s.is(r)&&n.push({depth:i,node:s}),n}function Pf(t){let e=t,n=0;for(;(e=e.getParent())!==null;)n++;return n}function va(t,e){let n=t;for(;n!=null;){if(n instanceof e)return n;n=n.getParent()}return n}function pn(t){const e=fe(t,n=>S(n)&&!n.isInline());if(!S(e))throw Error(`Expected node ${t.__key} to have closest block element node.`);return e}function fe(t,e){let n=t;for(;n!==se()&&n!=null;){if(e(n))return n;n=n.getParent()}return null}function ue(...t){return()=>{t.forEach(e=>e())}}const ar=0,Lr=1,Or=2,We=0,Ff=1,ai=2,Mf=3,Rf=4;function If(t,e,n){const o=t._nodeMap,r=[];for(const s of e){const i=o.get(s);i!==void 0&&r.push(i)}for(const[s,i]of n){if(!i)continue;const l=o.get(s);l!==void 0&&!V(l)&&r.push(l)}return r}function Bf(t,e,n,o,r){if(t===null||n.size===0&&o.size===0)return We;const s=e._selection,i=t._selection;if(r)return Ff;if(!w(s)||!w(i)||!i.isCollapsed()||!s.isCollapsed())return We;const l=If(e,n,o);if(l.length===0)return We;if(l.length>1){const C=e._nodeMap,x=C.get(s.anchor.key),E=C.get(i.anchor.key);return x&&E&&!t._nodeMap.has(x.__key)&&b(x)&&x.__text.length===1&&s.anchor.offset===1?ai:We}const a=l[0],c=t._nodeMap.get(a.__key);if(!b(c)||!b(a)||c.__mode!==a.__mode)return We;const u=c.__text,d=a.__text;if(u===d)return We;const f=s.anchor,h=i.anchor;if(f.key!==h.key||f.type!=="text")return We;const g=f.offset,p=h.offset,_=d.length-u.length;return _===1&&p===g-1?ai:_===-1&&p===g+1?Mf:_===-1&&p===g?Rf:We}function Kf(t,e){let n=Date.now(),o=We;return(r,s,i,l,a,c)=>{const u=Date.now();if(c.has("historic"))return o=We,n=u,Or;const d=Bf(r,s,l,a,t.isComposing()),f=(()=>{const h=c.has("history-push");if(!h&&c.has("history-merge"))return ar;if(r===null)return Lr;const p=s._selection,_=r._selection;if(!(l.size>0||a.size>0))return _===null&&p!==null?ar:Or;const x=i===null||i.editor===t;return h===!1&&d!==We&&d===o&&u<n+e&&x?ar:Lr})();return n=u,o=d,f}}function $f(t,e){const n=e.redoStack,o=e.undoStack;if(n.length!==0){const r=e.current;r!==null&&(o.push(r),t.dispatchCommand(Uo,!0));const s=n.pop();n.length===0&&t.dispatchCommand(ns,!1),e.current=s,s.editor.setEditorState(s.editorState,{tag:"historic"})}}function Hf(t,e){const n=e.redoStack,o=e.undoStack;if(o.length!==0){const s=e.current,i=o.pop();s!==null&&(n.push(s),t.dispatchCommand(ns,!0)),o.length===0&&t.dispatchCommand(Uo,!1),e.current=i,i.editor.setEditorState(i.editorState.clone(i.undoSelection),{tag:"historic"})}}function ci(t){t.undoStack=[],t.redoStack=[],t.current=null}function zf(t,e,n){const o=Kf(t,n),r=({editorState:l,prevEditorState:a,dirtyLeaves:c,dirtyElements:u,tags:d})=>{const f=e.current,h=e.redoStack,g=e.undoStack,p=f===null?null:f.editorState;if(f!==null&&l===p)return;const _=o(a,l,f,c,u,d);if(_===Lr)h.length!==0&&(e.redoStack=[]),f!==null&&(g.push(j(z({},f),{undoSelection:a.read(T)})),t.dispatchCommand(Uo,!0));else if(_===Or)return;e.current={editor:t,editorState:l}},s=ue(t.registerCommand(Vt,()=>(Hf(t,e),!0),F),t.registerCommand(Xt,()=>($f(t,e),!0),F),t.registerCommand(Ql,()=>(ci(e),!1),F),t.registerCommand(xd,()=>(ci(e),!0),F),t.registerUpdateListener(r)),i=t.registerUpdateListener(r);return()=>{s(),i()}}function Da(){return{current:null,redoStack:[],undoStack:[]}}function Wf(t,e,n=1e3){const o=y.exports.useMemo(()=>e||Da(),[e]);y.exports.useEffect(()=>zf(t,o,n),[n,t,o])}function Oo({externalHistoryState:t}){const[e]=$();return Wf(e,t),null}const La=y.exports.createContext({historyState:{current:null,redoStack:[],undoStack:[]}}),Uf=({children:t})=>{const e=y.exports.useMemo(()=>({historyState:Da()}),[]);return m(La.Provider,{value:e,children:t})},ds=()=>y.exports.useContext(La);class Lt extends Oe{static getType(){return"link"}static clone(e){return new Lt(e.__url,e.__key)}constructor(e,n){super(n);this.__url=e}createDOM(e){const n=document.createElement("a");return n.href=this.__url,Be(n,e.theme.link),n}updateDOM(e,n,o){const r=n,s=this.__url;return s!==e.__url&&(r.href=s),!1}static importDOM(){return{a:e=>({conversion:jf,priority:1})}}getURL(){return this.getLatest().__url}setURL(e){const n=this.getWritable();n.__url=e}insertNewAfter(e){const n=this.getParentOrThrow().insertNewAfter(e);if(S(n)){const o=_t(this.__url);return n.append(o),o}return null}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}}function jf(t){let e=null;return t instanceof HTMLAnchorElement&&(e=_t(t.href)),{node:e}}function _t(t){return new Lt(t)}function Pe(t){return t instanceof Lt}class bt extends Lt{static getType(){return"autolink"}static clone(e){return new bt(e.__url,e.__key)}insertNewAfter(e){const n=this.getParentOrThrow().insertNewAfter(e);if(S(n)){const o=Oa(this.__url);return n.append(o),o}return null}}function Oa(t){return new bt(t)}function Ar(t){return t instanceof bt}const xt=I();function Pr(t){let e=1,n=t.getParent();for(;n!=null;){if(te(n)){const o=n.getParent();if(G(o)){e++,n=o.getParent();continue}throw Error("A ListItemNode must have a ListNode for a parent.")}return e}return e}function Fr(t){let e=t.getParent();if(!G(e))throw Error("A ListItemNode must have a ListNode for a parent.");let n=e;for(;n!==null;)n=n.getParent(),G(n)&&(e=n);return e}function Aa(t){let e=[];const n=t.getChildren().filter(te);for(let o=0;o<n.length;o++){const r=n[o],s=r.getFirstChild();G(s)?e=e.concat(Aa(s)):e.push(r)}return e}function Ft(t){return te(t)&&G(t.getFirstChild())}function Gf(t){let e=t;for(;e!==null;){if(te(e))return e;e=e.getParent()}return null}function Yf(t){const e=new Set;for(let n=0;n<t.length;n++){const o=t[n];te(o)&&e.add(o)}return Array.from(e)}function qf(t){let e=t;for(;e.getNextSibling()==null&&e.getPreviousSibling()==null;){const n=e.getParent();if(n==null||!(te(e)||G(e)))break;e=n}e.remove()}function Pa(t,e){return te(t)&&(e.length===0||e.length===1&&t.is(e[0])&&t.getChildrenSize()===0)}function ui(t,e){t.update(()=>{const n=T();if(w(n)){const o=n.getNodes(),s=n.anchor.getNode(),i=s.getParent();if(Pa(s,o)){const l=Ke(e);if(V(i)){s.replace(l);const a=Ce();l.append(a)}else if(te(s)){const a=s.getParentOrThrow();l.append(...a.getChildren()),a.replace(l)}return}else{const l=new Set;for(let a=0;a<o.length;a++){const c=o[a];if(S(c)&&c.isEmpty()&&!l.has(c.getKey())){di(c,e);continue}if(Rn(c)){let u=c.getParent();for(;u!=null;){const d=u.getKey();if(G(u)){if(!l.has(d)){const f=Ke(e);f.append(...u.getChildren()),u.replace(f),l.add(d)}break}else{const f=u.getParent();if(V(f)&&!l.has(d)){l.add(d),di(u,e);break}u=f}}}}}}})}function di(t,e){if(G(t))return t;const n=t.getPreviousSibling(),o=t.getNextSibling(),r=Ce();if(G(n)&&e===n.getTag())return r.append(t),n.append(r),G(o)&&e===o.getTag()&&(n.append(...o.getChildren()),o.remove()),n;if(G(o)&&e===o.getTag())return r.append(t),o.getFirstChildOrThrow().insertBefore(r),o;{const s=Ke(e);return s.append(r),t.replace(s),r.append(t),s}}function Vf(t){t.update(()=>{const e=T();if(w(e)){const n=new Set,o=e.getNodes(),r=e.anchor.getNode();if(Pa(r,o))n.add(Fr(r));else for(let s=0;s<o.length;s++){const i=o[s];if(Rn(i)){const l=va(i,Qt);l!=null&&n.add(Fr(l))}}n.forEach(s=>{let i=s;Aa(s).forEach(a=>{if(a!=null){const c=U();c.append(...a.getChildren()),i.insertAfter(c),i=c,a.remove()}}),s.remove()})}})}function Fa(t){const e=new Set;t.forEach(n=>{if(Ft(n)||e.has(n.getKey()))return;const o=n.getParent(),r=n.getNextSibling(),s=n.getPreviousSibling();if(Ft(r)&&Ft(s)){const i=s.getFirstChild();if(G(i)){i.append(n);const l=r.getFirstChild();if(G(l)){const a=l.getChildren();i.append(...a),r.remove(),e.add(r.getKey())}i.getChildren().forEach(a=>a.markDirty())}}else if(Ft(r)){const i=r.getFirstChild();if(G(i)){const l=i.getFirstChild();l!==null&&l.insertBefore(n),i.getChildren().forEach(a=>a.markDirty())}}else if(Ft(s)){const i=s.getFirstChild();G(i)&&(i.append(n),i.getChildren().forEach(l=>l.markDirty()))}else if(G(o)){const i=Ce(),l=Ke(o.getTag());i.append(l),l.append(n),s?s.insertAfter(i):r?r.insertBefore(i):o.append(i)}G(o)&&o.getChildren().forEach(i=>i.markDirty())})}function Ma(t){t.forEach(e=>{if(Ft(e))return;const n=e.getParent(),o=n?n.getParent():void 0,r=o?o.getParent():void 0;if(G(r)&&te(o)&&G(n)){const s=n?n.getFirstChild():void 0,i=n?n.getLastChild():void 0;if(e.is(s))o.insertBefore(e),n.isEmpty()&&o.remove();else if(e.is(i))o.insertAfter(e),n.isEmpty()&&o.remove();else{const l=n.getTag(),a=Ce(),c=Ke(l);a.append(c),e.getPreviousSiblings().forEach(f=>c.append(f));const u=Ce(),d=Ke(l);u.append(d),d.append(...e.getNextSiblings()),o.insertBefore(a),o.insertAfter(u),o.replace(e)}n.getChildren().forEach(l=>l.markDirty()),r.getChildren().forEach(l=>l.markDirty())}})}function Ra(t){const e=T();if(!w(e))return!1;const n=e.getNodes();let o=[];if(n.length===0&&n.push(e.anchor.getNode()),n.length===1){const r=Gf(n[0]);r!==null&&(o=[r])}else o=Yf(n);return o.length>0?(t==="indent"?Fa(o):Ma(o),!0):!1}function Xf(){return Ra("indent")}function Jf(){return Ra("outdent")}function Qf(){const t=T();if(!w(t)||!t.isCollapsed())return!1;const e=t.anchor.getNode();if(!te(e)||e.getTextContent()!=="")return!1;const n=Fr(e),o=e.getParent();if(!G(o))throw Error("A ListItemNode must have a ListNode for a parent.");const r=o.getParent();let s;if(V(r))s=U(),n.insertAfter(s);else if(te(r))s=Ce(),r.insertAfter(s);else return!1;s.select();const i=e.getNextSiblings();if(i.length>0){const l=Ke(o.getTag());if(Gt(s))s.insertAfter(l);else{const a=Ce();a.append(l),s.insertAfter(a)}i.forEach(a=>{a.remove(),l.append(a)})}return qf(e),!0}class Qt extends Oe{static getType(){return"listitem"}static clone(e){return new Qt(e.__key)}constructor(e){super(e)}createDOM(e){const n=document.createElement("li");return n.value=fi(this),hi(n,e.theme,this),n}updateDOM(e,n,o){return n.value=fi(this),hi(n,o.theme,this),!1}static importDOM(){return{li:e=>({conversion:Zf,priority:0})}}append(...e){for(let n=0;n<e.length;n++){const o=e[n];if(S(o)&&this.canMergeWith(o)){const r=o.getChildren();this.append(...r),o.remove()}else super.append(o)}return this}replace(e){if(te(e))return super.replace(e);const n=this.getParentOrThrow();if(G(n)){const o=n.__children,r=o.length,s=o.indexOf(this.__key);if(s===0)n.insertBefore(e);else if(s===r-1)n.insertAfter(e);else{const i=Ke(n.getTag()),l=n.getChildren();for(let a=s+1;a<r;a++){const c=l[a];i.append(c)}n.insertAfter(e),e.insertAfter(i)}this.remove(),r===1&&n.remove()}return e}insertAfter(e){const n=this.getNextSiblings();if(te(e))return n.forEach(r=>r.markDirty()),super.insertAfter(e);const o=this.getParentOrThrow();if(!G(o))throw Error("insertAfter: list node is not parent of list item node");if(G(e)&&e.getTag()===o.getTag()){let r=e;const s=e.getChildren();for(let i=s.length-1;i>=0;i--)r=s[i],this.insertAfter(r);return r}if(o.insertAfter(e),n.length!==0){const r=Ke(o.getTag());n.forEach(s=>r.append(s)),e.insertAfter(r)}return e}insertNewAfter(){const e=Ce();return this.insertAfter(e),e}collapseAtStart(e){const n=U();this.getChildren().forEach(l=>n.append(l));const r=this.getParentOrThrow(),s=r.getParentOrThrow(),i=te(s);if(r.getChildrenSize()===1)if(i)r.remove(),s.select();else{r.replace(n);const l=e.anchor,a=e.focus,c=n.getKey();l.type==="element"&&l.getNode().is(this)&&l.set(c,l.offset,"element"),a.type==="element"&&a.getNode().is(this)&&a.set(c,a.offset,"element")}else r.insertBefore(n),this.remove();return!0}getIndent(){let e=this.getParentOrThrow().getParentOrThrow(),n=0;for(;te(e);)e=e.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(e){let n=this.getIndent();for(;n!==e;)n<e?(Fa([this]),n++):(Ma([this]),n--);return this}insertBefore(e){const n=this.getNextSiblings();return te(e)&&n.forEach(o=>o.markDirty()),super.insertBefore(e)}canInsertAfter(e){return te(e)}canReplaceWith(e){return te(e)}canMergeWith(e){return Gt(e)||te(e)}}function fi(t){const e=t.getParent();let n=1;if(e!=null)if(G(e))n=e.getStart();else throw Error("getListItemValue: list node is not parent of list item node");const o=t.getPreviousSiblings();for(let r=0;r<o.length;r++){const s=o[r];te(s)&&!G(s.getFirstChild())&&n++}return n}function hi(t,e,n){const o=[],r=[],s=e.list,i=s?s.listitem:void 0;let l;if(s&&s.nested&&(l=s.nested.listitem),i!==void 0){const a=i.split(" ");o.push(...a)}if(l!==void 0){const a=l.split(" ");n.getChildren().some(c=>G(c))?o.push(...a):r.push(...a)}o.length>0&&Be(t,...o),r.length>0&&us(t,...r)}function Zf(t){return{node:Ce()}}function Ce(){return new Qt}function te(t){return t instanceof Qt}class Zt extends Oe{static getType(){return"list"}static clone(e){return new Zt(e.__tag,e.__start,e.__key)}constructor(e,n,o){super(o);this.__tag=e,this.__start=n}getTag(){return this.__tag}getStart(){return this.__start}createDOM(e){const n=this.__tag,o=document.createElement(n);return this.__start!==1&&o.setAttribute("start",String(this.__start)),gi(o,e.theme,this),o}updateDOM(e,n,o){return e.__tag!==this.__tag?!0:(gi(n,o.theme,this),!1)}static importDOM(){return{ol:e=>({conversion:pi,priority:0}),ul:e=>({conversion:pi,priority:0})}}canBeEmpty(){return!1}append(...e){for(let n=0;n<e.length;n++){const o=e[n];if(te(o))super.append(o);else{const r=Ce();if(G(o))r.append(o);else{const s=K(o.getTextContent());r.append(s)}super.append(r)}}return this}}function gi(t,e,n){const o=[],r=[],s=e.list;if(s!==void 0){const i=s[n.__tag+"Depth"]||[],l=Pr(n)-1,a=l%i.length,c=i[a],u=s[n.__tag];let d;const f=s.nested;if(f!==void 0&&f.list&&(d=f.list),u!==void 0&&o.push(u),c!==void 0){const h=c.split(" ");o.push(...h);for(let g=0;g<i.length;g++)g!==a&&r.push(n.__tag+g)}if(d!==void 0){const h=d.split(" ");l>1?o.push(...h):r.push(...h)}}o.length>0&&Be(t,...o),r.length>0&&us(t,...r)}function pi(t){const e=t.nodeName.toLowerCase();let n=null;return(e==="ol"||e==="ul")&&(n=Ke(e)),{node:n}}function Ke(t,e=1){return new Zt(t,e)}function G(t){return t instanceof Zt}const Ia=I(),Ba=I(),Mr=I();function eh(){const[t]=$();return y.exports.useEffect(()=>{t.focus()},[t]),null}function th({scrollRef:t}){const[e]=$();return Qe(()=>e.registerUpdateListener(({tags:n,editorState:o})=>{const r=t.current;if(r===null||!n.has("scroll-into-view"))return;const s=o.read(()=>T());if(!w(s)||!s.isCollapsed())return;const i=e.getElementByKey(s.anchor.key);if(i===null)return;const l=r.getBoundingClientRect(),a=i.getBoundingClientRect();a.bottom>l.bottom?i.scrollIntoView(!1):a.top<l.top&&i.scrollIntoView()}),[e,t]),null}class en extends Oe{static getType(){return"overflow"}static clone(e){return new en(e.__key)}constructor(e){super(e);this.__type="overflow"}createDOM(e){const n=document.createElement("span"),o=e.theme.characterLimit;return typeof o=="string"&&(n.className=o),n}updateDOM(e,n){return!1}insertNewAfter(e){return this.getParentOrThrow().insertNewAfter(e)}excludeFromCopy(){return!0}}function nh(){return new en}function Rr(t){return t instanceof en}function oh(t,e,n){let o="";const r=t.getChildren(),s=r.length;for(let i=0;i<s;++i){const l=r[i];if(b(l)){const a=l.getTextContent();if(l.is(n.node)){if(n.offset>a.length)throw Error(`Node ${l.__key} and selection point do not match.`);o+=l.getTextContent().substr(0,n.offset);break}else o+=a}else o+=e}return o}function mi(t,e,n,o){const r=o.getChildren(),s=r.length;let i=0,l=!1;for(let a=0;a<s&&!(i>e);++a){const c=r[a],u=b(c),d=u?c.getTextContent().length:n,f=i+d;if((l===!1&&i===t||i===0&&i===t||i<t&&t<=f)&&b(c))return{node:c,offset:t-i};i=f,l=u}return null}function rh(t,e=!0){if(t)return!1;let n=fs();return e&&(n=n.trim()),n===""}function fs(){return se().getTextContent()}function sh(t){if(!rh(t,!1))return!1;const n=se().getChildren(),o=n.length;if(o>1)return!1;for(let r=0;r<o;r++){const s=n[r];if(S(s)){if(s.__type!=="paragraph"||s.__indent!==0)return!1;const i=s.getChildren(),l=i.length;for(let a=0;a<l;a++){const c=i[r];if(!b(c))return!1}}}return!0}function _i(t){return()=>sh(t)}function ih(t,e,n,o){const r=d=>d instanceof n,s=d=>{const f=K(d.getTextContent());f.setFormat(d.getFormat()),d.replace(f)},i=d=>d.getLatest().__mode,l=d=>{if(!d.isSimpleText())return;const f=d.getPreviousSibling();let h=d.getTextContent(),g=d,p;if(b(f)){const _=f.getTextContent(),C=_+h,x=e(C);if(r(f))if(x===null||i(f)!==0){s(f);return}else{const E=x.end-_.length;if(E>0){const N=h.slice(0,E),k=_+N;if(f.select(),f.setTextContent(k),E===h.length)d.remove();else{const D=h.slice(E);d.setTextContent(D)}return}}else if(x===null||x.start<_.length)return}for(;;){p=e(h);let _=p===null?"":h.slice(p.end);if(h=_,_===""){const E=g.getNextSibling();if(b(E)){_=g.getTextContent()+E.getTextContent();const N=e(_);if(N===null){r(E)?s(E):E.markDirty();return}else if(N.start!==0)return}}else{const E=e(_);if(E!==null&&E.start===0)return}if(p===null)return;if(p.start===0&&b(f)&&f.isTextEntity())continue;let C;p.start===0?[C,g]=g.splitText(p.end):[,C,g]=g.splitText(p.start,p.end);const x=o(C);if(C.replace(x),g==null)return}},a=d=>{const f=d.getTextContent(),h=e(f);if(h===null||h.start!==0){s(d);return}if(f.length>h.end){d.splitText(h.end);return}const g=d.getPreviousSibling();b(g)&&g.isTextEntity()&&(s(g),s(d));const p=d.getNextSibling();b(p)&&p.isTextEntity()&&(s(p),r(d)&&s(d))},c=t.registerNodeTransform(Ne,l),u=t.registerNodeTransform(n,a);return[c,u]}function lh(t,e,n=Object.freeze({})){const{strlen:o=s=>s.length,remainingCharacters:r=s=>{}}=n;y.exports.useEffect(()=>{if(!t.hasNodes([en]))throw Error("useCharacterLimit: OverflowNode not registered on editor")},[t]),y.exports.useEffect(()=>{let s=t.getEditorState().read(fs),i=0;return ue(t.registerTextContentListener(l=>{s=l}),t.registerUpdateListener(({dirtyLeaves:l})=>{const a=t.isComposing(),c=l.size>0;if(a||!c)return;const u=o(s),d=u>e||i!==null&&i>e,f=e-u;if(r(f),i===null||d){const h=ah(s,e,o);t.update(()=>{ch(h)},{tag:"history-merge"})}i=u}))},[t,e,r,o])}function ah(t,e,n){const o=Intl.Segmenter;let r=0,s=0;if(typeof o=="function"){const l=new o().segment(t);for(const{segment:a}of l){const c=s+n(a);if(c>e)break;s=c,r+=a.length}}else{const i=Array.from(t),l=i.length;for(let a=0;a<l;a++){const c=i[a],u=s+n(c);if(u>e)break;s=u,r+=c.length}}return r}function ch(t){const e=Af(),n=e.length;let o=0;for(let r=0;r<n;r+=1){const{node:s}=e[r];if(Rr(s)){const i=o;if(o+s.getTextContentSize()<=t){const a=s.getParent(),c=s.getPreviousSibling(),u=s.getNextSibling();yi(s);const d=T();w(d)&&(!d.anchor.getNode().isAttached()||!d.focus.getNode().isAttached())&&(b(c)?c.select():b(u)?u.select():a!==null&&a.select())}else if(i<t){const a=s.getFirstDescendant(),c=a!==null?a.getTextContentSize():0,u=i+c,d=b(a)&&a.isSimpleText(),f=u<=t;(d||f)&&yi(s)}}else if(Rn(s)){const i=o;if(o+=s.getTextContentSize(),o>t&&!Rr(s.getParent())){const l=T();let a;if(i<t&&b(s)&&s.isSimpleText()){const[,c]=s.splitText(t-i);a=xi(c)}else a=xi(s);l!==null&&ie(l),uh(a)}}}}function xi(t){const e=nh();return t.insertBefore(e),e.append(t),e}function yi(t){const e=t.getChildren(),n=e.length;for(let o=0;o<n;o++)t.insertBefore(e[o]);return t.remove(),n>0?e[n-1]:null}function uh(t){const e=t.getPreviousSibling();if(!Rr(e))return;const n=t.getFirstChild(),o=e.getChildren(),r=o.length;if(n===null)t.append(...o);else for(let i=0;i<r;i++)n.insertBefore(o[i]);const s=T();if(w(s)){const i=s.anchor,l=i.getNode(),a=s.focus,c=i.getNode();l.is(e)?i.set(t.getKey(),i.offset,"element"):l.is(t)&&i.set(t.getKey(),r+i.offset,"element"),c.is(e)?a.set(t.getKey(),a.offset,"element"):c.is(t)&&a.set(t.getKey(),r+a.offset,"element")}e.remove()}const dh=5;let cr=null;function fh(){return window.TextEncoder===void 0?null:(cr===null&&(cr=new window.TextEncoder),cr)}function hh(t){const e=fh();if(e===null){const n=encodeURIComponent(t).match(/%[89ABab]/g);return t.length+(n?n.length:0)}return e.encode(t).length}function gh({charset:t="UTF-16"}){const[e]=$(),[n,o]=y.exports.useState(0),r=y.exports.useMemo(()=>({remainingCharacters:o,strlen:s=>{if(t==="UTF-8")return hh(s);if(t==="UTF-16")return s.length;throw new Error("Unrecognized charset")}}),[t]);return lh(e,dh,r),m("span",{className:`characters-limit ${n<0?"characters-limit-exceeded":""}`,children:n})}function ph({onClear:t}){const[e]=$();return Qe(()=>e.registerCommand(Ql,n=>(e.update(()=>{if(t==null){const o=se(),r=T(),s=U();o.clear(),o.append(s),r!==null&&s.select()}else t()}),!0),F),[e,t]),null}class mn{constructor(e,n){this._key="",this._map=e,this._parent=n,this._type="linebreak"}getNode(){const e=M(this._key);return ce(e)?e:null}getKey(){return this._key}getSharedType(){return this._map}getType(){return this._type}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}destroy(e){e.collabNodeMap.delete(this._key)}}function Ka(t,e){const n=new mn(t,e);return t._collabNode=n,n}function mh(t,e,n,o){const r=T();let s=o.length;if(w(r)&&r.isCollapsed()){const l=r.anchor;l.key===e&&(s=l.offset)}const i=Ca(n,o,s);t.spliceText(i.index,i.remove,i.insert)}class ve{constructor(e,n,o,r){this._key="",this._map=e,this._parent=o,this._text=n,this._type=r,this._normalized=!1}getPrevNode(e){if(e===null)return null;const n=e.get(this._key);return b(n)?n:null}getNode(){const e=M(this._key);return b(e)?e:null}getSharedType(){return this._map}getType(){return this._type}getKey(){return this._key}getSize(){return this._text.length+(this._normalized?0:1)}getOffset(){return this._parent.getChildOffset(this)}spliceText(e,n,o){const s=this._parent._xmlText,i=this.getOffset()+1+e;n!==0&&s.delete(i,n),o!==""&&s.insert(i,o)}syncPropertiesAndTextFromLexical(e,n,o){const r=this.getPrevNode(o),s=n.__text;if(ps(e,this._map,r,n),r!==null){const i=r.__text;if(i!==s){const l=n.__key;mh(this,l,i,s),this._text=s}}}syncPropertiesAndTextFromYjs(e,n){const o=this.getNode();if(o===null)throw new Error("Should never happen");gs(e,this._map,o,n);const r=this._text;if(o.__text!==r){const s=o.getWritable();s.__text=r}}destroy(e){e.collabNodeMap.delete(this._key)}}function $a(t,e,n,o){const r=new ve(t,e,n,o);return t._collabNode=r,r}const Ha=new Set(["__key","__children","__parent","__cachedText","__text"]);function io(t){const e=M(t);if(e===null)throw new Error("Should never happen");return e}function Ci(t,e,n){const o=e.__type;let r;if(S(e)){const s=new Wr;r=ms(s,n,o),r.syncPropertiesFromLexical(t,e,null),r.syncChildrenFromLexical(t,e,null,null,null)}else if(b(e)){const s=new Nt;r=$a(s,e.__text,n,o),r.syncPropertiesAndTextFromLexical(t,e,null)}else if(ce(e)){const s=new Nt;s.set("__type","linebreak"),r=Ka(s,n)}else if(re(e)){const s=new Cl;r=za(s,n,o),r.syncPropertiesFromLexical(t,e,null)}else throw new Error("Should never happen");return r._key=e.__key,r}function _h(t){const e=t instanceof Nt?t.get("__type"):t.getAttribute("__type");if(e==null)throw new Error("Should never happen");return e}function hs(t,e,n){const o=e._collabNode;if(o===void 0){const r=t.editor._nodes,s=_h(e);if(r.get(s)===void 0)throw new Error("Should never happen");const l=e.parent,a=n===void 0&&l!==null?hs(t,l):n||null;if(!(a instanceof Ue))throw new Error("Should never happen");if(e instanceof Wr)return ms(e,a,s);if(e instanceof Nt){if(a===null)throw new Error("Should never happen");return s==="linebreak"?Ka(e,a):$a(e,"",a,s)}else if(e instanceof Cl)return za(e,a,s)}return o}function xh(t,e,n){const o=e.getType(),s=t.editor._nodes.get(o);if(s===void 0)throw new Error("createLexicalNode failed");const i=new s.klass;if(i.__parent=n,e._key=i.__key,e instanceof Ue){const l=e._xmlText;e.syncPropertiesFromYjs(t,null),e.applyChildrenYjsDelta(t,l.toDelta()),e.syncChildrenFromYjs(t)}else e instanceof ve?e.syncPropertiesAndTextFromYjs(t,null):e instanceof st&&e.syncPropertiesFromYjs(t,null);return t.collabNodeMap.set(i.__key,e),i}function gs(t,e,n,o){const r=o===null?e instanceof Nt?Array.from(e.keys()):Object.keys(e.getAttributes()):Array.from(o);let s;for(let i=0;i<r.length;i++){const l=r[i];if(Ha.has(l))continue;const a=n[l];let c=e instanceof Nt?e.get(l):e.getAttribute(l);if(a!==c){if(c instanceof Eo){const u=t.docMap;a instanceof Eo&&u.delete(a.guid);const d=Un(),f=c.guid;d._key=f,u.set(f,c),c=d}s===void 0&&(s=n.getWritable()),s[l]=c}}}function ps(t,e,n,o){const r=o.__type,s=t.nodeProperties;let i=s.get(r);i===void 0&&(i=Object.keys(o).filter(a=>!Ha.has(a)),s.set(r,i));const l=t.editor.constructor;for(let a=0;a<i.length;a++){const c=i[a],u=n===null?void 0:n[c];let d=o[c];if(u!==d){if(d instanceof l){const f=t.docMap;let h;if(u instanceof l){const _=u._key;h=f.get(_),f.delete(_)}const g=h||new Eo,p=g.guid;d._key=p,f.set(p,g),d=g,t.editor.update(()=>{o.markDirty()})}e instanceof Nt?e.set(c,d):e.setAttribute(c,d)}}}function Ei(t,e,n,o){return t.slice(0,e)+o+t.slice(e+n)}function mo(t,e,n){let o=0,r=0;const s=t._children,i=s.length;for(;r<i;r++){const l=s[r],a=o;if(o+=l.getSize(),(n?o>=e:o>e)&&l instanceof ve){let d=e-a-1;return d<0&&(d=0),{length:o-e,node:l,nodeIndex:r,offset:d}}if(o>e)return{length:0,node:l,nodeIndex:r,offset:a};if(r===i-1)return{length:0,node:null,nodeIndex:r+1,offset:a+1}}return{length:0,node:null,nodeIndex:0,offset:0}}function Ni(t){const e=t.anchor,n=t.focus;let o=!1;try{const r=e.getNode(),s=n.getNode();(!r.isAttached()||!s.isAttached()||b(r)&&e.offset>r.getTextContentSize()||b(s)&&n.offset>s.getTextContentSize())&&(o=!0)}catch{o=!0}return o}function yh(t,e){t.doc.transact(e,t)}class st{constructor(e,n,o){this._key="",this._xmlElem=e,this._parent=n,this._type=o,this._unobservers=new Set}getPrevNode(e){if(e===null)return null;const n=e.get(this._key);return re(n)?n:null}getNode(){const e=M(this._key);return re(e)?e:null}getSharedType(){return this._xmlElem}getType(){return this._type}getKey(){return this._key}getSize(){return 1}getOffset(){return this._parent.getChildOffset(this)}syncPropertiesFromLexical(e,n,o){const r=this.getPrevNode(o),s=this._xmlElem;ps(e,s,r,n)}syncPropertiesFromYjs(e,n){const o=this.getNode();if(o===null)throw new Error("Should never happen");const r=this._xmlElem;gs(e,r,o,n)}destroy(e){e.collabNodeMap.delete(this._key),this._unobservers.forEach(o=>o()),this._unobservers.clear()}}function za(t,e,n){const o=new st(t,e,n);return t._collabNode=o,o}class Ue{constructor(e,n,o){this._key="",this._children=[],this._xmlText=e,this._type=o,this._parent=n}getPrevNode(e){if(e===null)return null;const n=e.get(this._key);return S(n)?n:null}getNode(){const e=M(this._key);return S(e)?e:null}getSharedType(){return this._xmlText}getType(){return this._type}getKey(){return this._key}isEmpty(){return this._children.length===0}getSize(){return 1}getOffset(){const e=this._parent;if(e===null)throw new Error("Should never happen");return e.getChildOffset(this)}syncPropertiesFromYjs(e,n){const o=this.getNode();if(o===null)throw this.getNode(),new Error("Should never happen");gs(e,this._xmlText,o,n)}applyChildrenYjsDelta(e,n){const o=this._children;let r=0;for(let s=0;s<n.length;s++){const i=n[s],l=i.insert,a=i.delete;if(i.retain!=null)r+=i.retain;else if(typeof a=="number"){let c=a;for(;c>0;){const{node:u,nodeIndex:d,offset:f,length:h}=mo(this,r,!1);if(u instanceof Ue||u instanceof mn||u instanceof st)o.splice(d,1),c-=1;else if(u instanceof ve){const g=Math.min(c,h),p=d!==0?o[d-1]:null,_=u.getSize();f===0&&g===1&&d>0&&p instanceof ve&&h===_&&Array.from(u._map.keys()).length===0?(p._text+=u._text,o.splice(d,1)):f===0&&g===_?o.splice(d,1):u._text=Ei(u._text,f,g,""),c-=g}else break}}else if(l!=null)if(typeof l=="string"){const{node:c,offset:u}=mo(this,r,!0);c instanceof ve?c._text=Ei(c._text,u,0,l):this._xmlText.delete(u,l.length),r+=l.length}else{const c=l,{nodeIndex:u}=mo(this,r,!1),d=hs(e,c,this);o.splice(u,0,d),r+=1}else throw new Error("Unexpected delta format")}}syncChildrenFromYjs(e){const n=this.getNode();if(n===null)throw this.getNode(),new Error("Should never happen");const o=n.__key,r=n.__children,s=[],i=r.length,l=this._children,a=l.length,c=e.collabNodeMap,u=new Set;let d,f;a!==i&&(f=Ti(n,f,s));let h=0;for(let g=0;g<a;g++){const p=r[h],_=l[g],C=_.getNode(),x=_._key;if(C!==null&&p===x){const E=b(C);if(u.add(p),E){if(_._key=p,_ instanceof Ue){const N=_._xmlText;_.syncPropertiesFromYjs(e,null),_.applyChildrenYjsDelta(e,N.toDelta()),_.syncChildrenFromYjs(e)}else if(_ instanceof ve)_.syncPropertiesAndTextFromYjs(e,null);else if(_ instanceof st)_.syncPropertiesFromYjs(e,null);else if(!(_ instanceof mn))throw new Error("Should never happen")}s[g]=p,h++}else{if(d===void 0){d=new Set;for(let k=0;k<a;k++){const A=l[k]._key;A!==""&&d.add(A)}}if(C!==null&&p!==void 0&&!d.has(p)){g--,h++;continue}f=Ti(n,f,s);const N=xh(e,_,o).__key;c.set(N,_),s[g]=N}}for(let g=0;g<i;g++){const p=r[g];if(!u.has(p)){const _=io(p).getWritable(),C=e.collabNodeMap.get(p);C!==void 0&&C.destroy(e),_.__parent=null}}}syncPropertiesFromLexical(e,n,o){ps(e,this._xmlText,this.getPrevNode(o),n)}_syncChildFromLexical(e,n,o,r,s,i){const l=this._children[n],a=io(o);l instanceof Ue&&S(a)?(l.syncPropertiesFromLexical(e,a,r),l.syncChildrenFromLexical(e,a,r,s,i)):l instanceof ve&&b(a)?l.syncPropertiesAndTextFromLexical(e,a,r):l instanceof st&&re(a)&&l.syncPropertiesFromLexical(e,a,r)}syncChildrenFromLexical(e,n,o,r,s){const i=this.getPrevNode(o),l=i===null?[]:i.__children,a=n.__children,c=l.length-1,u=a.length-1,d=e.collabNodeMap;let f,h,g=0,p=0;for(;g<=c&&p<=u;){const x=l[g],E=a[p];if(x===E)this._syncChildFromLexical(e,p,E,o,r,s),g++,p++;else{f===void 0&&(f=new Set(l)),h===void 0&&(h=new Set(a));const N=h.has(x),k=f.has(E);if(!N)this.splice(e,p,1),g++;else{const D=io(E),A=Ci(e,D,this);d.set(E,A),k?(this.splice(e,p,1,A),g++,p++):(this.splice(e,p,0,A),p++)}}}const _=g>c,C=p>u;if(_&&!C)for(;p<=u;++p){const x=a[p],E=io(x),N=Ci(e,E,this);this.append(N),d.set(x,N)}else if(C&&!_)for(let x=this._children.length-1;x>=p;x--)this.splice(e,x,1)}append(e){const n=this._xmlText,o=this._children,r=o[o.length-1],s=r!==void 0?r.getOffset()+r.getSize():0;if(e instanceof Ue)n.insertEmbed(s,e._xmlText);else if(e instanceof ve){const i=e._map;i.parent===null&&n.insertEmbed(s,i),n.insert(s+1,e._text)}else e instanceof mn?n.insertEmbed(s,e._map):e instanceof st&&n.insertEmbed(s,e._xmlElem);this._children.push(e)}splice(e,n,o,r){const s=this._children,i=s[n];if(i===void 0){if(r!==void 0)this.append(r);else throw new Error("Should never happen");return}const l=i.getOffset();if(l===-1)throw new Error("Should never happen");const a=this._xmlText;if(o!==0&&a.delete(l,i.getSize()),r instanceof Ue)a.insertEmbed(l,r._xmlText);else if(r instanceof ve){const c=r._map;c.parent===null&&a.insertEmbed(l,c),a.insert(l+1,r._text)}else r instanceof mn?a.insertEmbed(l,r._map):r instanceof st&&a.insertEmbed(l,r._xmlElem);if(o!==0){const c=s.slice(n,n+o);for(let u=0;u<c.length;u++)c[u].destroy(e)}r!==void 0?s.splice(n,o,r):s.splice(n,o)}getChildOffset(e){let n=0;const o=this._children;for(let r=0;r<o.length;r++){const s=o[r];if(s===e)return n;n+=s.getSize()}return-1}destroy(e){const n=e.collabNodeMap,o=this._children;for(let r=0;r<o.length;r++)o[r].destroy(e);n.delete(this._key)}}function Ti(t,e,n){if(e===void 0){const o=t.getWritable();return o.__children=n,o}return e}function ms(t,e,n){const o=new Ue(t,e,n);return t._collabNode=o,o}function Ch(t,e,n,o,r){if(o==null)throw new Error("Should never happen");const s=o.get("root",Wr),i=ms(s,null,"root");return i._key="root",{clientID:o.clientID,collabNodeMap:new Map,cursors:new Map,cursorsContainer:null,doc:o,docMap:r,editor:t,id:n,nodeProperties:new Map,root:i}}function wi(t,e){const o=e.collabNodeMap.get(t.key);if(o===void 0)return null;let r=t.offset,s=o.getSharedType();if(o instanceof ve){s=o._parent._xmlText;const i=o.getOffset();if(i===-1)return null;r=i+1+r}return hu(s,r)}function Ao(t,e){return fu(t,e.doc)}function bi(t,e){if(t==null){if(e!=null)return!0}else if(e==null||!gu(t,e))return!0;return!1}function Eh(t,e){return{color:e,name:t,selection:null}}function Wa(t,e){const n=t.cursorsContainer;if(n!==null){const o=e.selections,r=o.length;for(let s=0;s<r;s++)n.removeChild(o[s])}}function Nh(t,e){const n=e.selection;n!==null&&Wa(t,n)}function Si(t){let e=t;for(;e!=null;){if(e.nodeType===3)return e;e=e.firstChild}return null}function Th(t,e,n,o,r){const s=t.color,i=document.createElement("span");i.style.cssText=`position:absolute;top:0;bottom:0;right:-1px;width:1px;background-color:rgb(${s});z-index:10;`;const l=document.createElement("span");return l.textContent=t.name,l.style.cssText=`position:absolute;left:-2px;top:-16px;background-color:rgb(${s});color:#fff;line-height:12px;height:12px;font-size:12px;padding:2px;font-family:Arial;font-weight:bold;white-space:nowrap;`,i.appendChild(l),{anchor:{key:e,offset:n},caret:i,color:s,focus:{key:o,offset:r},name:l,range:document.createRange(),selections:[]}}function ki(t){const e=t.parentNode;if(e==null)throw new Error("Should never happen");return[e,Array.from(e.childNodes).indexOf(t)]}function wh(t,e,n,o){const r=t.editor,s=r.getRootElement(),i=t.cursorsContainer;if(i===null||s===null)return;const l=e.selection;if(n===null){if(l===null)return;e.selection=null,Wa(t,l);return}else e.selection=n;const a=n.range,c=n.caret,u=n.color,d=n.selections,f=n.anchor,h=n.focus,g=f.key,p=h.key,_=o.get(g),C=o.get(p);let x=r.getElementByKey(g),E=r.getElementByKey(p),N=f.offset,k=h.offset;if(b(_)&&(x=Si(x)),b(C)&&(E=Si(E)),_===void 0||C===void 0||x===null||E===null)return;x.nodeName==="BR"&&([x,N]=ki(x)),E.nodeName==="BR"&&([E,k]=ki(E));const D=x.firstChild;x===E&&D!=null&&D.nodeName==="BR"&&N===0&&k===0&&(k=1);try{a.setStart(x,N),a.setEnd(E,k)}catch{return}a.collapsed&&(N!==k||g!==p)&&(a.setStart(E,k),a.setEnd(x,N));const A=s.getBoundingClientRect(),L=getComputedStyle(s),R=parseFloat(L.paddingLeft)+parseFloat(L.paddingRight),B=Array.from(a.getClientRects());let H=B.length;const q=d.length;let ne;for(let Q=0;Q<H;Q++){const oe=B[Q],He=ne&&ne.top===oe.top&&ne.left===oe.left&&ne.width===oe.width&&ne.height===oe.height,de=oe.width+R===A.width;if(He||de){B.splice(Q--,1),H--;continue}ne=oe;let ee=d[Q];ee===void 0&&(ee=document.createElement("span"),d[Q]=ee,i.appendChild(ee));const At=`position:absolute;top:${oe.top}px;left:${oe.left}px;height:${oe.height}px;width:${oe.width}px;background-color:rgba(${u}, 0.3);pointer-events:none;z-index:10;`;ee.style.cssText=At,Q===H-1&&c.parentNode!==ee&&ee.appendChild(c)}for(let Q=q-1;Q>=H;Q--){const oe=d[Q];i.removeChild(oe),d.pop()}}function vi(t,e){const o=e.awareness.getLocalState();if(o===null)return;const r=o.anchorPos,s=o.focusPos;if(r!==null&&s!==null){const i=Ao(r,t),l=Ao(s,t);if(i!==null&&l!==null){const[a,c]=Po(i.type,i.index),[u,d]=Po(l.type,l.index);if(a!==null&&u!==null){const f=a.getKey(),h=u.getKey(),g=T();if(!w(g))return;const p=g.anchor,_=g.focus;if(p.key!==f||p.offset!==c){const C=M(f);g.anchor.set(f,c,S(C)?"element":"text")}if(_.key!==h||_.offset!==d){const C=M(h);g.focus.set(h,d,S(C)?"element":"text")}}}}}function Po(t,e){const n=t._collabNode;if(n===void 0)return[null,0];if(n instanceof Ue){const{node:o,offset:r}=mo(n,e,!0);return o===null?[n,0]:[o,r]}return[null,0]}function Ua(t,e){const n=Array.from(e.awareness.getStates()),o=t.clientID,r=t.cursors,i=t.editor._editorState._nodeMap,l=new Set;for(let c=0;c<n.length;c++){const u=n[c],[d,f]=u;if(d!==o){l.add(d);const{anchorPos:h,focusPos:g,name:p,color:_,focusing:C}=f;let x=null,E=r.get(d);if(E===void 0&&(E=Eh(p,_),r.set(d,E)),h!==null&&g!==null&&C){const N=Ao(h,t),k=Ao(g,t);if(N!==null&&k!==null){const[D,A]=Po(N.type,N.index),[L,R]=Po(k.type,k.index);if(D!==null&&L!==null){const B=D.getKey(),H=L.getKey();if(x=E.selection,x===null)x=Th(E,B,A,H,R);else{const q=x.anchor,ne=x.focus;q.key=B,q.offset=A,ne.key=H,ne.offset=R}}}}wh(t,E,x,i)}}const a=Array.from(r.keys());for(let c=0;c<a.length;c++){const u=a[c];if(!l.has(u)){const d=r.get(u);d!==void 0&&(Nh(t,d),r.delete(u))}}}function ja(t,e,n,o){const r=e.awareness,s=r.getLocalState();if(s===null)return;const{anchorPos:i,focusPos:l,name:a,color:c,focusing:u}=s;let d=null,f=null;(o===null||i!==null&&!o.is(n))&&n===null||(w(o)&&(d=wi(o.anchor,t),f=wi(o.focus,t)),(bi(i,d)||bi(l,f))&&r.setLocalState({anchorPos:d,color:c,focusPos:f,focusing:u,name:a}))}class bh{constructor(e,n,o=1){this._offsetMap=e,this._firstNode=n,this._blockOffsetSize=o}createSelectionFromOffsets(e,n,o){const r=this._firstNode;if(r===null)return null;let s=e,i=n,l=_n(r,s,this._blockOffsetSize),a=_n(r,i,this._blockOffsetSize);if(o!==void 0&&(s=Di(s,l,o,this,this._blockOffsetSize),l=_n(r,s,this._blockOffsetSize),i=Di(i,a,o,this,this._blockOffsetSize),a=_n(r,i,this._blockOffsetSize)),l===null||a===null)return null;let c=l.key,u=a.key;const d=M(c),f=M(u);if(d===null||f===null)return null;let h=0,g=0,p="element",_="element";if(l.type==="text"){h=s-l.start,p="text";const x=d.getNextSibling();s!==i&&h===d.getTextContentSize()&&b(x)&&(h=0,c=x.__key)}else l.type==="inline"&&(c=d.getParentOrThrow().getKey(),h=i>l.start?l.end:l.start);a.type==="text"?(g=i-a.start,_="text"):a.type==="inline"&&(u=f.getParentOrThrow().getKey(),g=i>a.start?a.end:a.start);const C=Pn();return C===null?null:(C.anchor.set(c,h,p),C.focus.set(u,g,_),C)}getOffsetsFromSelection(e){const n=e.anchor,o=e.focus,r=this._offsetMap,s=n.offset,i=o.offset;let l=-1,a=-1;if(n.type==="text"){const c=r.get(n.key);c!==void 0&&(l=c.start+s)}else{const c=n.getNode().getDescendantByIndex(s),u=r.get(c.getKey());u!==void 0&&(l=c.getIndexWithinParent()!==s?u.end:u.start)}if(o.type==="text"){const c=r.get(o.key);c!==void 0&&(a=c.start+o.offset)}else{const c=o.getNode().getDescendantByIndex(i),u=r.get(c.getKey());u!==void 0&&(a=c.getIndexWithinParent()!==i?u.end:u.start)}return[l,a]}}function Di(t,e,n,o,r){const s=n._offsetMap,i=o._offsetMap,l=new Set;let a=t,c=e;for(;c!==null;){const d=c.key,f=s.get(d),h=c.end-c.start;if(l.add(d),f===void 0)a+=h;else{const _=f.end-f.start;_!==h&&(a+=h-_)}const g=c.prev;if(g!==null){c=g;continue}let p=c.parent;for(;p!==null;){let _=p.prev;if(_!==null){const C=_.key,x=s.get(C),E=_.end-_.start;if(l.add(C),x===void 0)a+=E;else{const N=x.end-x.start;N!==E&&(a+=E-N)}_=_.prev}p=p.parent}break}const u=n._firstNode;if(u!==null){c=_n(u,t,r);let d=!1;for(;c!==null;){if(!l.has(c.key)){d=!0;break}c=c.parent}if(!d)for(;c!==null;){const f=c.key;if(!l.has(f)){const h=i.get(f),g=c.end-c.start;if(h===void 0)a-=g;else{const p=h.end-h.start;g!==p&&(a+=p-g)}}c=c.prev}}return a}function _n(t,e,n){let o=t;for(;o!==null;){const r=o.end+(o.type!=="element"||n===0?1:0);if(e<r){const i=o.child;if(i!==null){o=i;continue}return o}const s=o.next;if(s===null)break;o=s}return null}function Li(t,e,n,o,r,s){return{child:t,end:o,key:r,next:null,parent:s,prev:null,start:n,type:e}}function Sh(t,e,n,o,r,s){const i=o.get(e);if(i===void 0)throw Error("createOffsetModel: could not find node by key");const l=t.offset;if(S(i)){const f=i.__children,h=f.length===0,g=h?null:Ga(t,f,null,o,r,s);(!t.prevIsBlock||h)&&(t.prevIsBlock=!0,t.offset+=s);const p=Li(g,"element",l,l,e,n);g!==null&&(g.parent=p);const _=t.offset;return p.end=_,r.set(e,p),p}t.prevIsBlock=!1;const a=b(i),c=a?i.__text.length:1,u=t.offset+=c,d=Li(null,a?"text":"inline",l,u,e,n);return r.set(e,d),d}function Ga(t,e,n,o,r,s){let i=null,l=null;const a=e.length;for(let c=0;c<a;c++){const u=e[c],d=Sh(t,u,n,o,r,s);l===null?i=d:(d.prev=l,l.next=d),l=d}return i}function Oi(t,e=1,n){const r=(n||t._pendingEditorState||t._editorState)._nodeMap,s=r.get("root"),i=new Map,a=Ga({offset:0,prevIsBlock:!1},s.__children,null,r,i,e);return new bh(i,a,e)}function kh(t,e){const{target:n}=e,o=hs(t,n);if(o instanceof Ue&&e instanceof pu){const{keysChanged:r,childListChanged:s,delta:i}=e;r.size>0&&o.syncPropertiesFromYjs(t,r),s&&(o.applyChildrenYjsDelta(t,i),o.syncChildrenFromYjs(t))}else if(o instanceof ve&&e instanceof mu){const{keysChanged:r}=e;r.size>0&&o.syncPropertiesAndTextFromYjs(t,r)}else if(o instanceof st&&e instanceof _u){const{attributesChanged:r}=e;r.size>0&&o.syncPropertiesFromYjs(t,r)}else throw new Error("Should never happen")}function vh(t,e,n){const o=t.editor,r=o._editorState;o.update(()=>{const s=o._pendingEditorState;for(let l=0;l<n.length;l++){const a=n[l];kh(t,a)}const i=T();if(w(i))if(Ni(i)){const l=r._selection;if(w(l)){const a=Oi(o,0,r),c=Oi(o,0,s),[u,d]=a.getOffsetsFromSelection(l),f=c.createSelectionFromOffsets(u,d,a);if(f!==null)ie(f);else if(vi(t,e),Ni(i)){const h=se();h.getChildrenSize()===0&&h.append(U()),se().selectEnd()}}ja(t,e,l,T())}else vi(t,e)},{onUpdate:()=>{Ua(t,e)},skipTransforms:!0,tag:"collaboration"})}function Dh(t,e){const n=Array.from(e),o=t.collabNodeMap,r=[];for(let s=0;s<n.length;s++){const i=n[s],l=M(i),a=o.get(i);if(a instanceof ve)if(b(l))r.push([a,l.__text]);else{const c=a.getOffset();if(c===-1)continue;const u=a._parent;a._normalized=!0,u._xmlText.delete(c,1),o.delete(i);const d=u._children,f=d.indexOf(a);d.splice(f,1)}}for(let s=0;s<r.length;s++){const[i,l]=r[s];i._text=l}}function Lh(t,e,n,o,r,s,i,l){yh(t,()=>{o.read(()=>{if(l.has("collaboration")){i.size>0&&Dh(t,i);return}if(r.has("root")){const u=n._nodeMap,d=se(),f=t.root;f.syncPropertiesFromLexical(t,d,u),f.syncChildrenFromLexical(t,d,u,r,s)}const a=T(),c=n._selection;ja(t,e,c,a)})})}const Oh=I(),Ah=I();function Ph(t,e){return new xu(e,{trackedOrigins:new Set([t,null])})}function Fh(t,e,n,o){t.awareness.setLocalState({anchorPos:null,color:n,focusPos:null,focusing:o,name:e})}function Ai(t,e,n,o){const{awareness:r}=t;let s=r.getLocalState();s===null&&(s={anchorPos:null,color:n,focusPos:null,focusing:o,name:e}),s.focusing=o,r.setLocalState(s)}function Mh(t,e,n,o,r,s,i){const l=y.exports.useRef(!1),[a,c]=y.exports.useState(o.get(e)),u=y.exports.useMemo(()=>Ch(t,n,e,a,o),[t,n,e,o,a]),d=y.exports.useCallback(()=>{n.connect()},[n]),f=y.exports.useCallback(()=>{try{n.disconnect()}catch{}},[n]);y.exports.useEffect(()=>{const{root:g}=u,{awareness:p}=n,_=({status:D})=>{t.dispatchCommand(Oh,D==="connected")},C=D=>{i&&D&&g.isEmpty()&&g._xmlText._length===0&&l.current===!1&&Bh(t),l.current=!1},x=()=>{Ua(u,n)},E=(D,A)=>{A.origin!==u&&vh(u,n,D)};Fh(n,r,s,document.activeElement===t.getRootElement());const N=D=>{Kh(t,u),c(D),o.set(e,D),l.current=!0};n.on("reload",N),n.on("status",_),n.on("sync",C),p.on("update",x),g.getSharedType().observeDeep(E);const k=t.registerUpdateListener(({prevEditorState:D,editorState:A,dirtyLeaves:L,dirtyElements:R,normalizedNodes:B,tags:H})=>{H.has("skip-collab")===!1&&Lh(u,n,D,A,R,L,B,H)});return d(),()=>{l.current===!1&&f(),n.off("sync",C),n.off("status",_),n.off("reload",N),p.off("update",x),g.getSharedType().unobserveDeep(E),k()}},[u,s,d,f,o,t,e,r,n,i]);const h=y.exports.useMemo(()=>{const g=p=>{u.cursorsContainer=p};return Ie.exports.createPortal(m("div",{ref:g}),document.body)},[u]);return y.exports.useEffect(()=>t.registerCommand(Ah,g=>(d!==void 0&&f!==void 0&&(g?(console.log("Collaboration connected!"),d()):(console.log("Collaboration disconnected!"),f())),!0),F),[d,f,t]),[h,u]}function Rh(t,e,n,o){y.exports.useEffect(()=>ue(t.registerCommand(os,r=>(Ai(e,n,o,!0),!0),F),t.registerCommand(Zl,r=>(Ai(e,n,o,!1),!0),F)),[o,t,n,e])}function Ih(t,e){const n=y.exports.useMemo(()=>Ph(e,e.root.getSharedType()),[e]);return y.exports.useEffect(()=>{const r=()=>{n.undo()},s=()=>{n.redo()};return ue(t.registerCommand(Vt,()=>(r(),!0),F),t.registerCommand(Xt,()=>(s(),!0),F))}),y.exports.useCallback(()=>{n.clear()},[n])}function Bh(t){t.update(()=>{const e=se();if(e.getFirstChild()===null){const o=U();e.append(o);const r=document.activeElement;(T()!==null||r!==null&&r===t.getRootElement())&&o.select()}},{tag:"history-merge"})}function Kh(t,e){if(t.update(()=>{const r=se();r.clear(),r.select()},{tag:"skip-collab"}),e.cursors==null)return;const n=e.cursorsContainer;if(n==null)return;const o=Array.from(e.cursors.values());for(let r=0;r<o.length;r++){const i=o[r].selection;if(i&&i.selections!=null){const l=i.selections;for(let a=0;a<l.length;a++)n.removeChild(l[r])}}}const Pi=[["Cat","255,165,0"],["Dog","0,200,55"],["Rabbit","160,0,200"],["Frog","0,172,200"],["Fox","197,200,0"],["Hedgehog","31,200,0"],["Pigeon","200,0,0"],["Squirrel","200,0,148"],["Bear","255,235,0"],["Tiger","86,255,0"],["Leopard","0,255,208"],["Zebra","0,243,255"],["Wolf","0,102,255"],["Owl","147,0,255"],["Gull","255,0,153"],["Squid","0,220,255"]],Fi=Pi[Math.floor(Math.random()*Pi.length)];function _s({id:t,providerFactory:e,shouldBootstrap:n,username:o}){const r=jn(o),{yjsDocMap:s,name:i,color:l}=r,[a]=$(),c=y.exports.useMemo(()=>e(t,s),[t,e,s]),[u,d]=Mh(a,t,c,s,i,l,n);return r.clientID=d.clientID,Ih(a,d),Rh(a,c,i,l),u}const $h=y.exports.createContext({clientID:0,color:Fi[1],name:Fi[0],yjsDocMap:new Map});function jn(t){const e=y.exports.useContext($h);return t!=null&&(e.name=t),e}class Yt extends Ne{static getType(){return"hashtag"}static clone(e){return new Yt(e.__text,e.__key)}constructor(e,n){super(e,n)}createDOM(e){const n=super.createDOM(e);return Be(n,e.theme.hashtag),n}canInsertTextBefore(){return!1}isTextEntity(){return!0}}function Hh(t=""){return new Yt(t)}function Ya(t,e,n){const[o]=$();y.exports.useEffect(()=>ue(...ih(o,t,e,n)),[n,o,t,e])}function zh(){const t="\xC0-\xD6\xD8-\xF6\xF8-\xFF\u0100-\u024F\u0253-\u0254\u0256-\u0257\u0259\u025B\u0263\u0268\u026F\u0272\u0289\u028B\u02BB\u0300-\u036F\u1E00-\u1EFF",e="\u0400-\u04FF\u0500-\u0527\u2DE0-\u2DFF\uA640-\uA69F\u0591-\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u05D0-\u05EA\u05F0-\u05F4\uFB12-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFB4F\u0610-\u061A\u0620-\u065F\u066E-\u06D3\u06D5-\u06DC\u06DE-\u06E8\u06EA-\u06EF\u06FA-\u06FC\u06FF\u0750-\u077F\u08A0\u08A2-\u08AC\u08E4-\u08FE\uFB50-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\u200C-\u200C\u0E01-\u0E3A\u0E40-\u0E4E\u1100-\u11FF\u3130-\u3185\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\uFFA1-\uFFDC",n=String.fromCharCode,o="\u30A1-\u30FA\u30FC-\u30FE\uFF66-\uFF9F\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\u3041-\u3096\u3099-\u309E\u3400-\u4DBF\u4E00-\u9FFF"+n(173824)+"-"+n(177983)+n(177984)+"-"+n(178207)+n(194560)+"-"+n(195103)+"\u3003\u3005\u303B",r=t+e+o,s="A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u0241\u0250-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EE\u037A\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03CE\u03D0-\u03F5\u03F7-\u0481\u048A-\u04CE\u04D0-\u04F9\u0500-\u050F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0621-\u063A\u0640-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u076D\u0780-\u07A5\u07B1\u0904-\u0939\u093D\u0950\u0958-\u0961\u097D\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D28\u0D2A-\u0D39\u0D60-\u0D61\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDD\u0F00\u0F40-\u0F47\u0F49-\u0F6A\u0F88-\u0F8B\u1000-\u1021\u1023-\u1027\u1029-\u102A\u1050-\u1055\u10A0-\u10C5\u10D0-\u10FA\u10FC\u1100-\u1159\u115F-\u11A2\u11A8-\u11F9\u1200-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u1676\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19A9\u19C1-\u19C7\u1A00-\u1A16\u1D00-\u1DBF\u1E00-\u1E9B\u1EA0-\u1EF9\u1F00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u2094\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2131\u2133-\u2139\u213C-\u213F\u2145-\u2149\u2C00-\u2C2E\u2C30-\u2C5E\u2C80-\u2CE4\u2D00-\u2D25\u2D30-\u2D65\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3006\u3031-\u3035\u303B-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312C\u3131-\u318E\u31A0-\u31B7\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FBB\uA000-\uA48C\uA800-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uAC00-\uD7A3\uF900-\uFA2D\uFA30-\uFA6A\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",i="\u0300-\u036F\u0483-\u0486\u0591-\u05B9\u05BB-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u0615\u064B-\u065E\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u0901-\u0903\u093C\u093E-\u094D\u0951-\u0954\u0962-\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7-\u09C8\u09CB-\u09CD\u09D7\u09E2-\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A70-\u0A71\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2-\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B43\u0B47-\u0B48\u0B4B-\u0B4D\u0B56-\u0B57\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C01-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C82-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5-\u0CD6\u0D02-\u0D03\u0D3E-\u0D43\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D82-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2-\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F3E-\u0F3F\u0F71-\u0F84\u0F86-\u0F87\u0F90-\u0F97\u0F99-\u0FBC\u0FC6\u102C-\u1032\u1036-\u1039\u1056-\u1059\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B6-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u192B\u1930-\u193B\u19B0-\u19C0\u19C8-\u19C9\u1A17-\u1A1B\u1DC0-\u1DC3\u20D0-\u20DC\u20E1\u20E5-\u20EB\u302A-\u302F\u3099-\u309A\uA802\uA806\uA80B\uA823-\uA827\uFB1E\uFE00-\uFE0F\uFE20-\uFE23",l="0-9\u0660-\u0669\u06F0-\u06F9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\uFF10-\uFF19",a=s+i+r,c=l+"_",u=a+c;return{alpha:a,alphanumeric:u,hashChars:"#\\uFF03"}}function Wh(){const{alpha:t,alphanumeric:e,hashChars:n}=zh(),o="["+t+"]",r="["+e+"]",s="^|$|[^&/"+e+"]",i="["+n+"]";return"("+s+")("+i+")("+r+"*"+o+r+"*)"}const Uh=new RegExp(Wh(),"i");function qa(){const[t]=$();y.exports.useEffect(()=>{if(!t.hasNodes([Yt]))throw new Error("HashtagPlugin: HashtagNode not registered on editor")},[t]);const e=y.exports.useCallback(o=>Hh(o.getTextContent()),[]),n=y.exports.useCallback(o=>{const r=Uh.exec(o);if(r===null)return null;const s=r[3].length+1,i=r.index+r[1].length;return{end:i+s,start:i}},[]);return Ya(n,Yt,e),null}function jh(t){const e=T();e!==null&&ie(e);const n=T();if(n!==null){const o=n.extract();if(t===null)o.forEach(r=>{const s=r.getParent();if(Pe(s)){const i=s.getChildren();for(let l=0;l<i.length;l++)s.insertBefore(i[l]);s.remove()}});else{if(o.length===1){const i=o[0];if(Pe(i)){i.setURL(t);return}else{const l=i.getParent();if(Pe(l)){l.setURL(t);return}}}let r=null,s=null;o.forEach(i=>{const l=i.getParent();if(!(l===s||l===null||S(i)&&!i.isInline())){if(Pe(l)){s=l,l.setURL(t);return}if(l.is(r)||(r=l,s=_t(t),Pe(l)?i.getPreviousSibling()===null?l.insertBefore(s):l.insertAfter(s):i.insertBefore(s)),Pe(i)){if(s!==null){const a=i.getChildren();for(let c=0;c<a.length;c++)s.append(a[c])}i.remove();return}s!==null&&s.append(i)}})}}}function Va(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([Lt]))throw new Error("LinkPlugin: LinkNode not registered on editor")},[t]),y.exports.useEffect(()=>t.registerCommand(xt,e=>(jh(e),!0),F),[t]),null}function Gh(t){y.exports.useEffect(()=>ue(t.registerCommand(ut,()=>!!Xf(),J),t.registerCommand(yt,()=>!!Jf(),J),t.registerCommand(Ba,()=>(ui(t,"ol"),!0),J),t.registerCommand(Ia,()=>(ui(t,"ul"),!0),J),t.registerCommand(Mr,()=>(Vf(t),!0),J),t.registerCommand(Ht,()=>!!Qf(),J)),[t])}function Yh(){const[t]=$();return Gh(t),null}const Mi="javascript",Ri=t=>t!=null&&uo.languages.hasOwnProperty(t)?t:void 0;class St extends Ne{constructor(e,n,o){super(e,o);this.__highlightType=n}static getType(){return"code-highlight"}static clone(e){return new St(e.__text,e.__highlightType||void 0,e.__key)}createDOM(e){const n=super.createDOM(e),o=ur(e.theme,this.__highlightType);return Be(n,o),n}updateDOM(e,n,o){const r=super.updateDOM(e,n,o),s=ur(o.theme,e.__highlightType),i=ur(o.theme,this.__highlightType);return s!==i&&(s&&us(n,s),i&&Be(n,i)),r}setFormat(e){return this}}function ur(t,e){return e&&t&&t.codeHighlight&&t.codeHighlight[e]}function En(t,e){return new St(t,e)}function Ve(t){return t instanceof St}const dr="data-highlight-language";class ct extends Oe{static getType(){return"code"}static clone(e){return new ct(e.__language,e.__key)}constructor(e,n){super(n);this.__language=Ri(e)}createDOM(e){const n=document.createElement("code");Be(n,e.theme.code),n.setAttribute("spellcheck","false");const o=this.getLanguage();return o&&n.setAttribute(dr,o),n}updateDOM(e,n){const o=this.__language,r=e.__language;return o?o!==r&&n.setAttribute(dr,o):r&&n.removeAttribute(dr),!1}static importDOM(){return{div:e=>({conversion:Vh,priority:1}),pre:e=>({conversion:qh,priority:0}),table:e=>fr(e)?{conversion:Xh,priority:4}:null,td:e=>{const n=e,o=n.closest("table");return Zh(n)?{conversion:Jh,priority:4}:o&&fr(o)?{conversion:Bi,priority:4}:null},tr:e=>{const o=e.closest("table");return o&&fr(o)?{conversion:Bi,priority:4}:null}}}insertNewAfter(e){const n=this.getChildren(),o=n.length;if(o>=2&&n[o-1].getTextContent()===`
`&&n[o-2].getTextContent()===`
`&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===o){n[o-1].remove(),n[o-2].remove();const i=U();return this.insertAfter(i),i}const r=e.anchor.getNode(),s=Fo(r);if(s!=null){let i=0;const l=s.getTextContent();for(;i<l.length&&/[\t ]/.test(l[i]);)i+=1;if(i>0){const a=l.substring(0,i),c=En(a);return r.insertAfter(c),e.insertNodes([dt()]),c.select(),c}}return null}canInsertTab(){return!0}collapseAtStart(){const e=U();return this.getChildren().forEach(o=>e.append(o)),this.replace(e),!0}setLanguage(e){const n=this.getWritable();n.__language=Ri(e)}getLanguage(){return this.getLatest().__language}}function ot(t){return new ct(t)}function Fn(t){return t instanceof ct}function Fo(t){let e=null;const n=t.getPreviousSiblings();for(n.push(t);n.length>0;){const o=n.pop();if(Ve(o)&&(e=o),ce(o))break}return e}function Ii(t){let e=null;const n=t.getNextSiblings();for(n.unshift(t);n.length>0;){const o=n.shift();if(Ve(o)&&(e=o),ce(o))break}return e}function qh(t){return{node:ot()}}function Vh(t){return{after:n=>{const o=t.parentNode;return o!=null&&t!==o.lastChild&&n.push(dt()),n},node:Qh(t)?ot():null}}function Xh(){return{node:ot()}}function Bi(){return{node:null}}function Jh(t){const e=t;return{after:n=>(e.parentNode&&e.parentNode.nextSibling&&n.push(dt()),n),node:null}}function Qh(t){return t.style.fontFamily.match("monospace")!==null}function Zh(t){return t.classList.contains("js-file-line")}function fr(t){return t.classList.contains("js-file-line-container")}function Ki(t,e){const n=t.getParent();Fn(n)?Xa(n,e):Ve(t)&&t.replace(K(t.__text))}function eg(t,e){const n=e.getElementByKey(t.getKey());if(n===null)return;const o=t.getChildren(),r=o.length;if(r===n.__cachedChildrenLength)return;n.__cachedChildrenLength=r;let s="1",i=1;for(let l=0;l<r;l++)ce(o[l])&&(s+=`
`+ ++i);n.setAttribute("data-gutter",s)}let hr=!1;function Xa(t,e){hr||(hr=!0,t.getLanguage()===void 0&&t.setLanguage(Mi),e.update(()=>{tg(t,()=>{const n=t.getTextContent(),o=uo.tokenize(n,uo.languages[t.getLanguage()||""]||uo.languages[Mi]),r=Ja(o),s=ng(t.getChildren(),r),{from:i,to:l,nodesForReplacement:a}=s;return i!==l||a.length?(t.splice(i,l-i,a),!0):!1})},{onUpdate:()=>{hr=!1},skipTransforms:!0}))}function Ja(t){const e=[];return t.forEach(n=>{if(typeof n=="string"){const o=n.split(`
`);for(let r=0;r<o.length;r++){const s=o[r];s.length&&e.push(En(s)),r<o.length-1&&e.push(dt())}}else{const{content:o}=n;typeof o=="string"?e.push(En(o,n.type)):o.length===1&&typeof o[0]=="string"?e.push(En(o[0],n.type)):e.push(...Ja(o))}}),e}function tg(t,e){const n=T();if(!w(n)||!n.anchor)return;const o=n.anchor,r=o.offset,s=o.type==="element"&&ce(t.getChildAtIndex(o.offset-1));let i=0;if(!s){const a=o.getNode();i=r+a.getPreviousSiblings().reduce((c,u)=>c+(ce(u)?0:u.getTextContentSize()),0)}if(!!e()){if(s){o.getNode().select(r,r);return}t.getChildren().some(a=>{if(b(a)){const c=a.getTextContentSize();if(c>=i)return a.select(i,i),!0;i-=c}return!1})}}function ng(t,e){let n=0;for(;n<t.length&&$i(t[n],e[n]);)n++;const o=t.length,r=e.length,s=Math.min(o,r)-n;let i=0;for(;i<s;)if(i++,!$i(t[o-i],e[r-i])){i--;break}const l=n,a=o-i,c=e.slice(n,r-i);return{from:l,nodesForReplacement:c,to:a}}function $i(t,e){return Ve(t)&&Ve(e)?t.__text===e.__text&&t.__highlightType===e.__highlightType:!!(ce(t)&&ce(e))}function Hi(t){const e=T();if(!w(e)||e.isCollapsed())return!1;const n=e.getNodes();for(let r=0;r<n.length;r++){const s=n[r];if(!Ve(s)&&!ce(s))return!1}const o=Fo(n[0]);o!=null&&zi(o,t);for(let r=1;r<n.length;r++){const s=n[r];ce(n[r-1])&&Ve(s)&&zi(s,t)}return!0}function zi(t,e){const n=t.getTextContent();if(e===ut)if(n.length>0&&/\s/.test(n[0]))t.setTextContent("	"+n);else{const o=En("	");t.insertBefore(o)}else n.indexOf("	")===0&&(n.length===1?t.remove():t.setTextContent(n.substring(1)))}function Wi(t,e){const n=T();if(!w(n))return!1;const{anchor:o,focus:r}=n,s=o.offset,i=r.offset,l=o.getNode(),a=r.getNode(),c=t===wt;if(!Ve(l)||!Ve(a))return!1;if(!e.altKey){if(n.isCollapsed()){const C=l.getParentOrThrow();if(c&&s===0&&l.getPreviousSibling()===null){if(C.getPreviousSibling()===null)return C.selectPrevious(),e.preventDefault(),!0}else if(!c&&s===l.getTextContentSize()&&l.getNextSibling()===null&&C.getNextSibling()===null)return C.selectNext(),e.preventDefault(),!0}return!1}const u=Fo(l),d=Ii(a);if(u==null||d==null)return!1;const f=u.getNodesBetween(d);for(let C=0;C<f.length;C++){const x=f[C];if(!Ve(x)&&!ce(x))return!1}e.preventDefault(),e.stopPropagation();const h=c?u.getPreviousSibling():d.getNextSibling();if(!ce(h))return!0;const g=c?h.getPreviousSibling():h.getNextSibling();if(g==null)return!0;const p=c?Fo(g):Ii(g);let _=p!=null?p:g;return h.remove(),f.forEach(C=>C.remove()),t===wt?(f.forEach(C=>_.insertBefore(C)),_.insertBefore(h)):(_.insertAfter(h),_=h,f.forEach(C=>{_.insertAfter(C),_=C})),n.setTextNodeRange(l,s,a,i),!0}function og(t){if(!t.hasNodes([ct,St]))throw new Error("CodeHighlightPlugin: CodeNode or CodeHighlightNode not registered on editor");return ue(t.registerMutationListener(ct,e=>{t.update(()=>{for(const[n,o]of e)if(o!=="destroyed"){const r=M(n);r!==null&&eg(r,t)}})}),t.registerNodeTransform(ct,e=>Xa(e,t)),t.registerNodeTransform(Ne,e=>Ki(e,t)),t.registerNodeTransform(St,e=>Ki(e,t)),t.registerCommand(ut,e=>Hi(ut),J),t.registerCommand(yt,e=>Hi(yt),J),t.registerCommand(wt,e=>Wi(wt,e),J),t.registerCommand(kn,e=>Wi(kn,e),J))}const Qa=new Map;function Ir(t){const e=t.getLatest(),o=e.constructor.clone(e);if(o.__parent=e.__parent,S(e)&&S(o))o.__children=Array.from(e.__children),o.__format=e.__format,o.__indent=e.__indent,o.__dir=e.__dir;else if(b(e)&&b(o)){const r=e.__marks;o.__format=e.__format,o.__style=e.__style,o.__mode=e.__mode,o.__detail=e.__detail,o.__marks=r===null?null:Array.from(r)}return o}function rg(t,e,n){const o=n.get(e.getKey());return S(o)?o.__children.indexOf(t.getKey()):t.getIndexWithinParent()}function sg(t){let e=t.getParent();for(;e!==null&&e.excludeFromCopy();)e=e.getParent();return e}function Ui(t,e,n,o,r,s){let i=t,l=e;for(;i!==null;){const a=sg(i);if(a===null)break;if(!S(i)||!i.excludeFromCopy()){const c=i.getKey();let u=s.get(c);const d=u===void 0;if(d&&(u=Ir(i),s.set(c,u)),b(u)&&!u.isSegmented()&&!u.isToken()?u.__text=u.__text.slice(o?l:0,o?n:l):S(u)&&(u.__children=u.__children.slice(o?l:0,o?void 0:(l||0)+1)),V(a)){d&&r.push(c);break}}l=rg(i,a,s),i=a}}function ji(){throw Error("getLatest() on clone node")}function Za(t){const e=ig(t);{const n=e.nodeMap;for(let o=0;o<n.length;o++){const r=n[o][1];r.getLatest!==ji&&Object.setPrototypeOf(r,Object.create(Object.getPrototypeOf(r),{getLatest:{configurable:!0,enumerable:!0,value:ji,writable:!0}}))}}return e}function ig(t){if(w(t)){const e=t.anchor,n=t.focus,[o,r]=t.getCharacterOffsets(),s=t.getNodes();if(s.length===0)return{nodeMap:[],range:[]};let i=s.length;const l=s[0],a=l.getParent();if(a!==null&&(!a.canBeEmpty()||V(a))){const g=a.__children;if(g.length===i){let _=!0;for(let C=0;C<g.length;C++)if(g[C]!==s[C].__key){_=!1;break}_&&(i++,s.push(a))}}const c=s[i-1],u=e.isBefore(n),d=new Map,f=[],h=b(l)&&i===1;Ui(l,u?o:r,h?u?r:o:void 0,!0,f,d);for(let g=0;g<i;g++){const p=s[g],_=p.getKey();if(!d.has(_)&&(!S(p)||!p.excludeFromCopy())){const C=Ir(p);V(p.getParent())&&f.push(p.getKey()),_!=="root"&&d.set(_,C)}}return Ui(c,h?void 0:u?r:o,void 0,!1,f,d),{nodeMap:Array.from(d.entries()),range:f}}else if(Z(t))return{nodeMap:t.getNodes().map(n=>{const o=n.getKey(),r=Ir(n);return[o,r]}),range:[t.gridKey]};throw Error("TODO")}function ec(t){return Qa.get(t)||null}function lg(t){let e="";for(const n in t)n&&(e+=`${n}: ${t[n]};`);return e}function fn(t,e){const n=ec(t.getStyle()),o=n?z(z({},n),e):e,r=lg(o);t.setStyle(r),Qa.set(r,o)}function ag(t,e){const n=t.getNodes(),r=n.length-1;let s=n[0],i=n[r];if(t.isCollapsed())return;const l=t.anchor,a=t.focus,u=s.getTextContent().length,d=a.offset;let f=l.offset,h,g;const p=l.isBefore(a);if(h=p?f:d,g=p?d:f,h===s.getTextContentSize()){const _=s.getNextSibling();b(_)&&(f=0,h=0,s=_)}if(s.is(i)){if(b(s)){if(h=f>d?d:f,g=f>d?f:d,h===g)return;if(h===0&&g===u)fn(s,e),s.select(h,g);else{const _=s.splitText(h,g),C=h===0?_[0]:_[1];fn(C,e),C.select(0,g-h)}}}else{if(b(s)&&(h!==0&&([,s]=s.splitText(h),h=0),fn(s,e)),b(i)){const C=i.getTextContent().length;g!==C&&([i]=i.splitText(g)),g!==0&&fn(i,e)}for(let _=1;_<r;_++){const C=n[_],x=C.getKey();b(C)&&x!==s.getKey()&&x!==i.getKey()&&!C.isToken()&&fn(C,e)}}}function Gi(t,e,n=""){let o=null;const r=t.getNodes(),s=t.anchor,i=t.focus,l=t.isBackward(),a=l?i.offset:s.offset,c=l?i.getNode():s.getNode();for(let u=0;u<r.length;u++){const d=r[u];if(!(u!==0&&a===0&&d.is(c))&&b(d)){const f=cg(d,e,n);if(o===null)o=f;else if(o!==f){o="";break}}}return o===null?n:o}function cg(t,e,n){const o=t.getStyle(),r=ec(o);return r!==null&&r[e]||n}function ug(t,e,n,o){t.modify(e?"extend":"move",n,o)}function tc(t){const e=t.anchor.getNode();return(V(e)?e:e.getParentOrThrow()).getDirection()==="rtl"}function Mo(t,e,n){const o=tc(t);ug(t,e,n?!o:o,"character")}function dg(t){let e=t;for(;e!==null&&!V(e);){const n=e.getLatest(),o=e.getParent();n.__children.length===0&&e.remove(!0),e=o}}function tt(t,e,n){const o=t.getNodes(),r=o.length,s=t.anchor;if(r===0||r===1&&s.type==="element"&&s.getNode().getChildrenSize()===0){const h=s.type==="text"?s.getNode().getParentOrThrow():s.getNode(),g=h.getChildren();let p=e();g.forEach(_=>p.append(_)),n&&(p=n.append(p)),h.replace(p);return}const i=o[0],l=new Map,a=[];let c=S(i)?i:i.getParentOrThrow();for(c.isInline()&&(c=c.getParentOrThrow());c!==null;){const h=c.getPreviousSibling();if(h!==null){c=h;break}if(c=c.getParentOrThrow(),V(c))break}const u=new Set;for(let h=0;h<r;h++){const g=o[h];S(g)&&g.getChildrenSize()===0&&u.add(g.getKey())}const d=new Set;for(let h=0;h<r;h++){const g=o[h];let p=g.getParent();if(p!==null&&p.isInline()&&(p=p.getParent()),p!==null&&Rn(g)&&!d.has(g.getKey())){const _=p.getKey();if(l.get(_)===void 0){const C=e();a.push(C),l.set(_,C),p.getChildren().forEach(x=>{C.append(x),d.add(x.getKey())}),dg(p)}}else u.has(g.getKey())&&(a.push(e()),g.remove())}if(n)for(let h=0;h<a.length;h++){const g=a[h];n.append(g)}if(V(c)){const h=c.getFirstChild();if(S(h)&&(c=h),h===null)if(n)c.append(n);else for(let g=0;g<a.length;g++){const p=a[g];c.append(p)}else if(n)h.insertBefore(n);else for(let g=0;g<a.length;g++){const p=a[g];h.insertBefore(p)}}else if(n)c.insertAfter(n);else for(let h=a.length-1;h>=0;h--){const g=a[h];c.insertAfter(g)}const f=Vo();if(w(f)&&Yi(f.anchor)&&Yi(f.focus)){const h=f.clone();h.dirty=!0,ie(h)}else t.dirty=!0}function Yi(t){return t.getNode().isAttached()}function qi(t){return t.type==="text"?t.offset===t.getNode().getTextContentSize():t.offset===t.getNode().getChildrenSize()}function Ro(t,e){const n=ql(t.focus,e);return re(n)&&!n.isIsolated()}const nc=new Set(["STYLE"]);function oc(t){const e=T();if(e==null)throw new Error("Expected valid LexicalSelection");if(w(e)&&e.isCollapsed()||e.getNodes().length===0)return null;const n=Za(e);return fg(t,e,n)}function rc(t,e,n){let o=n;if(w(e)||Z(e)){const l=e.anchor.getNode(),a=e.focus.getNode(),c=n.is(l),u=n.is(a);if(b(n)&&(c||u)){const[d,f]=e.getCharacterOffsets(),h=e.isBackward(),g=l.is(a),p=n.is(h?a:l),_=n.is(h?l:a);if(g){const C=d>f?f:d,x=d>f?d:f,E=n.splitText(C,x);o=C===0?E[0]:E[1]}else if(p){const C=h?f:d,x=n.splitText(C);o=C===0?x[0]:x[1]}else if(_){const C=h?d:f;o=n.splitText(C)[0]}}}const{element:r,after:s}=o.exportDOM(t);if(!r)return null;const i=S(o)?o.getChildren():[];for(let l=0;l<i.length;l++){const a=i[l];if(a.isSelected()){const c=rc(t,e,a);c&&r.append(c)}}return s?s.call(o,r):r}function fg(t,e,n){const o=document.createElement("div");for(let r=0;r<n.range.length;r++){const s=n.range[r],i=M(s);if(i){const l=rc(t,e,i);if(l)if(i.isSelected())o.append(l);else{let a=l.firstChild;for(;a!=null;){const c=a.nextSibling;o.append(a),a=c}}}}return o.innerHTML}function hg(t){const e=T();if(e!==null){const n=t._config.namespace,o=Za(e);return JSON.stringify({namespace:n,state:o})}return null}function xs(t,e){const n=t.getData("text/plain");n!=null&&e.insertRawText(n)}function sc(t,e,n){const o=t.getData("application/x-lexical-editor");if(o){const i=n._config.namespace;try{const l=JSON.parse(o);if(l.namespace===i){const a=l.state,c=gg(a);e.insertNodes(c);return}}catch{}}const r="text/html",s=t.getData(r);if(s){const l=new DOMParser().parseFromString(s,r),a=mg(l,n),c=[];let u=null;for(let d=0;d<a.length;d++){const f=a[d];!S(f)||f.isInline()?(u===null&&(u=U(),c.push(u)),u!==null&&u.append(f)):(c.push(f),u=null)}e.insertNodes(c);return}xs(t,e)}function gg(t){const{range:e,nodeMap:n}=t,o=new Map(n),r=[];for(let s=0;s<e.length;s++){const i=e[s],l=o.get(i);if(l!==void 0){const a=_d(l,o);r.push(a)}}return r}function pg(t,e){const{nodeName:n}=t,o=e._htmlConversions.get(n.toLowerCase());let r=null;return o!==void 0&&o.forEach(s=>{const i=s(t);i!==null&&(r===null||r.priority<i.priority)&&(r=i)}),r!==null?r.conversion:null}function ic(t,e,n=new Map,o){let r=[];if(nc.has(t.nodeName))return r;let s=null;const i=pg(t,e),l=i?i(t):null;let a=null;if(l!==null){if(a=l.after,s=l.node,s!==null){for(const[,d]of n)if(s=d(s,o),!s)break;s&&r.push(s)}l.forChild!=null&&n.set(t.nodeName,l.forChild)}const c=t.childNodes;let u=[];for(let d=0;d<c.length;d++)u.push(...ic(c[d],e,n,s));return a!=null&&(u=a(u)),s==null?r=r.concat(u):S(s)&&s.append(...u),r}function mg(t,e){let n=[];const o=t.body?Array.from(t.body.childNodes):[],r=o.length;for(let s=0;s<r;s++){const i=o[s];if(!nc.has(i.nodeName)){const l=ic(i,e);l!==null&&(n=n.concat(l))}}return n}const lc={tag:"history-merge"},Vi=lc,Xi=lc;class Gn extends Oe{static getType(){return"quote"}static clone(e){return new Gn(e.__key)}constructor(e){super(e)}createDOM(e){const n=document.createElement("blockquote");return Be(n,e.theme.quote),n}updateDOM(e,n){return!1}insertNewAfter(){const e=U(),n=this.getDirection();return e.setDirection(n),this.insertAfter(e),e}collapseAtStart(){const e=U();return this.getChildren().forEach(o=>e.append(o)),this.replace(e),!0}}function Jo(){return new Gn}function _g(t){return t instanceof Gn}class Yn extends Oe{static getType(){return"heading"}static clone(e){return new Yn(e.__tag,e.__key)}constructor(e,n){super(n);this.__tag=e}getTag(){return this.__tag}createDOM(e){const n=this.__tag,o=document.createElement(n),s=e.theme.heading;if(s!==void 0){const i=s[n];Be(o,i)}return o}updateDOM(e,n){return!1}static importDOM(){return{h1:e=>({conversion:hn,priority:0}),h2:e=>({conversion:hn,priority:0}),h3:e=>({conversion:hn,priority:0}),h4:e=>({conversion:hn,priority:0}),h5:e=>({conversion:hn,priority:0})}}insertNewAfter(){const e=U(),n=this.getDirection();return e.setDirection(n),this.insertAfter(e),e}collapseAtStart(){const e=U();return this.getChildren().forEach(o=>e.append(o)),this.replace(e),!0}}function hn(t){const e=t.nodeName.toLowerCase();let n=null;return(e==="h1"||e==="h2"||e==="h3"||e==="h4"||e==="h5")&&(n=Ge(e)),{node:n}}function Ge(t){return new Yn(t)}function ac(t){return t instanceof Yn}function xg(t,e){if(e!==null){if(e===void 0)t.update(()=>{const n=se();if(n.getFirstChild()===null){const r=U();n.append(r);const s=document.activeElement;(T()!==null||s!==null&&s===t.getRootElement())&&r.select()}},Xi);else if(e!==null)switch(typeof e){case"string":{const n=t.parseEditorState(e);t.setEditorState(n,Vi);break}case"object":{t.setEditorState(e,Vi);break}case"function":{t.update(e,Xi);break}}}}function yg(t,e){t.preventDefault(),e.update(()=>{const n=T(),o=t.clipboardData;o!=null&&w(n)&&sc(o,n,e)})}function cc(t,e){t.preventDefault(),e.update(()=>{const n=t.clipboardData,o=T();if(o!==null&&n!=null){const r=oc(e),s=hg(e);r!==null&&n.setData("text/html",r),s!==null&&n.setData("application/x-lexical-editor",s),n.setData("text/plain",o.getTextContent())}})}function Cg(t,e){cc(t,e),e.update(()=>{const n=T();w(n)&&n.removeText()})}function Eg(t,e){const n=ue(t.registerCommand(In,o=>{const r=T();return Le(r)?(r.clear(),!0):!1},0),t.registerCommand(Fe,o=>{const r=T();return w(r)?(r.deleteCharacter(o),!0):!1},F),t.registerCommand(zt,o=>{const r=T();if(!w(r))return!1;const s=o;return r.deleteWord(s),!0},F),t.registerCommand(Wt,o=>{const r=T();if(!w(r))return!1;const s=o;return r.deleteLine(s),!0},F),t.registerCommand(qe,o=>{const r=T();if(!w(r))return!1;const s=o;if(typeof s=="string")r.insertText(s);else{const i=s.dataTransfer;if(i!=null)sc(i,r,t);else{const l=s.data;return l&&r.insertText(l),!0}}return!0},F),t.registerCommand(bo,o=>{const r=T();return w(r)?(r.removeText(),!0):!1},F),t.registerCommand(he,o=>{const r=T();if(!w(r))return!1;const s=o;return r.formatText(s),!0},F),t.registerCommand(Mt,o=>{const r=T();if(!w(r)&&!Le(r))return!1;const s=r.getNodes();for(const i of s)pn(i).setFormat(o);return!0},F),t.registerCommand(at,o=>{const r=T();if(!w(r))return!1;const s=o;return r.insertLineBreak(s),!0},F),t.registerCommand(Ht,o=>{const r=T();return w(r)?(r.insertParagraph(),!0):!1},F),t.registerCommand(ut,o=>{const r=T();if(!w(r))return!1;const s=r.anchor,i=pn(s.getNode());return i.canInsertTab()?t.dispatchCommand(qe,"	"):i.getIndent()!==10&&i.setIndent(i.getIndent()+1),!0},F),t.registerCommand(yt,o=>{const r=T();if(!w(r))return!1;const s=r.anchor,i=s.getNode(),l=pn(s.getNode());return l.canInsertTab()?i.getTextContent()[s.offset-1]==="	"&&t.dispatchCommand(Fe,!0):l.getIndent()!==0&&l.setIndent(l.getIndent()-1),!0},F),t.registerCommand(Ho,o=>{const r=T();if(!w(r))return!1;const s=o,i=s.shiftKey;return Ro(r,!0)?(s.preventDefault(),Mo(r,i,!0),!0):!1},F),t.registerCommand($o,o=>{const r=T();if(!w(r))return!1;const s=o,i=s.shiftKey;return Ro(r,!1)?(s.preventDefault(),Mo(r,i,!1),!0):!1},F),t.registerCommand(vt,o=>{const r=T();if(!w(r))return!1;o.preventDefault();const{anchor:i}=r;return r.isCollapsed()&&i.offset===0&&pn(i.getNode()).getIndent()>0?t.dispatchCommand(yt):t.dispatchCommand(Fe,!0)},F),t.registerCommand(Jt,o=>{const r=T();return w(r)?(o.preventDefault(),t.dispatchCommand(Fe,!1)):!1},F),t.registerCommand(Ut,o=>{const r=T();if(!w(r))return!1;if(o!==null){if((Yr||Gr)&&jr)return!1;if(o.preventDefault(),o.shiftKey)return t.dispatchCommand(at)}return t.dispatchCommand(Ht)},F),t.registerCommand(Wo,o=>{const r=T();if(!w(r))return!1;const s=o;return s.preventDefault(),t.dispatchCommand(s.shiftKey?yt:ut)},F),t.registerCommand(zo,o=>{const r=T();return w(r)?(t.blur(),!0):!1},F),t.registerCommand(Qr,o=>{const r=T();return w(r)?(o.preventDefault(),!0):!1},F),t.registerCommand(Zr,o=>{const r=T();return w(r)?(o.preventDefault(),!0):!1},F),t.registerCommand(es,o=>{const r=T();return w(r)||Z(r)?(cc(o,t),!0):!1},F),t.registerCommand(ts,o=>{const r=T();return w(r)||Z(r)?(Cg(o,t),!0):!1},F),t.registerCommand(Ko,o=>{const r=T();return w(r)||Z(r)?(yg(o,t),!0):!1},F));return xg(t,e),n}const uc="",Ji=uc.length,Ng={triggerKind:"space_trigger",triggerString:" "},dc=[Ng],Ae={markdownFormatKind:null,regEx:/(?:)/,regExForAutoFormatting:/(?:)/,requiresParagraphStart:!1},$e=j(z({},Ae),{requiresParagraphStart:!0}),Tg=j(z({},$e),{export:Xn(1),markdownFormatKind:"paragraphH1",regEx:/^(?:# )/,regExForAutoFormatting:/^(?:# )/}),wg=j(z({},$e),{export:Xn(2),markdownFormatKind:"paragraphH2",regEx:/^(?:## )/,regExForAutoFormatting:/^(?:## )/}),bg=j(z({},$e),{export:Xn(3),markdownFormatKind:"paragraphH3",regEx:/^(?:### )/,regExForAutoFormatting:/^(?:### )/}),Sg=j(z({},$e),{export:Xn(4),markdownFormatKind:"paragraphH4",regEx:/^(?:#### )/,regExForAutoFormatting:/^(?:#### )/}),kg=j(z({},$e),{export:Xn(5),markdownFormatKind:"paragraphH5",regEx:/^(?:##### )/,regExForAutoFormatting:/^(?:##### )/}),vg=j(z({},$e),{export:gp,markdownFormatKind:"paragraphBlockQuote",regEx:/^(?:> )/,regExForAutoFormatting:/^(?:> )/}),Dg=j(z({},$e),{export:ys,markdownFormatKind:"paragraphUnorderedList",regEx:/^(\s{0,10})(?:- )/,regExForAutoFormatting:/^(\s{0,10})(?:- )/}),Lg=j(z({},$e),{export:ys,markdownFormatKind:"paragraphUnorderedList",regEx:/^(\s{0,10})(?:\* )/,regExForAutoFormatting:/^(\s{0,10})(?:\* )/}),Og=j(z({},$e),{export:pp,markdownFormatKind:"paragraphCodeBlock",regEx:/^(```)$/,regExForAutoFormatting:/^(```)([a-z]*)( )/}),Ag=j(z({},$e),{export:ys,markdownFormatKind:"paragraphOrderedList",regEx:/^(\s{0,10})(\d+)\.\s/,regExForAutoFormatting:/^(\s{0,10})(\d+)\.\s/}),Pg=j(z({},$e),{markdownFormatKind:"horizontalRule",regEx:/^(?:\*\*\*)$/,regExForAutoFormatting:/^(?:\*\*\* )/}),Fg=j(z({},$e),{markdownFormatKind:"horizontalRule",regEx:/^(?:---)$/,regExForAutoFormatting:/^(?:--- )/}),Mg=j(z({},Ae),{exportFormat:"code",exportTag:"`",markdownFormatKind:"code",regEx:/(`)(\s*)([^`]*)(\s*)(`)()/,regExForAutoFormatting:/(`)(\s*\b)([^`]*)(\b\s*)(`)(\s)$/}),Rg=j(z({},Ae),{exportFormat:"bold",exportTag:"**",markdownFormatKind:"bold",regEx:/(\*\*)(\s*)([^\*\*]*)(\s*)(\*\*)()/,regExForAutoFormatting:/(\*\*)(\s*\b)([^\*\*]*)(\b\s*)(\*\*)(\s)$/}),Ig=j(z({},Ae),{exportFormat:"italic",exportTag:"*",markdownFormatKind:"italic",regEx:/(\*)(\s*)([^\*]*)(\s*)(\*)()/,regExForAutoFormatting:/(\*)(\s*\b)([^\*]*)(\b\s*)(\*)(\s)$/}),Bg=j(z({},Ae),{exportFormat:"bold",exportTag:"_",markdownFormatKind:"bold",regEx:/(__)(\s*)([^__]*)(\s*)(__)()/,regExForAutoFormatting:/(__)(\s*)([^__]*)(\s*)(__)(\s)$/}),Kg=j(z({},Ae),{exportFormat:"italic",exportTag:"_",markdownFormatKind:"italic",regEx:/(_)()([^_]*)()(_)()/,regExForAutoFormatting:/(_)()([^_]*)()(_)(\s)$/}),$g=j(z({},Ae),{exportFormat:"underline",exportTag:"<u>",exportTagClose:"</u>",markdownFormatKind:"underline",regEx:/(\<u\>)(\s*)([^\<]*)(\s*)(\<\/u\>)()/,regExForAutoFormatting:/(\<u\>)(\s*\b)([^\<]*)(\b\s*)(\<\/u\>)(\s)$/}),Hg=j(z({},Ae),{exportFormat:"strikethrough",exportTag:"~~",markdownFormatKind:"strikethrough",regEx:/(~~)(\s*)([^~~]*)(\s*)(~~)()/,regExForAutoFormatting:/(~~)(\s*\b)([^~~]*)(\b\s*)(~~)(\s)$/}),zg=j(z({},Ae),{markdownFormatKind:"strikethrough_italic_bold",regEx:/(~~_\*\*)(\s*\b)([^~~_\*\*][^\*\*_~~]*)(\b\s*)(\*\*_~~)()/,regExForAutoFormatting:/(~~_\*\*)(\s*\b)([^~~_\*\*][^\*\*_~~]*)(\b\s*)(\*\*_~~)(\s)$/}),Wg=j(z({},Ae),{markdownFormatKind:"italic_bold",regEx:/(_\*\*)(\s*\b)([^_\*\*][^\*\*_]*)(\b\s*)(\*\*_)/,regExForAutoFormatting:/(_\*\*)(\s*\b)([^_\*\*][^\*\*_]*)(\b\s*)(\*\*_)(\s)$/}),Ug=j(z({},Ae),{markdownFormatKind:"strikethrough_italic",regEx:/(~~_)(\s*)([^~~_][^_~~]*)(\s*)(_~~)/,regExForAutoFormatting:/(~~_)(\s*)([^~~_][^_~~]*)(\s*)(_~~)(\s)$/}),jg=j(z({},Ae),{markdownFormatKind:"strikethrough_bold",regEx:/(~~\*\*)(\s*\b)([^~~\*\*][^\*\*~~]*)(\b\s*)(\*\*~~)/,regExForAutoFormatting:/(~~\*\*)(\s*\b)([^~~\*\*][^\*\*~~]*)(\b\s*)(\*\*~~)(\s)$/}),Gg=j(z({},Ae),{markdownFormatKind:"link",regEx:/(\[)([^\]]*)(\]\()([^)]*)(\)*)()/,regExForAutoFormatting:/(\[)([^\]]*)(\]\()([^)]*)(\)*)(\s)$/}),fc=[zg,Wg,Ug,jg,Mg,Rg,Ig,Bg,Kg,$g,Hg,Gg],Yg=[Tg,wg,bg,Sg,kg,vg,Dg,Lg,Ag,Og,Pg,Fg],qg=[...Yg,...fc];function Vg(){return dc}function Xg(){return fc}function Jg(){return qg}function Qg(t,e,n,o){return{currentElementNode:null,editor:t,isAutoFormatting:e,isWithinCodeBlock:!1,joinedText:null,markdownCriteria:{markdownFormatKind:"noTransformation",regEx:/(?:)/,regExForAutoFormatting:/(?:)/,requiresParagraphStart:null},patternMatchResults:{regExCaptureGroups:[]},textNodeWithOffset:n,triggerState:o}}function Zg(t,e,n){return t.requiresParagraphStart===!0?ep(t,e):tp(t,e,n)}function hc(t,e,n,o){const r={regExCaptureGroups:[]},s=t.match(o);if(s!==null&&s.length>0&&(e===!1||s.index===0)&&(n===!1||s.index+s[0].length===t.length)){const i=s.length;let l=s.index;for(let a=0;a<i;a++){const c=s[a];r.regExCaptureGroups.push({offsetInParent:l,text:c}),a>0&&(l+=c.length)}return r}return null}function gc(t){return t.patternMatchResults.regExCaptureGroups.length>0}function qn(t){const e=t.textNodeWithOffset;if(e==null)throw Error("Expect to have a text node with offset.");return e}function ep(t,e){const n=qn(e);if(n.node.getPreviousSibling()===null){const o=n.node.getTextContent();return hc(o,!0,!1,e.isAutoFormatting?t.regExForAutoFormatting:t.regEx)}return null}function tp(t,e,n){if(e.joinedText==null)if(S(n))e.joinedText==null&&(e.joinedText=oh(n,uc,qn(e)));else throw Error(`Expected node ${n.__key} to to be a ElementNode.`);const o=t.regExForAutoFormatting===!0;return hc(e.joinedText,!1,o,e.isAutoFormatting?t.regExForAutoFormatting:t.regEx)}function np(t,e,n){let o=null;const r=!1,s=e.getChildren(),i=t.markdownCriteria,l=t.patternMatchResults;if(i.markdownFormatKind!=null)switch(i.markdownFormatKind){case"paragraphH1":return o=Ge("h1"),o.append(...s),{newNode:o,shouldDelete:r};case"paragraphH2":return o=Ge("h2"),o.append(...s),{newNode:o,shouldDelete:r};case"paragraphH3":return o=Ge("h3"),o.append(...s),{newNode:o,shouldDelete:r};case"paragraphH4":return o=Ge("h4"),o.append(...s),{newNode:o,shouldDelete:r};case"paragraphH5":return o=Ge("h5"),o.append(...s),{newNode:o,shouldDelete:r};case"paragraphBlockQuote":return o=Jo(),o.append(...s),{newNode:o,shouldDelete:r};case"paragraphUnorderedList":return Qi(e,s,l,"ul"),{newNode:null,shouldDelete:!1};case"paragraphOrderedList":{const a=l.regExCaptureGroups.length>1?l.regExCaptureGroups[l.regExCaptureGroups.length-1].text:"1",c=t.isAutoFormatting?parseInt(a,10):void 0;return Qi(e,s,l,"ol",c),{newNode:null,shouldDelete:!1}}case"paragraphCodeBlock":{if(t.isAutoFormatting===!1){if(gc(t))return t.isWithinCodeBlock=t.isWithinCodeBlock!==!0,t.currentElementNode=null,{newNode:null,shouldDelete:!0};if(t.isWithinCodeBlock){if(t.currentElementNode==null){const c=ot();return c.append(...s),t.currentElementNode=c,{newNode:c,shouldDelete:!1}}if(t.currentElementNode!=null){const c=t.currentElementNode,u=dt();c.append(u),s.length&&c.append(u),c.append(...s)}}return{newNode:null,shouldDelete:!0}}if(t.triggerState!=null&&t.triggerState.isCodeBlock)o=U();else{o=ot();const a=l.regExCaptureGroups.length>=3?l.regExCaptureGroups[2].text:null;a!=null&&a.length>0&&o.setLanguage(a)}return o.append(...s),{newNode:o,shouldDelete:r}}case"horizontalRule":{if(n!=null){const a=n();e.insertBefore(a)}break}}return{newNode:o,shouldDelete:r}}function Qi(t,e,n,o,r){const s=Ce(),i=n.regExCaptureGroups[0].text.match(/^\s*/),l=i?Math.floor(i[0].length/4):0;s.append(...e);const a=t.getPreviousSibling();if(G(a)&&a.getTag()===o)a.append(s),t.remove();else{const c=Ke(o,r);c.append(s),t.replace(c)}l&&s.setIndent(l)}function op(t,e,n){t.markdownCriteria.requiresParagraphStart===!0?rp(e,t,n):sp(t,e)}function rp(t,e,n){if(e.textNodeWithOffset!=null){const s=qn(e);if(gc(e)){const i=e.patternMatchResults.regExCaptureGroups[0].text,l=s.node.spliceText(0,i.length,"",!0);l.getTextContent()===""&&(l.selectPrevious(),l.remove())}}const{newNode:o,shouldDelete:r}=np(e,t,n);r?t.remove():o!==null&&t.replace(o)}function sp(t,e){const n=t.markdownCriteria;if(n.markdownFormatKind!=null){const o=up(n.markdownFormatKind);if(o!=null){ip(o,t,e);return}n.markdownFormatKind==="link"&&lp(t,e)}}function ip(t,e,n){e.patternMatchResults.regExCaptureGroups.length===7&&(Br(5,5,e,n),Br(1,1,e,n),fp(t,3,e,n),pc(e,n))}function lp(t,e){const o=t.patternMatchResults.regExCaptureGroups;if(o.length!==7)return;const s=o[2].text,i=o[4].text;if(s.length===0||i.length===0)return;Br(1,5,t,e),dp(1,s,t,e);const l=Vn(1,1,!1,!0,t,e);l!=null&&(ie(l),t.editor.dispatchCommand(xt,i),pc(t,e))}function ap(t){return qn(t).node.getParentOrThrow()}function cp(t){const e=t.regExCaptureGroups.length;if(e<2)return 0;const n=e-1;return t.regExCaptureGroups[n].offsetInParent+t.regExCaptureGroups[n].text.length}function up(t){switch(t){case"italic":case"bold":case"underline":case"strikethrough":case"code":return[t];case"strikethrough_italic_bold":return["strikethrough","italic","bold"];case"italic_bold":return["italic","bold"];case"strikethrough_italic":return["strikethrough","italic"];case"strikethrough_bold":return["strikethrough","bold"]}return null}function Vn(t,e,n,o,r,s){const i=r.patternMatchResults,l=i.regExCaptureGroups,a=l.length;if(t>=a||e>=a)return null;const c=cp(i),u=l[t],d=l[e],f=n?u.offsetInParent+u.text.length:u.offsetInParent,h=o?d.offsetInParent+d.text.length:d.offsetInParent,g=mi(f,c,Ji,s),p=mi(h,c,Ji,s);if(g==null&&p==null&&s.getChildren().length===0){const C=Pn();return C.anchor.set(s.getKey(),0,"element"),C.focus.set(s.getKey(),0,"element"),C}if(g==null||p==null)return null;const _=Pn();return _.anchor.set(g.node.getKey(),g.offset,"text"),_.focus.set(p.node.getKey(),p.offset,"text"),_}function Br(t,e,n,o){const s=n.patternMatchResults.regExCaptureGroups,i=Vn(t,e,!1,!0,n,o);if(i!=null){ie(i);const l=T();if(l!=null&&w(l)&&l.isCollapsed()===!1){l.removeText();let a=0;const c=s.length;for(let u=t;u<c;u++){const d=s[u];u>t&&(d.offsetInParent-=a),u<=e&&(a+=d.text.length,d.text="")}}}}function dp(t,e,n,o){const s=n.patternMatchResults.regExCaptureGroups,i=s.length;if(t>=i)return;const a={offsetInParent:s[t].offsetInParent,text:e},c=Vn(t,t,!1,!1,n,o);if(c!=null){ie(c);const u=T();if(u!=null&&w(u)&&u.isCollapsed()){u.insertText(a.text),s.splice(t,0,a);const d=a.text.length,f=s.length;for(let h=t+1;h<f;h++){const g=s[h];g.offsetInParent+=d}}}}function fp(t,e,n,o){const s=n.patternMatchResults.regExCaptureGroups,i=s.length;if(!(e<i))throw Error("The capture group count in the RegEx does match the actual capture group count.");if(s[e].text.length===0)return;const a=Vn(e,e,!1,!0,n,o);if(a!=null){ie(a);const c=T();if(w(c))for(let u=0;u<t.length;u++)c.formatText(t[u])}}function pc(t,e){const o=t.patternMatchResults.regExCaptureGroups.length;if(o<2)return;const r=o-1,s=Vn(r,r,!0,!0,t,e);s!=null&&ie(s)}function Xn(t){return(e,n)=>ac(e)&&e.getTag()==="h"+t?"#".repeat(t)+" "+n(e):null}function ys(t,e){return G(t)?mc(t,e,0):null}const hp=4;function mc(t,e,n){const o=[],r=t.getChildren();let s=0;for(const i of r)if(te(i)){if(i.getChildrenSize()===1){const c=i.getFirstChild();if(G(c)){o.push(mc(c,e,n+1));continue}}const l=" ".repeat(n*hp),a=t.getTag()==="ul"?"- ":`${t.getStart()+s}. `;o.push(l+a+e(i)),s++}return o.join(`
`)}function gp(t,e){return _g(t)?"> "+e(t):null}function pp(t,e){if(!Fn(t))return null;const n=t.getTextContent();return"```"+(t.getLanguage()||"")+(n?`
`+n:"")+"\n```"}function mp(t){if(!w(t))return null;const e=t.anchor.getNode();return b(e)?{node:e,offset:t.anchor.offset}:null}function _p(t,e,n){t.update(()=>{const o=qn(e).node.getParentOrThrow();op(e,o,n)},{tag:"history-push"})}function xp(t,e){const n=e.triggerState,o=t.length;for(let r=0;r<o;r++){const s=t[r];if(n!=null&&n.isCodeBlock===!1||s.markdownFormatKind==="paragraphCodeBlock"){const i=Zg(s,e,ap(e));if(i!=null)return{markdownCriteria:s,patternMatchResults:i}}}return{markdownCriteria:null,patternMatchResults:null}}function yp(t,e){let n=null;return t.getEditorState().read(()=>{const o=mp(T());if(o===null)return;const r=Qg(t,!0,o,e),s=xp(e.isParentAListItemNode===!1?Jg():Xg(),r);s.markdownCriteria===null||s.patternMatchResults===null||(n=r,n.markdownCriteria=s.markdownCriteria,n.patternMatchResults=s.patternMatchResults)}),n}function Cp(t){let e=null;return t.read(()=>{const n=T();if(!w(n)||!n.isCollapsed())return;const o=n.anchor.getNode(),r=o.getParent(),s=te(r),i=r!==null;e={anchorOffset:n.anchor.offset,hasParentNode:i,isCodeBlock:Fn(o),isParentAListItemNode:s,isSelectionCollapsed:!0,isSimpleText:b(o)&&o.isSimpleText(),nodeKey:o.getKey(),textContent:o.getTextContent()}}),e}function Ep(t,e,n){if(e==null||n==null)return null;const o=Vg(),r=dc.length;for(let s=0;s<r;s++){const i=o[s].triggerString,l=i.length,a=e.textContent.length,c=e.anchorOffset-l;if((e.hasParentNode===!0&&e.isSimpleText&&e.isSelectionCollapsed&&e.anchorOffset!==n.anchorOffset&&c>=0&&c+l<=a&&e.textContent.substr(c,l)===i&&e.textContent!==n.textContent)===!1)return null}return yp(t,e)}function Np(t,e){let n=null;return t.registerUpdateListener(({tags:o})=>{if(o.has("historic")===!1){const r=Cp(t.getEditorState()),s=r==null?null:Ep(t,r,n);s!=null&&_p(t,s,e),n=r}else n=null})}const _c=I();function Tp(){return m("hr",{})}class Qo extends gt{static getType(){return"horizontalrule"}static clone(e){return new Qo(e.__key)}static importDOM(){return{hr:e=>({conversion:wp,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(){const e=document.createElement("div");return e.style.display="contents",e}getTextContent(){return`
`}isTopLevel(){return!0}updateDOM(){return!1}decorate(){return m(Tp,{})}}function wp(){return{node:Cs()}}function Cs(){return new Qo}function bp(t){y.exports.useEffect(()=>Np(t,Cs),[t])}function Sp(){const[t]=$();return bp(t),null}function xc(t){const[e,n]=y.exports.useState(t.getEditorState().read(_i(t.isComposing())));return Qe(()=>t.registerUpdateListener(({editorState:o})=>{const r=t.isComposing(),s=o.read(_i(r));n(s)}),[t]),e}function yc(t){const[e,n]=y.exports.useState(()=>t.getDecorators());return Qe(()=>t.registerDecoratorListener(o=>{Ie.exports.flushSync(()=>{n(o)})}),[t]),y.exports.useMemo(()=>{const o=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const i=r[s],l=e[i],a=t.getElementByKey(i);a!==null&&o.push(Ie.exports.createPortal(l,a))}return o},[e,t])}function Cc(t){const e=n=>{const o=t.getRootElement();if(document.activeElement!==o)return;const r=n.data;if(typeof r=="string"){let s;try{s=JSON.parse(r)}catch{return}if(s&&s.protocol==="nuanria_messaging"&&s.type==="request"){const i=s.payload;if(i&&i.functionId==="makeChanges"){const l=i.args;if(l){const[a,c,u,d,f,h]=l;t.update(()=>{const g=T();if(w(g)){const p=g.anchor;let _=p.getNode(),C=0,x=0;if(b(_)&&a>=0&&c>=0&&(C=a,x=a+c,g.setTextNodeRange(_,C,_,x)),(C!==x||u!=="")&&(g.insertRawText(u),_=p.getNode()),b(_)){C=d,x=d+f;const E=_.getTextContentSize();C=C>E?E:C,x=x>E?E:x,g.setTextNodeRange(_,C,_,x)}n.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",e,!0),()=>{window.removeEventListener("message",e,!0)}}const Ec={tag:"history-merge"},Zi=Ec,el=Ec;function Nc(t,e){t.preventDefault(),e.update(()=>{const n=t.clipboardData,o=T();if(o!==null&&n!=null){const r=oc(e);r!==null&&n.setData("text/html",r),n.setData("text/plain",o.getTextContent())}})}function kp(t,e){t.preventDefault(),e.update(()=>{const n=T(),o=t.clipboardData;o!=null&&w(n)&&xs(o,n)})}function vp(t,e){Nc(t,e),e.update(()=>{const n=T();w(n)&&n.removeText()})}function Dp(t,e){if(e!==null){if(e===void 0)t.update(()=>{const n=se();if(n.getFirstChild()===null){const r=U();n.append(r);const s=document.activeElement;(T()!==null||s!==null&&s===t.getRootElement())&&r.select()}},el);else if(e!==null)switch(typeof e){case"string":{const n=t.parseEditorState(e);t.setEditorState(n,Zi);break}case"object":{t.setEditorState(e,Zi);break}case"function":{t.update(e,el);break}}}}function Lp(t,e){const n=ue(t.registerCommand(Fe,o=>{const r=T();return w(r)?(r.deleteCharacter(o),!0):!1},F),t.registerCommand(zt,o=>{const r=T();return w(r)?(r.deleteWord(o),!0):!1},F),t.registerCommand(Wt,o=>{const r=T();return w(r)?(r.deleteLine(o),!0):!1},F),t.registerCommand(qe,o=>{const r=T();if(!w(r))return!1;if(typeof o=="string")r.insertText(o);else{const s=o.dataTransfer;if(s!=null)xs(s,r);else{const i=o.data;i&&r.insertText(i)}}return!0},F),t.registerCommand(bo,o=>{const r=T();return w(r)?(r.removeText(),!0):!1},F),t.registerCommand(at,o=>{const r=T();return w(r)?(r.insertLineBreak(o),!0):!1},F),t.registerCommand(Ht,o=>{const r=T();return w(r)?(r.insertLineBreak(),!0):!1},F),t.registerCommand(Ho,o=>{const r=T();if(!w(r))return!1;const s=o,i=s.shiftKey;return Ro(r,!0)?(s.preventDefault(),Mo(r,i,!0),!0):!1},F),t.registerCommand($o,o=>{const r=T();if(!w(r))return!1;const s=o,i=s.shiftKey;return Ro(r,!1)?(s.preventDefault(),Mo(r,i,!1),!0):!1},F),t.registerCommand(vt,o=>{const r=T();return w(r)?(o.preventDefault(),t.dispatchCommand(Fe,!0)):!1},F),t.registerCommand(Jt,o=>{const r=T();return w(r)?(o.preventDefault(),t.dispatchCommand(Fe,!1)):!1},F),t.registerCommand(Ut,o=>{const r=T();if(!w(r))return!1;if(o!==null){if((Yr||Gr)&&jr)return!1;o.preventDefault()}return t.dispatchCommand(at)},F),t.registerCommand(es,o=>{const r=T();return w(r)?(Nc(o,t),!0):!1},F),t.registerCommand(ts,o=>{const r=T();return w(r)?(vp(o,t),!0):!1},F),t.registerCommand(Ko,o=>{const r=T();return w(r)?(kp(o,t),!0):!1},F),t.registerCommand(Qr,o=>{const r=T();return w(r)?(o.preventDefault(),!0):!1},F),t.registerCommand(Zr,o=>{const r=T();return w(r)?(o.preventDefault(),!0):!1},F));return Dp(t,e),n}function Op(t,e){Qe(()=>ue(Lp(t,e),Cc(t)),[t])}function Tc({contentEditable:t,placeholder:e,initialEditorState:n}){const[o]=$(),r=xc(o);Op(o,n);const s=yc(o);return v(X,{children:[t,r&&e,s]})}function Ap(t,e){Qe(()=>ue(Eg(t,e),Cc(t)),[t])}function wc({contentEditable:t,placeholder:e,initialEditorState:n}){const[o]=$(),r=xc(o);Ap(o,n);const s=yc(o);return v(X,{children:[t,r&&e,s]})}const le={NO_STATUS:0,ROW:1,COLUMN:2,BOTH:3};class Ot extends wa{static getType(){return"tablecell"}static clone(e){return new Ot(e.__headerState,e.__colSpan,e.__width,e.__key)}static importDOM(){return{td:e=>({conversion:tl,priority:0}),th:e=>({conversion:tl,priority:0})}}constructor(e=le.NO_STATUS,n=1,o,r){super(n,r);this.__headerState=e,this.__width=o}createDOM(e){const n=document.createElement(this.getTag());return this.__width&&(n.style.width=`${this.__width}px`),Be(n,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),n}exportDOM(e){const{element:n}=super.exportDOM(e);if(n){const r=this.getParentOrThrow().getChildrenSize();n.style.border="1px solid black",n.style.width=`${this.getWidth()||Math.max(90,700/r)}px`,n.style.verticalAlign="top",n.style.textAlign="start",this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return{element:n}}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e){const n=this.getWritable();return n.__headerState=e,this.__headerState}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const n=this.getWritable();return n.__width=e,this.__width}getWidth(){return this.getLatest().__width}toggleHeaderStyle(e){const n=this.getWritable();return(n.__headerState&e)===e?n.__headerState-=e:n.__headerState+=e,n.__headerState=n.__headerState,n}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==le.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width}collapseAtStart(){return!0}canBeEmpty(){return!1}}function tl(t){const e=t.nodeName.toLowerCase();return{node:Zo(e==="th"?le.ROW:le.NO_STATUS),forChild:(o,r)=>{if(W(r)&&!S(o)){const s=U();return ce(o)&&o.getTextContent()===`
`?null:(s.append(o),s)}return o}}}function Zo(t,e=1,n){return new Ot(t,e,n)}function W(t){return t instanceof Ot}class tn extends Sa{static getType(){return"tablerow"}static clone(e){return new tn(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:Pp,priority:0})}}constructor(e,n){super(n);this.__height=e}createDOM(e){const n=document.createElement("tr");return this.__height&&(n.style.height=`${this.__height}px`),Be(n,e.theme.tableRow),n}setHeight(e){const n=this.getWritable();return n.__height=e,this.__height}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}}function Pp(t){return{node:Es()}}function Es(t){return new tn(t)}function Xe(t){return t instanceof tn}if(ht){const t=document.createElement("style");t.innerHTML=`
    table.disable-selection {
      -webkit-touch-callout: none;
      -webkit-user-select: none; 
      -khtml-user-select: none; 
      -moz-user-select: none; 
      -ms-user-select: none; 
      user-select: none;
    }
  
    .disable-selection span::selection{
      background-color: transparent;
    }
    .disable-selection br::selection{
      background-color: transparent;
    }
  `,document.body&&document.body.append(t)}class Fp{constructor(e,n){this.isHighlightingCells=!1,this.startX=-1,this.startY=-1,this.currentX=-1,this.currentY=-1,this.listenersToRemove=new Set,this.tableNodeKey=n,this.editor=e,this.grid={cells:[],columns:0,rows:0},this.gridSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,this.trackTableGrid()}getGrid(){return this.grid}removeListeners(){Array.from(this.listenersToRemove).forEach(e=>e())}trackTableGrid(){const e=new MutationObserver(n=>{this.editor.update(()=>{let o=!1;for(let s=0;s<n.length;s++){const a=n[s].target.nodeName;if(a==="TABLE"||a==="TR"){o=!0;break}}if(!o)return;const r=this.editor.getElementByKey(this.tableNodeKey);if(!r)throw new Error("Expected to find TableElement in DOM");this.grid=xo(r)})});this.editor.update(()=>{const n=this.editor.getElementByKey(this.tableNodeKey);if(!n)throw new Error("Expected to find TableElement in DOM");this.grid=xo(n),e.observe(n,{childList:!0,subtree:!0})})}clearHighlight(){this.editor.update(()=>{const e=M(this.tableNodeKey);if(!Nn(e))throw new Error("Expected TableNode.");const n=this.editor.getElementByKey(this.tableNodeKey);if(!n)throw new Error("Expected to find TableElement in DOM");const o=xo(n);this.isHighlightingCells=!1,this.startX=-1,this.startY=-1,this.currentX=-1,this.currentY=-1,this.gridSelection=null,this.anchorCellNodeKey=null,this.focusCellNodeKey=null,this.anchorCell=null,this.focusCell=null,this.hasHijackedSelectionStyles=!1,gr(o,null),ie(null),this.editor.dispatchCommand(nt),this.enableHighlightStyle()})}enableHighlightStyle(){this.editor.update(()=>{const e=this.editor.getElementByKey(this.tableNodeKey);if(!e)throw new Error("Expected to find TableElement in DOM");e.classList.remove("disable-selection"),this.hasHijackedSelectionStyles=!1})}disableHighlightStyle(){this.editor.update(()=>{const e=this.editor.getElementByKey(this.tableNodeKey);if(!e)throw new Error("Expected to find TableElement in DOM");e.classList.add("disable-selection"),this.hasHijackedSelectionStyles=!0})}adjustFocusCellForSelection(e,n=!1){this.editor.update(()=>{const o=M(this.tableNodeKey);if(!Nn(o))throw new Error("Expected TableNode.");if(!this.editor.getElementByKey(this.tableNodeKey))throw new Error("Expected to find TableElement in DOM");const s=e.x,i=e.y;this.focusCell=e;const l=je();if(this.anchorCell!==null&&l.setBaseAndExtent(this.anchorCell.elem,0,e.elem,0),!this.isHighlightingCells&&(this.startX!==s||this.startY!==i||n))this.isHighlightingCells=!0,this.disableHighlightStyle();else if(s===this.currentX&&i===this.currentY)return;if(this.currentX=s,this.currentY=i,this.isHighlightingCells){const a=Me(e.elem);if(this.gridSelection!=null&&this.anchorCellNodeKey!=null&&W(a)){const c=a.getKey();this.gridSelection=ei(),this.focusCellNodeKey=c,this.gridSelection.set(this.tableNodeKey,this.anchorCellNodeKey,this.focusCellNodeKey),ie(this.gridSelection),this.editor.dispatchCommand(nt),gr(this.grid,this.gridSelection)}}})}setAnchorCellForSelection(e){this.editor.update(()=>{this.anchorCell=e,this.startX=e.x,this.startY=e.y,je().setBaseAndExtent(e.elem,0,e.elem,0);const o=Me(e.elem);if(W(o)){const r=o.getKey();this.gridSelection=ei(),this.anchorCellNodeKey=r}})}formatCells(e){this.editor.update(()=>{const n=T();if(!Z(n))throw Error("Expected grid selection");const o=Pn(),r=o.anchor,s=o.focus;n.getNodes().forEach(i=>{W(i)&&i.getTextContentSize()!==0&&(r.set(i.getKey(),0,"element"),s.set(i.getKey(),i.getChildrenSize(),"element"),o.formatText(e))}),ie(n),this.editor.dispatchCommand(nt)})}clearText(){this.editor.update(()=>{const e=M(this.tableNodeKey);if(!Nn(e))throw new Error("Expected TableNode.");const n=T();if(!Z(n))throw Error("Expected grid selection");const o=n.getNodes().filter(W);if(o.length===this.grid.columns*this.grid.rows){e.selectPrevious(),e.remove(),this.clearHighlight();return}o.forEach(r=>{if(S(r)){const s=U(),i=K();s.append(i),r.append(s),r.getChildren().forEach(l=>{l!==s&&l.remove()})}}),gr(this.grid,null),ie(null),this.editor.dispatchCommand(nt)})}}const bc="__lexicalTableSelection";function Mp(t,e,n){const o=n.getRootElement();if(o===null)throw new Error("No root element.");const r=new Fp(n,t.getKey());Rp(e,r);let s=!1,i=!1;e.addEventListener("dblclick",c=>{const u=_o(c.target);u!==null&&(c.preventDefault(),c.stopImmediatePropagation(),c.stopPropagation(),r.setAnchorCellForSelection(u),r.adjustFocusCellForSelection(u,!0),s=!1)}),e.addEventListener("mousedown",c=>{setTimeout(()=>{if(c.button!==0)return;const u=_o(c.target);u!==null&&(r.setAnchorCellForSelection(u),document.addEventListener("mouseup",()=>{s=!1},{capture:!0,once:!0}))},0)}),e.addEventListener("mousemove",c=>{if(i&&(c.preventDefault(),c.stopPropagation(),c.stopImmediatePropagation()),s){const u=_o(c.target);if(u!==null){const d=u.x,f=u.y;s&&(r.startX!==d||r.startY!==f||r.isHighlightingCells)&&(c.preventDefault(),s=!0,r.adjustFocusCellForSelection(u))}}}),e.addEventListener("mouseup",c=>{s&&(s=!1)}),e.addEventListener("mouseleave",c=>{});const l=c=>{s=!0,c.button===0&&n.update(()=>{const u=T();if(Z(u)&&u.gridKey===r.tableNodeKey&&o.contains(c.target))return r.clearHighlight()})};window.addEventListener("mousedown",l),r.listenersToRemove.add(()=>window.removeEventListener("mousedown",l));const a=c=>{s=!1};return window.addEventListener("mouseup",a),r.listenersToRemove.add(()=>window.removeEventListener("mouseup",a)),r.listenersToRemove.add(n.registerCommand(kn,c=>{const u=T();if(!Ze(u,t))return!1;const d=c,f="down";if(w(u)){if(u.isCollapsed()){const h=fe(u.anchor.getNode(),x=>W(x));if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid),p=fe(u.anchor.getNode(),x=>S(x));if(p==null)throw new Error("Expected BlockNode Parent");const _=h.getLastChild();if(_&&p.isParentOf(_)||p===_||d.shiftKey)return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),d.shiftKey?(r.setAnchorCellForSelection(t.getCellFromCordsOrThrow(g.x,g.y,r.grid)),rt(r,t,g.x,g.y,f)):gn(r,t,g.x,g.y,f)}}else if(Z(u)&&d.shiftKey){const h=u.focus.getNode();if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid);return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),rt(r,t,g.x,g.y,f)}return!1},me)),r.listenersToRemove.add(n.registerCommand(wt,c=>{const u=T();if(!Ze(u,t))return!1;const d=c,f="up";if(w(u)){if(u.isCollapsed()){const h=fe(u.anchor.getNode(),x=>W(x));if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid),p=fe(u.anchor.getNode(),x=>S(x));if(p==null)throw new Error("Expected BlockNode Parent");const _=h.getLastChild();if(_&&p.isParentOf(_)||p===_||d.shiftKey)return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),d.shiftKey?(r.setAnchorCellForSelection(t.getCellFromCordsOrThrow(g.x,g.y,r.grid)),rt(r,t,g.x,g.y,f)):gn(r,t,g.x,g.y,f)}}else if(Z(u)&&d.shiftKey){const h=u.focus.getNode();if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid);return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),rt(r,t,g.x,g.y,f)}return!1},me)),r.listenersToRemove.add(n.registerCommand(Ho,c=>{const u=T();if(!Ze(u,t))return!1;const d=c,f="backward";if(w(u)){if(u.isCollapsed()){const h=fe(u.anchor.getNode(),_=>W(_));if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid);if(fe(u.anchor.getNode(),_=>S(_))==null)throw new Error("Expected BlockNode Parent");if(u.anchor.offset===0||d.shiftKey)return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),d.shiftKey?(r.setAnchorCellForSelection(t.getCellFromCordsOrThrow(g.x,g.y,r.grid)),rt(r,t,g.x,g.y,f)):gn(r,t,g.x,g.y,f)}}else if(Z(u)&&d.shiftKey){const h=u.focus.getNode();if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid);return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),rt(r,t,g.x,g.y,f)}return!1},me)),r.listenersToRemove.add(n.registerCommand($o,c=>{const u=T();if(!Ze(u,t))return!1;const d=c,f="forward";if(w(u)){if(u.isCollapsed()){const h=fe(u.anchor.getNode(),_=>W(_));if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid);if(fe(u.anchor.getNode(),_=>S(_))==null)throw new Error("Expected BlockNode Parent");if(u.anchor.offset===u.anchor.getNode().getTextContentSize()||d.shiftKey)return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),d.shiftKey?(r.setAnchorCellForSelection(t.getCellFromCordsOrThrow(g.x,g.y,r.grid)),rt(r,t,g.x,g.y,f)):gn(r,t,g.x,g.y,f)}}else if(Z(u)&&d.shiftKey){const h=u.focus.getNode();if(!W(h))return!1;const g=t.getCordsFromCellNode(h,r.grid);return d.preventDefault(),d.stopImmediatePropagation(),d.stopPropagation(),rt(r,t,g.x,g.y,f)}return!1},me)),r.listenersToRemove.add(n.registerCommand(Fe,()=>{const c=T();if(!Ze(c,t))return!1;if(Z(c))return r.clearText(),!0;if(w(c)){const u=fe(c.anchor.getNode(),f=>W(f));if(!W(u))return!1;const d=fe(c.anchor.getNode(),f=>Gt(f));if(!Gt(d))return!1;if(c.isCollapsed()&&c.anchor.offset===0&&d.getPreviousSiblings().length===0)return!0}return!1},me)),r.listenersToRemove.add(n.registerCommand(vt,c=>{const u=T();if(!Ze(u,t))return!1;if(Z(u)){const d=c;return d.preventDefault(),d.stopPropagation(),r.clearText(),!0}else if(w(u)){const d=fe(u.anchor.getNode(),f=>W(f));if(!W(d))return!1}return!1},me)),r.listenersToRemove.add(n.registerCommand(he,c=>{const u=T();if(!Ze(u,t))return!1;if(Z(u))return r.formatCells(c),!0;if(w(u)){const d=fe(u.anchor.getNode(),f=>W(f));if(!W(d))return!1}return!1},me)),r.listenersToRemove.add(n.registerCommand(qe,c=>{const u=T();if(!Ze(u,t))return!1;if(Z(u))return r.clearHighlight(),!1;if(w(u)){const d=fe(u.anchor.getNode(),f=>W(f));if(!W(d))return!1}return!1},me)),r.listenersToRemove.add(n.registerCommand(Wo,c=>{const u=T();if(!Ze(u,t))return!1;if(w(u)){const d=fe(u.anchor.getNode(),h=>W(h));if(!W(d))return!1;const f=c;if(u.isCollapsed()){const h=t.getCordsFromCellNode(d,r.grid);return f.preventDefault(),gn(r,t,h.x,h.y,f.shiftKey?"backward":"forward"),!0}}return!1},me)),r.listenersToRemove.add(n.registerCommand(os,c=>t.isSelected(),me)),r.listenersToRemove.add(n.registerCommand(nt,c=>{const u=T();if(u&&w(u)&&!u.isCollapsed()){const d=u.anchor.getNode(),f=u.focus.getNode(),h=t.isParentOf(d),g=t.isParentOf(f);if(h&&!g||g&&!h){const _=u.isBackward(),C=Pn(),x=t.getIndexWithinParent(),E=t.getParentOrThrow().getKey();return C.anchor.set(u.anchor.key,u.anchor.offset,u.anchor.type),C.focus.set(E,_?x-1:x+1,"element"),i=!0,ie(C),nl(r),!0}}return r.hasHijackedSelectionStyles&&!t.isSelected()?(Bp(r),i=!1):!r.hasHijackedSelectionStyles&&t.isSelected()&&nl(r),!1},me)),r}function Rp(t,e){t[bc]=e}function Ip(t){return t[bc]}function _o(t){let e=t;for(;e!=null;){const n=e.nodeName;if(n==="TD"||n==="TH"){const o=e._cell;return o===void 0?null:o}e=e.parentNode}return null}function xo(t){const e=[],n={cells:e,columns:0,rows:0};let o=t.firstChild,r=0,s=0;for(e.length=0;o!=null;){const i=o.nodeName;if(i==="TD"||i==="TH"){const u={elem:o,highlighted:!1,x:r,y:s};o._cell=u,e[s]===void 0&&(e[s]=[]),e[s][r]=u}else{const c=o.firstChild;if(c!=null){o=c;continue}}const l=o.nextSibling;if(l!=null){r++,o=l;continue}const a=o.parentNode;if(a!=null){const c=a.nextSibling;if(c==null)break;s++,r=0,o=c}}return n.columns=r+1,n.rows=s+1,n}function gr(t,e){const n=[],o=new Set(e?e.getNodes():[]);return Ns(t,(r,s)=>{const i=r.elem;o.has(s)?(r.highlighted=!0,i.style.setProperty("background-color","rgb(172, 206, 247)"),i.style.setProperty("caret-color","transparent"),n.push(r)):(r.highlighted=!1,i.style.removeProperty("background-color"),i.style.removeProperty("caret-color"),i.getAttribute("style")||i.removeAttribute("style"))}),n}function Ns(t,e){const{cells:n}=t;for(let o=0;o<n.length;o++){const r=n[o];for(let s=0;s<r.length;s++){const i=r[s],l=Me(i.elem);l!==null&&e(i,l,{x:s,y:o})}}}function nl(t){t.disableHighlightStyle(),Ns(t.grid,e=>{const n=e.elem;e.highlighted=!0,n.style.setProperty("background-color","rgb(172, 206, 247)"),n.style.setProperty("caret-color","transparent")})}function Bp(t){t.enableHighlightStyle(),Ns(t.grid,e=>{const n=e.elem;e.highlighted=!1,n.style.removeProperty("background-color"),n.style.removeProperty("caret-color"),n.getAttribute("style")||n.removeAttribute("style")})}const gn=(t,e,n,o,r)=>{switch(r){case"backward":case"forward":{const s=r==="forward";return n!==(s?t.grid.columns-1:0)?lo(e.getCellNodeFromCordsOrThrow(n+(s?1:-1),o,t.grid)):o!==(s?t.grid.rows-1:0)?lo(e.getCellNodeFromCordsOrThrow(s?0:t.grid.columns-1,o+(s?1:-1),t.grid)):s?e.selectNext():e.selectPrevious(),!0}case"up":return o!==0?lo(e.getCellNodeFromCordsOrThrow(n,o-1,t.grid)):e.selectPrevious(),!0;case"down":return o!==t.grid.rows-1?lo(e.getCellNodeFromCordsOrThrow(n,o+1,t.grid)):e.selectNext(),!0}return!1},rt=(t,e,n,o,r)=>{switch(r){case"backward":case"forward":{const s=r==="forward";return n!==(s?t.grid.columns-1:0)&&t.adjustFocusCellForSelection(e.getCellFromCordsOrThrow(n+(s?1:-1),o,t.grid)),!0}case"up":return o!==0?(t.adjustFocusCellForSelection(e.getCellFromCordsOrThrow(n,o-1,t.grid)),!0):!1;case"down":return o!==t.grid.rows-1?(t.adjustFocusCellForSelection(e.getCellFromCordsOrThrow(n,o+1,t.grid)),!0):!1}return!1};function Ze(t,e){if(w(t)||Z(t)){const n=e.isParentOf(t.anchor.getNode()),o=e.isParentOf(t.focus.getNode());return n&&o}return!1}function lo(t){const e=t.getChildren().find(n=>Gt(n));Gt(e)?e.selectEnd():t.selectEnd()}class kt extends ba{static getType(){return"table"}static clone(e){return new kt(e.__key)}static importDOM(){return{table:e=>({conversion:$p,priority:0})}}constructor(e){super(e)}createDOM(e,n){const o=document.createElement("table");return Be(o,e.theme.table),o}updateDOM(){return!1}exportDOM(e){return j(z({},super.exportDOM(e)),{after:n=>{if(n){const o=n.cloneNode(),r=document.createElement("colgroup"),s=document.createElement("tbody");s.append(...n.children);const i=this.getFirstChildOrThrow();if(!Xe(i))throw new Error("Expected to find row node.");const l=i.getChildrenSize();for(let a=0;a<l;a++){const c=document.createElement("col");r.append(c)}return o.replaceChildren(r,s),o}}})}canExtractContents(){return!1}canBeEmpty(){return!1}getCordsFromCellNode(e,n){if(!n)throw Error("Grid not found.");const{rows:o,cells:r}=n;for(let s=0;s<o;s++){const i=r[s];if(i==null)throw new Error(`Row not found at y:${s}`);const l=i.findIndex(({elem:a})=>Me(a)===e);if(l!==-1)return{x:l,y:s}}throw new Error("Cell not found in table.")}getCellFromCords(e,n,o){if(!o)throw Error("Grid not found.");const{cells:r}=o,s=r[n];if(s==null)return null;const i=s[e];return i==null?null:i}getCellFromCordsOrThrow(e,n,o){const r=this.getCellFromCords(e,n,o);if(!r)throw new Error("Cell not found at cords.");return r}getCellNodeFromCords(e,n,o){const r=this.getCellFromCords(e,n,o);if(r==null)return null;const s=Me(r.elem);return W(s)?s:null}getCellNodeFromCordsOrThrow(e,n,o){const r=this.getCellNodeFromCords(e,n,o);if(!r)throw new Error("Node at cords not TableCellNode.");return r}canSelectBefore(){return!0}}function Kp(t,e){const n=t.getElementByKey(e.getKey());if(n==null)throw new Error("Table Element Not Found");return xo(n)}function $p(t){return{node:Sc()}}function Sc(){return new kt}function Nn(t){return t instanceof kt}function Hp(t,e,n=!0){const o=Sc();for(let r=0;r<t;r++){const s=Es();for(let i=0;i<e;i++){let l=le.NO_STATUS;n&&(r===0&&(l|=le.ROW),i===0&&(l|=le.COLUMN));const a=Zo(l),c=U();c.append(K()),a.append(c),s.append(a)}o.append(s)}return o}function zp(t){const e=fe(t,n=>W(n));return W(e)?e:null}function kc(t){const e=fe(t,n=>Xe(n));if(Xe(e))return e;throw new Error("Expected table cell to be inside of table row.")}function ke(t){const e=fe(t,n=>Nn(n));if(Nn(e))return e;throw new Error("Expected table cell to be inside of table.")}function yo(t){const e=kc(t);return ke(e).getChildren().findIndex(o=>o.is(e))}function Co(t){return kc(t).getChildren().findIndex(n=>n.is(t))}function Wp(t,e){const n=ke(t),{x:o,y:r}=n.getCordsFromCellNode(t,e);return{above:n.getCellNodeFromCords(o,r-1,e),below:n.getCellNodeFromCords(o,r+1,e),left:n.getCellNodeFromCords(o-1,r,e),right:n.getCellNodeFromCords(o+1,r,e)}}function Up(t,e){const n=t.getChildren();if(e>=n.length||e<0)throw new Error("Expected table cell to be inside of table row.");return n[e].remove(),t}function jp(t,e,n=!0,o,r){const s=t.getChildren();if(e>=s.length||e<0)throw new Error("Table row target index out of range");const i=s[e];if(Xe(i))for(let l=0;l<o;l++){const a=i.getChildren(),c=a.length,u=Es();for(let d=0;d<c;d++){const f=a[d];if(!W(f))throw Error("Expected table cell");const{above:h,below:g}=Wp(f,r);let p=le.NO_STATUS;const _=h&&h.getWidth()||g&&g.getWidth()||null;(h&&h.hasHeaderState(le.COLUMN)||g&&g.hasHeaderState(le.COLUMN))&&(p|=le.COLUMN);const C=Zo(p,1,_);C.append(U()),u.append(C)}n?i.insertAfter(u):i.insertBefore(u)}else throw new Error("Row before insertion index does not exist.");return t}function Gp(t,e,n=!0,o){const r=t.getChildren();for(let s=0;s<r.length;s++){const i=r[s];if(Xe(i))for(let l=0;l<o;l++){let a=le.NO_STATUS;s===0&&(a|=le.ROW);const c=Zo(a);c.append(U());const u=i.getChildren();if(e>=u.length||e<0)throw new Error("Table column target index out of range");const d=u[e];n?d.insertAfter(c):d.insertBefore(c)}}return t}function Yp(t,e){const n=t.getChildren();for(let o=0;o<n.length;o++){const r=n[o];if(Xe(r)){const s=r.getChildren();if(e>=s.length||e<0)throw new Error("Table column target index out of range");s[e].remove()}}return t}const vc=I();function Dc(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([kt,Ot,tn]))throw Error("TablePlugin: TableNode, TableCellNode or TableRowNode not registered on editor");return t.registerCommand(vc,e=>{const{columns:n,rows:o}=e,r=T();if(!w(r))return!0;const s=r.focus,i=s.getNode();if(i!==null){const l=Hp(Number(o),Number(n));if(V(i)){const c=i.getChildAtIndex(s.offset);c!==null?c.insertBefore(l):i.append(l),l.insertBefore(U())}else i.getTopLevelElementOrThrow().insertAfter(l);l.insertAfter(U()),l.getFirstChildOrThrow().getFirstChildOrThrow().select()}return!0},F)},[t]),y.exports.useEffect(()=>{const e=new Map;return t.registerMutationListener(kt,n=>{for(const[o,r]of n)if(r==="created")t.update(()=>{const s=t.getElementByKey(o),i=M(o);if(s&&i){const l=Mp(i,s,t);e.set(o,l)}});else if(r==="destroyed"){const s=e.get(o);s&&(s.removeListeners(),e.delete(o))}})},[t]),null}const qp=new URL(window.location.href),Vp=new URLSearchParams(qp.search),Xp="ws://localhost:1234",Jp="playground",Qp=Vp.get("collabId")||"0";function Ts(t,e){let n=e.get(t);return n===void 0?(n=new Eo,e.set(t,n)):n.load(),new yu(Xp,Jp+"/"+Qp+"/"+t,n,{connect:!1})}function Zp({onClose:t,children:e,title:n}){const o=y.exports.useRef(null);return y.exports.useEffect(()=>{o.current!==null&&o.current.focus()},[]),y.exports.useEffect(()=>{const r=s=>{s.keyCode===27&&t()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[t]),m("div",{className:"Modal__overlay",role:"dialog",children:v("div",{className:"Modal__modal",tabIndex:-1,ref:o,children:[m("h2",{className:"Modal__title",children:n}),m("button",{className:"Modal__closeButton","aria-label":"Close modal",type:"Close",onClick:t,children:"X"}),m("div",{className:"Modal__content",children:e})]})})}function Lc({onClose:t,children:e,title:n}){return Ie.exports.createPortal(m(Zp,{onClose:t,title:n,children:e}),document.body)}function em(){const[t,e]=y.exports.useState(null),n=y.exports.useCallback(()=>{e(null)},[]),o=y.exports.useMemo(()=>{if(t===null)return null;const{title:s,content:i}=t;return m(Lc,{onClose:n,title:s,children:i})},[t,n]),r=y.exports.useCallback((s,i)=>{e({content:i(n),title:s})},[n]);return[o,r]}function Kr(...t){return t.filter(Boolean).join(" ")}function De({"data-test-id":t,children:e,onClick:n,disabled:o,small:r}){return m("button",j(z({disabled:o,className:Kr("Button__root",o&&"Button__disabled",r&&"Button__small"),onClick:n},t&&{"data-test-id":t}),{children:e}))}const ol=()=>{let t=document.getElementById("report-container");return t===null&&(t=document.createElement("div"),t.id="report-container",t.style.position="fixed",t.style.top="50%",t.style.left="50%",t.style.fontSize="32px",t.style.transform="translate(-50%, -50px)",t.style.padding="20px",t.style.background="rgba(240, 240, 240, 0.4)",t.style.borderRadius="20px",document.body&&document.body.appendChild(t)),t};function Oc(){const t=y.exports.useRef(null),e=y.exports.useCallback(()=>{clearTimeout(t.current),document.body&&document.body.removeChild(ol())},[]);return y.exports.useEffect(()=>e,[e]),y.exports.useCallback(n=>{console.log(n);const o=ol();return clearTimeout(t.current),o.innerHTML=n,t.current=setTimeout(e,1e3),t.current},[e])}const tm=I(),nm={"\n":({selection:t})=>{t.insertParagraph()},redo:({editor:t})=>{t.dispatchCommand(Xt)},undo:({editor:t})=>{t.dispatchCommand(Vt)}},om="SpeechRecognition"in window||"webkitSpeechRecognition"in window;function rm(){const[t]=$(),[e,n]=y.exports.useState(!1),o=y.exports.useRef(null),r=Oc();return y.exports.useEffect(()=>{if(e&&o.current===null){const s=window.SpeechRecognition||window.webkitSpeechRecognition;o.current=new s,o.current.continuous=!0,o.current.interimResults=!0,o.current.addEventListener("result",i=>{const l=i.results.item(i.resultIndex),{transcript:a}=l.item(0);r(a),l.isFinal&&t.update(()=>{const c=T();if(w(c)){const u=nm[a.toLowerCase().trim()];u?u({editor:t,selection:c}):a.match(/\s*\n\s*/)?c.insertParagraph():c.insertText(a)}})})}return o.current&&(e?o.current.start():o.current.stop()),()=>{o.current!==null&&o.current.stop()}},[t,e,r]),y.exports.useEffect(()=>t.registerCommand(tm,s=>(n(s),!0),F),[t]),null}var sm=om?rm:()=>null;class Et extends Ne{static clone(e){return new Et(e.__text,e.__key)}static getType(){return"typeahead"}createDOM(e){const n=super.createDOM(e);return n.style.cssText="color: #ccc;",n}}function im(t){return new Et(t).setMode("inert")}function lm(t){const e=y.exports.useRef(null),[n,o]=y.exports.useState(t.getEditorState().read(fs)),[r,s]=y.exports.useState(!1),i=y.exports.useMemo(()=>new cm,[]),l=am(n,i.query),a=y.exports.useCallback(()=>{if(e.current===null)return null;const u=M(e.current);return b(u)?u:null},[]);y.exports.useEffect(()=>{if(!t.hasNodes([Et]))throw new Error("AutocompletePlugin: TypeaheadNode not registered on editor");return t.registerTextContentListener(u=>{o(u)})},[t]);const c=y.exports.useCallback(()=>{t.update(()=>{const u=a();function d(){if(u!==null){const p=T();if(w(p)){const _=p.anchor,C=p.focus;if(_.type==="text"&&C.type==="text"){let x=_.getNode(),E=_.offset;x.getKey()===u.getKey()&&(x=x.getPreviousSibling(),b(x)&&(E=x.getTextContent().length));let N=C.getNode(),k=C.offset;N.getKey()===u.getKey()&&(N=N.getPreviousSibling(),b(N)&&(k=N.getTextContent().length)),b(N)&&b(x)&&p.setTextNodeRange(x,E,N,k)}}u.remove()}e.current=null}function f(){if(u!==null){u.getTextContent(!0)!==l&&u.setTextContent(l!=null?l:"");return}const p=se().getLastChild();if(S(p)){const _=p.getLastChild();if(b(_)){const C=im(l!=null?l:"");_.insertAfter(C),e.current=C.getKey()}}}const h=T();let g=!1;if(w(h)){const p=h==null?void 0:h.anchor.getNode(),_=h==null?void 0:h.anchor.offset,C=p==null?void 0:p.getTextContentSize();g=C!=null&&_===C}l===null||!r||!g?d():f()},{tag:"history-merge"})},[t,a,r,l]);y.exports.useEffect(()=>{c()},[c,l]),y.exports.useEffect(()=>t.registerUpdateListener(({editorState:u})=>{u.read(()=>{const d=se().getAllTextNodes(!0).find(f=>f instanceof Et);d instanceof Et&&(e.current=d.getKey())})}),[t]),y.exports.useEffect(()=>{const u=t.getRootElement();if(u!=null){const d=f=>{(f.key==="Tab"||f.key==="ArrowRight")&&t.update(()=>{const h=a(),g=h==null?void 0:h.getPreviousSibling();h!==null&&b(g)&&(f.preventDefault(),g.setTextContent(g.getTextContent()+h.getTextContent(!0)),g.select()),h==null||h.remove(),e.current=null})};return u.addEventListener("keydown",d),()=>{u.removeEventListener("keydown",d)}}},[t,a]),y.exports.useEffect(()=>{const u=()=>{const d=window.getSelection();s(d.isCollapsed)};return document.addEventListener("selectionchange",u),()=>{document.removeEventListener("selectionchange",u)}},[])}function am(t,e){const n=y.exports.useRef(()=>{}),o=y.exports.useRef(0),[r,s]=y.exports.useState(null);return y.exports.useEffect(()=>{s(null),n.current(),(async()=>{const i=Date.now();o.current=i;try{const l=await e(t);n.current=l.cancel,s(await l.promise())}catch{}})()},[e,t]),r}class cm{constructor(){oo(this,"DATABASE",{"Happy ":"birthday","Happy b":"irthday","Happy bi":"rthday",He:"llo",Hel:"lo",Hell:"o","Hello ":"world","Hello w":"orld","Hello wo":"rld","Hello wor":"ld","happy ":"birthday","happy b":"irthday","happy bi":"rthday",he:"llo",hel:"lo",hell:"o","hello ":"world","hello w":"orld","hello wo":"rld","hello wor":"ld"});oo(this,"LATENCY",200);oo(this,"query",e=>{let n=!1;return{cancel:()=>{n=!0},promise:()=>new Promise((s,i)=>{setTimeout(()=>{var a;const l=(a=this.DATABASE[e])!=null?a:null;n?i("Cancelled network request"):s(l)},this.LATENCY)})}})}}function um(){const[t]=$();return lm(t),null}function Ac(t,e){for(let n=0;n<e.length;n++){const o=e[n](t);if(o)return o}return null}function Pc(t){let e=t.getPreviousSibling();return S(e)&&(e=e.getLastDescendant()),e===null||ce(e)||b(e)&&e.getTextContent().endsWith(" ")}function Fc(t){let e=t.getNextSibling();return S(e)&&(e=e.getFirstDescendant()),e===null||ce(e)||b(e)&&e.getTextContent().startsWith(" ")}function dm(t,e,n){const o=t.getTextContent(),r=o.length;let s=o,i=0,l=t,a;for(;(a=Ac(s,e))&&a!==null;){const c=a.index,u=i+c,d=a.length;let f;u>0?f=o[u-1]===" ":f=Pc(t);let h;if(u+d<r?h=o[u+d]===" ":h=Fc(t),f&&h){let p;c===0?[p,l]=l.splitText(d):[,p,l]=l.splitText(c,c+d);const _=Oa(a.url);_.append(K(a.text)),p.replace(_),n(a.url,null)}const g=c+d;s=s.substring(g),i+=g}}function rl(t,e,n){const o=t.getChildren(),r=o.length;for(let a=0;a<r;a++){const c=o[a];if(!b(c)||!c.isSimpleText()){Tn(t),n(null,t.getURL());return}}const s=t.getTextContent(),i=Ac(s,e);if(i===null||i.text!==s){Tn(t),n(null,t.getURL());return}if(!Pc(t)||!Fc(t)){Tn(t),n(null,t.getURL());return}const l=t.getURL();i!==null&&l!==i.url&&(t.setURL(i.url),n(i.url,l))}function fm(t,e){const n=t.getPreviousSibling(),o=t.getNextSibling(),r=t.getTextContent();Ar(n)&&!r.startsWith(" ")&&(Tn(n),e(null,n.getURL())),Ar(o)&&!r.endsWith(" ")&&(Tn(o),e(null,o.getURL()))}function Tn(t){const e=t.getChildren(),n=e.length;for(let o=n-1;o>=0;o--)t.insertAfter(e[o]);return t.remove(),e.map(o=>o.getLatest())}function hm(t,e,n){y.exports.useEffect(()=>{if(!t.hasNodes([bt]))throw Error("LexicalAutoLinkPlugin: AutoLinkNode, TableCellNode or TableRowNode not registered on editor");const o=(...r)=>{n&&n(...r)};return ue(t.registerNodeTransform(Ne,r=>{const s=r.getParentOrThrow();Ar(s)?rl(s,e,o):Pe(s)||(r.isSimpleText()&&dm(r,e,o),fm(r,o))}),t.registerNodeTransform(bt,r=>{rl(r,e,o)}))},[t,e,n])}function gm({matchers:t,onChange:e}){const[n]=$();return hm(n,t,e),null}const pm=/((https?:\/\/(www\.)?)|(www\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/,mm=/(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/,_m=[t=>{const e=pm.exec(t);return e&&{index:e.index,length:e[0].length,text:e[0],url:e[0]}},t=>{const e=mm.exec(t);return e&&{index:e.index,length:e[0].length,text:e[0],url:`mailto:${e[0]}`}}];function xm(){return m(gm,{matchers:_m})}function ym({filter:t,newTab:e=!0}){const[n]=$(),o=y.exports.useRef(!1);return y.exports.useEffect(()=>{let r,s;function i(c){r=c.offsetX,s=c.offsetY}function l(c){o.current=c.offsetX!==r||c.offsetY!==s}function a(c){const u=o.current;o.current=!1;const d=c,f=Cm(d,n);if(f===null)return;const h=f.getAttribute("href");if(f.getAttribute("contenteditable")==="false"||h===void 0)return;let g=null;n.update(()=>{const p=Me(f);Pe(p)&&(g=p)}),!(g===null||t!==void 0&&!t(d,g))&&(u||window.open(h,e||d.metaKey||d.ctrlKey?"_blank":"_self"))}return n.registerRootListener((c,u)=>{u!==null&&(u.removeEventListener("pointerdown",i),u.removeEventListener("pointerup",l),u.removeEventListener("click",a)),c!==null&&(c.addEventListener("click",a),c.addEventListener("pointerdown",i),c.addEventListener("pointerup",l))})},[n,t,e]),null}function sl(t){return t.nodeName.toLowerCase()==="a"}function Cm(t,e){return e.getEditorState().read(()=>{const n=t.target;return sl(n)?n:n.parentNode&&sl(n.parentNode)?n.parentNode:null})}function Em(){const[t]=$();return y.exports.useEffect(()=>og(t),[t]),null}class Jn extends Ne{static getType(){return"emoji"}static clone(e){return new Jn(e.__className,e.__text,e.__key)}constructor(e,n,o){super(n,o);this.__className=e}createDOM(e){const n=document.createElement("span"),o=super.createDOM(e);return n.className=this.__className,o.className="emoji-inner",n.appendChild(o),n}updateDOM(e,n,o){const r=n.firstChild;return r===null?!0:(super.updateDOM(e,r,o),!1)}}function Nm(t,e){return new Jn(t,e).setMode("token")}const il=new Map([[":)",["emoji happysmile","\u{1F642}"]],[":D",["emoji veryhappysmile","\u{1F600}"]],[":(",["emoji unhappysmile","\u{1F641}"]],["<3",["emoji heart","\u2764"]],["\u{1F642}",["emoji happysmile","\u{1F642}"]],["\u{1F600}",["emoji veryhappysmile","\u{1F600}"]],["\u{1F641}",["emoji unhappysmile","\u{1F641}"]],["\u2764",["emoji heart","\u2764"]]]);function Tm(t){const e=t.getTextContent();for(let n=0;n<e.length;n++){const o=il.get(e[n])||il.get(e.slice(n,n+2));if(o!==void 0){const[r,s]=o;let i;n===0?[i]=t.splitText(n+2):[,i]=t.splitText(n,n+2);const l=Nm(r,s);return i.replace(l),l}}return null}function wm(t){let e=t;for(;e!==null;){if(!e.isSimpleText())return;e=Tm(e)}}function bm(t){y.exports.useEffect(()=>{if(!t.hasNodes([Jn]))throw new Error("EmojisPlugin: EmojiNode not registered on editor");return t.registerNodeTransform(Ne,wm)},[t])}function Mc(){const[t]=$();return bm(t),null}function Sm({equation:t,setEquation:e,inline:n,inputRef:o}){const s={equation:t,inputRef:o,onChange:i=>{e(i.target.value)}};return n?m(km,z({},s)):m(vm,z({},s))}function km({equation:t,onChange:e,inputRef:n}){return v("span",{className:"EquationEditor_inputBackground",children:[m("span",{className:"EquationEditor_dollarSign",children:"$"}),m("input",{className:"EquationEditor_inlineEditor",value:t,onChange:e,autoFocus:!0,ref:n}),m("span",{className:"EquationEditor_dollarSign",children:"$"})]})}function vm({equation:t,onChange:e,inputRef:n}){return v("div",{className:"EquationEditor_inputBackground",children:[m("span",{className:"EquationEditor_dollarSign",children:`$$
`}),m("textarea",{className:"EquationEditor_blockEditor",value:t,onChange:e,ref:n}),m("span",{className:"EquationEditor_dollarSign",children:`
$$`})]})}function Rc({equation:t,inline:e,onClick:n}){const o=y.exports.useRef(null);return y.exports.useEffect(()=>{const r=o.current;r!==null&&Cu.render(t,r,{displayMode:!e,errorColor:"#cc0000",output:"html",strict:"warn",throwOnError:!1,trust:!1})},[t,e]),v(X,{children:[m("span",{className:"spacer",children:" "}),m("span",{role:"button",tabIndex:-1,onClick:n,ref:o}),m("span",{className:"spacer",children:" "})]})}function Dm({equation:t,inline:e,nodeKey:n}){const[o]=$(),[r,s]=y.exports.useState(t),[i,l]=y.exports.useState(!1),a=y.exports.useRef(null),c=y.exports.useCallback(u=>{l(!1),o.update(()=>{const d=M(n);Om(d)&&(d.setEquation(r),u&&d.selectNext(0,0))})},[o,r,n]);return y.exports.useEffect(()=>{if(i)return ue(o.registerCommand(nt,u=>{const d=document.activeElement;return a.current!==d&&c(),!1},ii),o.registerCommand(zo,u=>{const d=document.activeElement;return a.current===d?(c(!0),!0):!1},ii))},[o,c,i]),m(X,{children:i?m(Sm,{equation:r,setEquation:s,inline:e,inputRef:a}):m(Rc,{equation:r,inline:e,onClick:()=>{l(!0)}})})}class nn extends gt{static getType(){return"equation"}static clone(e){return new nn(e.__equation,e.__inline,e.__key)}constructor(e,n,o){super(o);this.__equation=e,this.__inline=n!=null?n:!1}createDOM(e){return document.createElement(this.__inline?"span":"div")}updateDOM(e){return this.__inline!==e.__inline}setEquation(e){const n=this.getWritable();n.__equation=e}decorate(){return m(Dm,{equation:this.__equation,inline:this.__inline,nodeKey:this.__key})}}function Lm(t="",e=!1){return new nn(t,e)}function Om(t){return t instanceof nn}const Ic=I();function Am(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([nn]))throw new Error("ExcalidrawPlugin: ExcalidrawNode not registered on editor");return t.registerCommand(Ic,e=>{const{equation:n,inline:o}=e,r=T();if(w(r)){const s=Lm(n,o);r.insertNodes([s])}return!0},F)},[t]),null}function ll(t,e){return t.getEditorState().read(()=>{const n=M(e);return n===null?!1:n.isSelected()})}function ws(t){const[e]=$(),[n,o]=y.exports.useState(()=>ll(e,t));y.exports.useEffect(()=>e.registerUpdateListener(()=>{o(ll(e,t))}),[e,t]);const r=y.exports.useCallback(i=>{e.update(()=>{let l=T();Le(l)||(l=af(),ie(l)),i?l.add(t):l.delete(t)})},[e,t]),s=y.exports.useCallback(()=>{e.update(()=>{const i=T();Le(i)&&i.clear()})},[e]);return[n,r,s]}function Bc({onResizeStart:t,onResizeEnd:e,imageRef:n,editor:o,showCaption:r,setShowCaption:s}){const i=y.exports.useRef(null),l=y.exports.useRef({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),a=o.getRootElement(),c=a!==null?a.getBoundingClientRect().width-20:100,u=(h,g)=>{const p=n.current;if(p!==null){const{width:_,height:C}=p.getBoundingClientRect(),x=l.current;x.startWidth=_,x.startHeight=C,x.ratio=_/C,x.currentWidth="inherit",x.currentHeight="inherit",x.startX=h.clientX,x.startY=h.clientY,x.isResizing=!0,x.direction=g,t(),document.addEventListener("pointermove",d),document.addEventListener("pointerup",f)}},d=h=>{const g=n.current,p=l.current;if(g!==null&&p.isResizing)if(p.direction===3){const _=Math.floor(p.startY-h.clientY)*2,C=150*p.ratio,x=c/p.ratio;let E=p.startHeight+_;E<C?E=C:E>x&&(E=x),g.style.width="inherit",g.style.height=`${E}px`,p.currentHeight=E}else if(p.direction===2){const _=Math.floor(h.clientY-p.startY),C=150*p.ratio,x=c/p.ratio;let E=p.startHeight+_;E<C?E=C:E>x&&(E=x),g.style.width="inherit",g.style.height=`${E}px`,p.currentHeight=E}else{const _=Math.floor(h.clientX-p.startX),C=150*p.ratio,x=c;let E=p.startWidth+_;E<C?E=C:E>x&&(E=x),g.style.width=`${E}px`,g.style.height="inherit",p.currentWidth=E}},f=h=>{const g=n.current,p=l.current;if(g!==null&&p.isResizing){const _=p.currentWidth,C=p.currentHeight;p.startWidth=0,p.startHeight=0,p.ratio=0,p.startX=0,p.startY=0,p.currentWidth=0,p.currentHeight=0,p.isResizing=!1,e(_,C),document.removeEventListener("pointermove",d),document.removeEventListener("pointerup",f)}};return v(X,{children:[!r&&m("button",{className:"image-caption-button",ref:i,onClick:()=>{s(!r)},children:"Add Caption"}),m("div",{className:"image-resizer-ne",onPointerDown:h=>{u(h,0)}}),m("div",{className:"image-resizer-se",onPointerDown:h=>{u(h,1)}}),m("div",{className:"image-resizer-sw",onPointerDown:h=>{u(h,2)}}),m("div",{className:"image-resizer-nw",onPointerDown:h=>{u(h,3)}})]})}const Pm=t=>{var o;const e=(o=t==null?void 0:t.firstElementChild)==null?void 0:o.firstElementChild,n=t.getAttribute("viewBox");if(n!=null){const r=n.split(" ");t.setAttribute("width",r[2]),t.setAttribute("height",r[3])}e&&e.tagName==="style"&&e.remove()};function Fm({elements:t,imageContainerRef:e,className:n="",height:o=null,width:r=null,appState:s=null,rootClassName:i=null}){const[l,a]=y.exports.useState(null);return y.exports.useEffect(()=>{(async()=>{const u=await Eu.exports.exportToSvg({appState:s,elements:t});Pm(u),u.setAttribute("width","100%"),u.setAttribute("height","100%"),a(u)})()},[t,s]),m("div",{ref:e,className:i,dangerouslySetInnerHTML:{__html:l==null?void 0:l.outerHTML}})}function Mm({onSave:t,initialElements:e,isShown:n=!1,onHide:o,onDelete:r}){const s=y.exports.useRef(null),[i,l]=y.exports.useState(!1),[a,c]=y.exports.useState(e),u=()=>{a.filter(p=>!p.isDeleted).length>0?t(a):r(),o()},d=()=>{a.filter(p=>!p.isDeleted).length===0?r():l(!0)};function f(){return v(Lc,{title:"Discard",onClose:()=>{l(!1)},children:["Are you sure you want to discard the changes?",v("div",{className:"ExcalidrawModal__discardModal",children:[m(De,{onClick:()=>{l(!1),o()},children:"Discard"})," ",m(De,{onClick:()=>{l(!1)},children:"Cancel"})]})]})}if(y.exports.useEffect(()=>{var p;(p=s==null?void 0:s.current)==null||p.updateScene({elements:e})},[e]),n===!1)return null;const h=p=>{c(p)},g=tr.$$typeof!=null?tr:tr.default;return Ie.exports.createPortal(m("div",{className:"ExcalidrawModal__modal",children:v("div",{className:"ExcalidrawModal__row",children:[i&&m(f,{}),m(g,{onChange:h,initialData:{appState:{isLoading:!1},elements:e}}),v("div",{className:"ExcalidrawModal__actions",children:[m("button",{className:"action-button",onClick:d,children:"Discard"}),m("button",{className:"action-button",onClick:u,children:"Save"})]})]})}),document.body)}function Rm({nodeKey:t,data:e}){const[n]=$(),[o,r]=y.exports.useState(e==="[]"&&!n.isReadOnly()),s=y.exports.useRef(null),i=y.exports.useRef(null),[l,a,c]=ws(t),[u,d]=y.exports.useState(!1),f=y.exports.useCallback(x=>(l&&Le(T())&&(x.preventDefault(),n.update(()=>{const N=M(t);pr(N)&&N.remove(),a(!1)})),!1),[n,l,t,a]);y.exports.useEffect(()=>{o&&n.setReadOnly(!0)},[o,n]),y.exports.useEffect(()=>ue(n.registerCommand(In,x=>{const E=i.current,N=x.target;return u?!0:E!==null&&E.contains(N)?(x.shiftKey||c(),a(!l),x.detail>1&&r(!0),!0):!1},J),n.registerCommand(Jt,f,J),n.registerCommand(vt,f,J)),[c,n,l,u,f,a]);const h=y.exports.useCallback(()=>n.update(()=>{const x=M(t);pr(x)&&x.remove()}),[n,t]),g=y.exports.useCallback(x=>{if(!n.isReadOnly())return n.update(()=>{const E=M(t);pr(E)&&(x.length>0?E.setData(JSON.stringify(x)):E.remove())})},[n,t]),p=y.exports.useCallback(()=>{const x=n.getRootElement();x!==null&&x.style.setProperty("cursor","nwse-resize","important"),d(!0)},[n]),_=y.exports.useCallback((x,E)=>{const N=n.getRootElement();N!==null&&N.style.setProperty("cursor","default"),setTimeout(()=>{d(!1)},200)},[n]),C=y.exports.useMemo(()=>JSON.parse(e),[e]);return v(X,{children:[m(Mm,{initialElements:C,isShown:o,onDelete:h,onHide:()=>{n.setReadOnly(!1),r(!1)},onSave:x=>{n.setReadOnly(!1),g(x),r(!1)}}),v("button",{ref:i,className:`excalidraw-button ${l?"selected":""}`,children:[m(Fm,{imageContainerRef:s,className:"image",elements:C}),(l||u)&&m(Bc,{showCaption:!0,setShowCaption:()=>{},imageRef:s,editor:n,onResizeStart:p,onResizeEnd:_})]})]})}class on extends gt{static getType(){return"excalidraw"}static clone(e){return new on(e.__data,e.__key)}constructor(e="[]",n){super(n);this.__data=e}createDOM(e){const n=document.createElement("span"),r=e.theme.image;return r!==void 0&&(n.className=r),n}updateDOM(){return!1}setData(e){const n=this.getWritable();n.__data=e}decorate(e){return m(Rm,{nodeKey:this.getKey(),data:this.__data})}}function Im(){return new on}function pr(t){return t instanceof on}const Kc=I();function Bm(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([on]))throw new Error("ExcalidrawPlugin: ExcalidrawNode not registered on editor");return t.registerCommand(Kc,()=>{const e=T();if(w(e)){const n=Im();e.insertNodes([n])}return!0},F)},[t]),null}function Km(){const[t]=$();return y.exports.useEffect(()=>t.registerCommand(_c,e=>{const n=T();if(!w(n))return!1;if(n.focus.getNode()!==null){const r=Cs();n.insertParagraph(),n.focus.getNode().getTopLevelElementOrThrow().insertBefore(r)}return!0},F),[t]),null}function $c({initialEditor:t,children:e,initialTheme:n}){const o=y.exports.useContext(No);if(o==null)throw Error("Unexpected parent context null on a nested composer");const r=y.exports.useMemo(()=>{const[a,c]=o,u=n||c.getTheme()||void 0,d=El(o,u);return u!==void 0&&(t._config.theme=u),t._parentEditor=a,t._nodes=a._nodes,[t,d]},[]),{yjsDocMap:s}=jn(),i=s.get("main")!==void 0,l=s.has(t.getKey());return m(No.Provider,{value:r,children:!i||l?e:null})}class qt extends Ne{static getType(){return"keyword"}static clone(e){return new qt(e.__text,e.__key)}createDOM(e){const n=super.createDOM(e);return n.style.cursor="default",n.className="keyword",n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}isTextEntity(){return!0}}function $m(t){return new qt(t)}const Hm=/(^|$|[^A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ])(congrats|congratulations|gratuluju|gratuluji|gratulujeme|blahopřeju|blahopřeji|blahopřejeme|Til lykke|Tillykke|Glückwunsch|Gratuliere|felicitaciones|enhorabuena|paljon onnea|onnittelut|Félicitations|gratula|gratulálok|gratulálunk|congratulazioni|complimenti|おめでとう|おめでとうございます|축하해|축하해요|gratulerer|Gefeliciteerd|gratulacje|Parabéns|parabéns|felicitações|felicitări|мои поздравления|поздравляем|поздравляю|gratulujem|blahoželám|ยินดีด้วย|ขอแสดงความยินดี|tebrikler|tebrik ederim|恭喜|祝贺你|恭喜你|恭喜|恭喜|baie geluk|veels geluk|অভিনন্দন|Čestitam|Čestitke|Čestitamo|Συγχαρητήρια|Μπράβο|અભિનંદન|badhai|बधाई|अभिनंदन|Честитам|Свака част|hongera|வாழ்த்துகள்|வாழ்த்துக்கள்|అభినందనలు|അഭിനന്ദനങ്ങൾ|Chúc mừng|מזל טוב|mazel tov|mazal tov)(^|$|[^A-Za-zªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎↃↄⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々〆〱-〵〻〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛥꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ])/i;function Hc(){const[t]=$();y.exports.useEffect(()=>{if(!t.hasNodes([qt]))throw new Error("KeywordsPlugin: KeywordNode not registered on editor")},[t]);const e=y.exports.useCallback(o=>$m(o.getTextContent()),[]),n=y.exports.useCallback(o=>{const r=Hm.exec(o);if(r===null)return null;const s=r[2].length,i=r.index+r[1].length;return{end:i+s,start:i}},[]);return Ya(n,qt,e),null}const zm="background-color: rgba(24, 119, 232, 0.2)";class Qn extends Ne{static getType(){return"mention"}static clone(e){return new Qn(e.__mention,e.__text,e.__key)}constructor(e,n,o){super(n!=null?n:e,o);this.__mention=e}createDOM(e){const n=super.createDOM(e);return n.style.cssText=zm,n.className="mention",n}isTextEntity(){return!0}}function Wm(t){const e=new Qn(t);return e.setMode("segmented").toggleDirectionless(),e}const zc=`\\.,\\+\\*\\?\\$\\@\\|#{}\\(\\)\\^\\-\\[\\]\\\\/!%'"~=<>_:;`,Um="\\b[A-Z][^\\s"+zc+"]",Wc={NAME:Um,PUNCTUATION:zc},jm=new RegExp("(^|[^#])((?:"+Wc.NAME+"{"+1+",})$)"),Uc=Wc.PUNCTUATION,bs=["@","\\uff20"].join(""),jc="[^"+bs+Uc+"\\s]",Gm="(?:\\.[ |$]| |["+Uc+"]|)",Ym=75,qm=new RegExp("(^|\\s|\\()(["+bs+"]((?:"+jc+Gm+"){0,"+Ym+"}))$"),Vm=50,Xm=new RegExp("(^|\\s|\\()(["+bs+"]((?:"+jc+"){0,"+Vm+"}))$"),al=5,mr=new Map,Jm=["Aayla Secura","Adi Gallia","Admiral Dodd Rancit","Admiral Firmus Piett","Admiral Gial Ackbar","Admiral Ozzel","Admiral Raddus","Admiral Terrinald Screed","Admiral Trench","Admiral U.O. Statura","Agen Kolar","Agent Kallus","Aiolin and Morit Astarte","Aks Moe","Almec","Alton Kastle","Amee","AP-5","Armitage Hux","Artoo","Arvel Crynyd","Asajj Ventress","Aurra Sing","AZI-3","Bala-Tik","Barada","Bargwill Tomder","Baron Papanoida","Barriss Offee","Baze Malbus","Bazine Netal","BB-8","BB-9E","Ben Quadinaros","Berch Teller","Beru Lars","Bib Fortuna","Biggs Darklighter","Black Krrsantan","Bo-Katan Kryze","Boba Fett","Bobbajo","Bodhi Rook","Borvo the Hutt","Boss Nass","Bossk","Breha Antilles-Organa","Bren Derlin","Brendol Hux","BT-1","C-3PO","C1-10P","Cad Bane","Caluan Ematt","Captain Gregor","Captain Phasma","Captain Quarsh Panaka","Captain Rex","Carlist Rieekan","Casca Panzoro","Cassian Andor","Cassio Tagge","Cham Syndulla","Che Amanwe Papanoida","Chewbacca","Chi Eekway Papanoida","Chief Chirpa","Chirrut \xCEmwe","Ciena Ree","Cin Drallig","Clegg Holdfast","Cliegg Lars","Coleman Kcaj","Coleman Trebor","Colonel Kaplan","Commander Bly","Commander Cody (CC-2224)","Commander Fil (CC-3714)","Commander Fox","Commander Gree","Commander Jet","Commander Wolffe","Conan Antonio Motti","Conder Kyl","Constable Zuvio","Cord\xE9","Cpatain Typho","Crix Madine","Cut Lawquane","Dak Ralter","Dapp","Darth Bane","Darth Maul","Darth Tyranus","Daultay Dofine","Del Meeko","Delian Mors","Dengar","Depa Billaba","Derek Klivian","Dexter Jettster","Dine\xE9 Ellberger","DJ","Doctor Aphra","Doctor Evazan","Dogma","Dorm\xE9","Dr. Cylo","Droidbait","Droopy McCool","Dryden Vos","Dud Bolt","Ebe E. Endocott","Echuu Shen-Jon","Eeth Koth","Eighth Brother","Eirta\xE9","Eli Vanto","Ell\xE9","Ello Asty","Embo","Eneb Ray","Enfys Nest","EV-9D9","Evaan Verlaine","Even Piell","Ezra Bridger","Faro Argyus","Feral","Fifth Brother","Finis Valorum","Finn","Fives","FN-1824","FN-2003","Fodesinbeed Annodue","Fulcrum","FX-7","GA-97","Galen Erso","Gallius Rax",'Garazeb "Zeb" Orrelios',"Gardulla the Hutt","Garrick Versio","Garven Dreis","Gavyn Sykes","Gideon Hask","Gizor Dellso","Gonk droid","Grand Inquisitor","Greeata Jendowanian","Greedo","Greer Sonnel","Grievous","Grummgar","Gungi","Hammerhead","Han Solo","Harter Kalonia","Has Obbit","Hera Syndulla","Hevy","Hondo Ohnaka","Huyang","Iden Versio","IG-88","Ima-Gun Di","Inquisitors","Inspector Thanoth","Jabba","Jacen Syndulla","Jan Dodonna","Jango Fett","Janus Greejatus","Jar Jar Binks","Jas Emari","Jaxxon","Jek Tono Porkins","Jeremoch Colton","Jira","Jobal Naberrie","Jocasta Nu","Joclad Danva","Joh Yowza","Jom Barell","Joph Seastriker","Jova Tarkin","Jubnuk","Jyn Erso","K-2SO","Kanan Jarrus","Karbin","Karina the Great","Kes Dameron","Ketsu Onyo","Ki-Adi-Mundi","King Katuunko","Kit Fisto","Kitster Banai","Klaatu","Klik-Klak","Korr Sella","Kylo Ren","L3-37","Lama Su","Lando Calrissian","Lanever Villecham","Leia Organa","Letta Turmond","Lieutenant Kaydel Ko Connix","Lieutenant Thire","Lobot","Logray","Lok Durd","Longo Two-Guns","Lor San Tekka","Lorth Needa","Lott Dod","Luke Skywalker","Lumat","Luminara Unduli","Lux Bonteri","Lyn Me","Lyra Erso","Mace Windu","Malakili","Mama the Hutt","Mars Guo","Mas Amedda","Mawhonic","Max Rebo","Maximilian Veers","Maz Kanata","ME-8D9","Meena Tills","Mercurial Swift","Mina Bonteri","Miraj Scintel","Mister Bones","Mod Terrik","Moden Canady","Mon Mothma","Moradmin Bast","Moralo Eval","Morley","Mother Talzin","Nahdar Vebb","Nahdonnis Praji","Nien Nunb","Niima the Hutt","Nines","Norra Wexley","Nute Gunray","Nuvo Vindi","Obi-Wan Kenobi","Odd Ball","Ody Mandrell","Omi","Onaconda Farr","Oola","OOM-9","Oppo Rancisis","Orn Free Taa","Oro Dassyne","Orrimarko","Osi Sobeck","Owen Lars","Pablo-Jill","Padm\xE9 Amidala","Pagetti Rook","Paige Tico","Paploo","Petty Officer Thanisson","Pharl McQuarrie","Plo Koon","Po Nudo","Poe Dameron","Poggle the Lesser","Pong Krell","Pooja Naberrie","PZ-4CO","Quarrie","Quay Tolsite","Queen Apailana","Queen Jamillia","Queen Neeyutnee","Qui-Gon Jinn","Quiggold","Quinlan Vos","R2-D2","R2-KT","R3-S6","R4-P17","R5-D4","RA-7","Rab\xE9","Rako Hardeen","Ransolm Casterfo","Rappertunie","Ratts Tyerell","Raymus Antilles","Ree-Yees","Reeve Panzoro","Rey","Ric Oli\xE9","Riff Tamson","Riley","Rinnriyin Di","Rio Durant","Rogue Squadron","Romba","Roos Tarpals","Rose Tico","Rotta the Hutt","Rukh","Rune Haako","Rush Clovis","Ruwee Naberrie","Ryoo Naberrie","Sab\xE9","Sabine Wren","Sach\xE9","Saelt-Marae","Saesee Tiin","Salacious B. Crumb","San Hill","Sana Starros","Sarco Plank","Sarkli","Satine Kryze","Savage Opress","Sebulba","Senator Organa","Sergeant Kreel","Seventh Sister","Shaak Ti","Shara Bey","Shmi Skywalker","Shu Mai","Sidon Ithano","Sifo-Dyas","Sim Aloo","Siniir Rath Velus","Sio Bibble","Sixth Brother","Slowen Lo","Sly Moore","Snaggletooth","Snap Wexley","Snoke","Sola Naberrie","Sora Bulq","Strono Tuggs","Sy Snootles","Tallissan Lintra","Tarfful","Tasu Leech","Taun We","TC-14","Tee Watt Kaa","Teebo","Teedo","Teemto Pagalies","Temiri Blagg","Tessek","Tey How","Thane Kyrell","The Bendu","The Smuggler","Thrawn","Tiaan Jerjerrod","Tion Medon","Tobias Beckett","Tulon Voidgazer","Tup","U9-C4","Unkar Plutt","Val Beckett","Vanden Willard","Vice Admiral Amilyn Holdo","Vober Dand","WAC-47","Wag Too","Wald","Walrus Man","Warok","Wat Tambor","Watto","Wedge Antilles","Wes Janson","Wicket W. Warrick","Wilhuff Tarkin","Wollivan","Wuher","Wullf Yularen","Xamuel Lennox","Yaddle","Yarael Poof","Yoda","Zam Wesell","Zev Senesca","Ziro the Hutt","Zuckuss"],Qm={search(t,e){setTimeout(()=>{const n=Jm.filter(o=>o.toLowerCase().includes(t.toLowerCase()));n.length===0?e(null):e(n)},500)}};function Zm(t){const[e,n]=y.exports.useState(null);return y.exports.useEffect(()=>{const o=mr.get(t);if(o!==null){if(o!==void 0){n(o);return}mr.set(t,null),Qm.search(t,r=>{mr.set(t,r),n(r)})}},[t]),e}function e_({index:t,isHovered:e,isSelected:n,onClick:o,onMouseEnter:r,onMouseLeave:s,result:i}){const l=y.exports.useRef(null);let a="item";return n&&(a+=" selected"),e&&(a+=" hovered"),m("li",{tabIndex:-1,className:a,ref:l,role:"option","aria-selected":n,id:"typeahead-item-"+t,onMouseEnter:r,onMouseLeave:s,onClick:o,children:i},i)}function t_({close:t,editor:e,resolution:n}){const o=y.exports.useRef(null),r=n.match,s=Zm(r.matchingString),[i,l]=y.exports.useState(null),[a,c]=y.exports.useState(null);y.exports.useEffect(()=>{const f=o.current,h=e.getRootElement();if(s!==null&&f!==null&&h!==null){const g=n.range,{left:p,top:_,height:C}=g.getBoundingClientRect();return f.style.top=`${_+C+2}px`,f.style.left=`${p-14}px`,f.style.display="block",h.setAttribute("aria-controls","mentions-typeahead"),()=>{f.style.display="none",h.removeAttribute("aria-controls")}}},[e,n,s]);const u=y.exports.useCallback(()=>{if(s===null||i===null)return;const f=s[i];t(),c_(e,f,r)},[t,r,e,s,i]),d=y.exports.useCallback(f=>{const h=e.getRootElement();h!==null&&(h.setAttribute("aria-activedescendant","typeahead-item-"+f),l(f))},[e]);return y.exports.useEffect(()=>()=>{const f=e.getRootElement();f!==null&&f.removeAttribute("aria-activedescendant")},[e]),Qe(()=>{s===null?l(null):i===null&&d(0)},[s,i,d]),y.exports.useEffect(()=>ue(e.registerCommand(kn,f=>{const h=f;return s!==null&&i!==null&&(i<al-1&&i!==s.length-1&&d(i+1),h.preventDefault(),h.stopImmediatePropagation()),!0},J),e.registerCommand(wt,f=>{const h=f;return s!==null&&i!==null&&(i!==0&&d(i-1),h.preventDefault(),h.stopImmediatePropagation()),!0},J),e.registerCommand(zo,f=>{const h=f;return s===null||i===null?!1:(h.preventDefault(),h.stopImmediatePropagation(),t(),!0)},J),e.registerCommand(Wo,f=>{const h=f;return s===null||i===null?!1:(h.preventDefault(),h.stopImmediatePropagation(),u(),!0)},J),e.registerCommand(Ut,f=>s===null||i===null?!1:(f!==null&&(f.preventDefault(),f.stopImmediatePropagation()),u(),!0),J)),[u,t,e,s,i,d]),s===null?null:m("div",{"aria-label":"Suggested mentions",id:"mentions-typeahead",ref:o,role:"listbox",children:m("ul",{children:s.slice(0,al).map((f,h)=>m(e_,{index:h,isHovered:h===a,isSelected:h===i,onClick:()=>{l(h),u()},onMouseEnter:()=>{c(h)},onMouseLeave:()=>{c(null)},result:f},f))})})}function n_(t,e){const n=jm.exec(t);if(n!==null){const o=n[1],r=n[2];if(r!=null&&r.length>=e)return{leadOffset:n.index+o.length,matchingString:r,replaceableString:r}}return null}function o_(t,e){let n=qm.exec(t);if(n===null&&(n=Xm.exec(t)),n!==null){const o=n[1],r=n[3];if(r.length>=e)return{leadOffset:n.index+o.length,matchingString:r,replaceableString:n[2]}}return null}function r_(t){const e=o_(t,1);return e===null?n_(t,3):e}function s_(t){const e=t.anchor;if(e.type!=="text")return null;const n=e.getNode();if(!n.isSimpleText())return null;const o=e.offset;return n.getTextContent().slice(0,o)}function i_(t,e){const n=window.getSelection();if(n===null||!n.isCollapsed)return!1;const o=n.anchorNode,r=t.leadOffset,s=n.anchorOffset;try{e.setStart(o,r),e.setEnd(o,s)}catch{return!1}return!0}function l_(t){let e=null;return t.getEditorState().read(()=>{const n=T();!w(n)||(e=s_(n))}),e}function a_(t,e,n){let o=n;for(let r=o;r<=e.length;r++)t.substr(-r)===e.substr(0,r)&&(o=r);return o}function c_(t,e,n){t.update(()=>{const o=T();if(!w(o)||!o.isCollapsed())return;const r=o.anchor;if(r.type!=="text")return;const s=r.getNode();if(!s.isSimpleText())return;const i=r.offset,l=s.getTextContent().slice(0,i),a=n.replaceableString.length,c=a_(l,e,a),u=i-c;if(u<0)return;let d;u===0?[d]=s.splitText(i):[,d]=s.splitText(u,i);const f=Wm(e);d.replace(f),f.select()})}function u_(t,e){return e!==0?!1:t.getEditorState().read(()=>{const n=T();if(w(n)){const s=n.anchor.getNode().getPreviousSibling();return b(s)&&s.isTextEntity()}return!1})}function d_(t){const[e,n]=y.exports.useState(null);y.exports.useEffect(()=>{if(!t.hasNodes([Qn]))throw new Error("MentionsPlugin: MentionNode not registered on editor")},[t]),y.exports.useEffect(()=>{let r=document.createRange(),s=null;const i=()=>{const a=r,c=l_(t);if(c===s||a===null||(s=c,c===null))return;const u=r_(c);if(u!==null&&!u_(t,u.leadOffset)&&i_(u,a)!==null){y.exports.startTransition(()=>n({match:u,range:a}));return}y.exports.startTransition(()=>n(null))},l=t.registerUpdateListener(i);return()=>{r=null,l()}},[t]);const o=y.exports.useCallback(()=>{n(null)},[]);return e===null||t===null?null:Ie.exports.createPortal(m(t_,{close:o,resolution:e,editor:t}),document.body)}function f_(){const[t]=$();return d_(t)}function h_({onClose:t,tableCellNode:e,setIsMenuOpen:n,contextRef:o}){const[r]=$(),s=y.exports.useRef(),[i,l]=y.exports.useState(e),[a,c]=y.exports.useState({columns:1,rows:1});y.exports.useEffect(()=>r.registerMutationListener(Ot,x=>{x.get(i.getKey())==="updated"&&r.getEditorState().read(()=>{l(i.getLatest())})}),[r,i]),y.exports.useEffect(()=>{r.getEditorState().read(()=>{const x=T();if(Z(x)){const E=x.getShape();c({columns:E.toX-E.fromX+1,rows:E.toY-E.fromY+1})}})},[r]),y.exports.useEffect(()=>{const x=o.current,E=s.current;if(x!=null&&E!=null){const N=x.getBoundingClientRect();E.style.opacity="1",E.style.left=`${N.left+N.width+window.pageXOffset+5}px`,E.style.top=`${N.top+window.pageYOffset}px`}},[o,s]),y.exports.useEffect(()=>{function x(E){s.current!=null&&o.current!=null&&!s.current.contains(E.target)&&!o.current.contains(E.target)&&n(!1)}return window.addEventListener("click",x),()=>window.removeEventListener("click",x)},[n,o]);const u=y.exports.useCallback(()=>{r.update(()=>{if(i.isAttached()){const x=ke(i),E=r.getElementByKey(x.getKey());if(!E)throw new Error("Expected to find tableElement in DOM");Ip(E).clearHighlight(),x.markDirty(),l(i.getLatest())}ie(null)})},[r,i]),d=y.exports.useCallback(x=>{r.update(()=>{const E=T(),N=ke(i);let k;if(Z(E)){const A=E.getShape();k=x?A.toY:A.fromY}else k=yo(i);const D=Kp(r,N);jp(N,k,x,a.rows,D),u(),t()})},[r,i,a.rows,u,t]),f=y.exports.useCallback(x=>{r.update(()=>{const E=T(),N=ke(i);let k;if(Z(E)){const D=E.getShape();k=x?D.toX:D.fromX}else k=Co(i);Gp(N,k,x,a.columns),u(),t()})},[r,i,a.columns,u,t]),h=y.exports.useCallback(()=>{r.update(()=>{const x=ke(i),E=yo(i);Up(x,E),u(),t()})},[r,i,u,t]),g=y.exports.useCallback(()=>{r.update(()=>{ke(i).remove(),u(),t()})},[r,i,u,t]),p=y.exports.useCallback(()=>{r.update(()=>{const x=ke(i),E=Co(i);Yp(x,E),u(),t()})},[r,i,u,t]),_=y.exports.useCallback(x=>{r.update(()=>{const E=ke(i),N=yo(i),k=E.getChildren();if(N>=k.length||N<0)throw new Error("Expected table cell to be inside of table row.");const D=k[N];if(!Xe(D))throw new Error("Expected table row");D.getChildren().forEach(A=>{if(!W(A))throw new Error("Expected table cell");A.toggleHeaderStyle(le.ROW)}),u(),t()})},[r,i,u,t]),C=y.exports.useCallback(x=>{r.update(()=>{const E=ke(i),N=Co(i),k=E.getChildren();for(let D=0;D<k.length;D++){const A=k[D];if(!Xe(A))throw new Error("Expected table row");const L=A.getChildren();if(N>=L.length||N<0)throw new Error("Expected table cell to be inside of table row.");const R=L[N];if(!W(R))throw new Error("Expected table cell");R.toggleHeaderStyle(le.COLUMN)}u(),t()})},[r,i,u,t]);return Ie.exports.createPortal(v("div",{className:"dropdown",ref:s,onClick:x=>{x.stopPropagation()},children:[m("button",{className:"item",onClick:()=>d(!1),children:v("span",{className:"text",children:["Insert"," ",a.rows===1?"row":`${a.rows} rows`," ","above"]})}),m("button",{className:"item",onClick:()=>d(!0),children:v("span",{className:"text",children:["Insert"," ",a.rows===1?"row":`${a.rows} rows`," ","below"]})}),m("hr",{}),m("button",{className:"item",onClick:()=>f(!1),children:v("span",{className:"text",children:["Insert"," ",a.columns===1?"column":`${a.columns} columns`," ","left"]})}),m("button",{className:"item",onClick:()=>f(!0),children:v("span",{className:"text",children:["Insert"," ",a.columns===1?"column":`${a.columns} columns`," ","right"]})}),m("hr",{}),m("button",{className:"item",onClick:()=>p(),children:m("span",{className:"text",children:"Delete column"})}),m("button",{className:"item",onClick:()=>h(),children:m("span",{className:"text",children:"Delete row"})}),m("button",{className:"item",onClick:()=>g(),children:m("span",{className:"text",children:"Delete table"})}),m("hr",{}),m("button",{className:"item",onClick:()=>_(),children:v("span",{className:"text",children:[(i.__headerState&le.ROW)===le.ROW?"Remove":"Add"," ","row header"]})}),m("button",{className:"item",onClick:()=>C(),children:v("span",{className:"text",children:[(i.__headerState&le.COLUMN)===le.COLUMN?"Remove":"Add"," ","column header"]})})]}),document.body)}function g_(){const[t]=$(),e=y.exports.useRef(null),n=y.exports.useRef(null),[o,r]=y.exports.useState(!1),[s,i]=y.exports.useState(null),l=y.exports.useCallback(()=>{const c=e.current,u=T(),d=window.getSelection(),f=document.activeElement;if(u==null||c==null){i(null);return}const h=t.getRootElement();if(w(u)&&h!==null&&h.contains(d.anchorNode)){const g=zp(u.anchor.getNode());if(g==null){i(null);return}if(t.getElementByKey(g.getKey())==null){i(null);return}i(g)}else f||i(null)},[t]);y.exports.useEffect(()=>t.registerUpdateListener(()=>{t.getEditorState().read(()=>{l()})})),y.exports.useEffect(()=>{const c=e.current;if(c!=null&&s!=null){const u=t.getElementByKey(s.getKey());if(u!=null){const d=u.getBoundingClientRect(),f=c.getBoundingClientRect();c.style.opacity="1",c.style.left=`${d.left+window.pageXOffset-f.width+d.width-10}px`,c.style.top=`${d.top+window.pageYOffset+5}px`}else c.style.opacity="0"}},[e,s,t]);const a=y.exports.useRef(s);return y.exports.useEffect(()=>{a.current!==s&&r(!1),a.current=s},[a,s]),m("div",{className:"table-cell-action-button-container",ref:e,children:s!=null&&v(X,{children:[m("button",{className:"table-cell-action-button chevron-down",onClick:c=>{c.stopPropagation(),r(!o)},ref:n,children:m("i",{className:"chevron-down"})}),o&&m(h_,{contextRef:n,setIsMenuOpen:r,onClose:()=>r(!1),tableCellNode:s})]})})}function Gc(){const[t]=$();return y.exports.useMemo(()=>Ie.exports.createPortal(m(g_,{editor:t}),document.body),[t])}const Yc=Object.freeze({"	":"\\t","\n":"\\n"}),cl=new RegExp(Object.keys(Yc).join("|"),"g"),Ye=Object.freeze({ancestorHasNextSibling:"|",ancestorIsLastChild:" ",hasNextSibling:"\u251C",isLastChild:"\u2514",selectedChar:"^",selectedLine:">"});function p_({timeTravelButtonClassName:t,timeTravelPanelSliderClassName:e,timeTravelPanelButtonClassName:n,viewClassName:o,timeTravelPanelClassName:r,editor:s}){const[i,l]=y.exports.useState([]),[a,c]=y.exports.useState(""),[u,d]=y.exports.useState(!1),f=y.exports.useRef(0),h=y.exports.useRef(null),g=y.exports.useRef(null),[p,_]=y.exports.useState(!1);y.exports.useEffect(()=>(c(ul(s.getEditorState())),s.registerUpdateListener(({editorState:x})=>{const E=s._compositionKey,N=ul(s.getEditorState()),k=E!==null&&`Composition key: ${E}`;c([N,k].filter(Boolean).join(`

`)),u||l(D=>[...D,[Date.now(),x]])})),[u,s]);const C=i.length;return y.exports.useEffect(()=>{if(p){let x;const E=()=>{const N=f.current;if(N===C-1){_(!1);return}const k=i[N][0],A=i[N+1][0]-k;x=setTimeout(()=>{f.current++;const L=f.current,R=g.current;R!==null&&(R.value=String(L)),s.setEditorState(i[L][1]),E()},A)};return E(),()=>{window.clearTimeout(x)}}},[i,p,s,C]),y.exports.useEffect(()=>{const x=h.current;if(x!==null)return x.__lexicalEditor=s,()=>{x.__lexicalEditor=null}},[s]),v("div",{className:o,children:[!u&&C>2&&m("button",{onClick:()=>{const x=s.getRootElement();x!==null&&(x.contentEditable="false",f.current=C-1,d(!0))},className:t,children:"Time Travel"}),m("pre",{ref:h,children:a}),u&&v("div",{className:r,children:[m("button",{className:n,onClick:()=>{_(!p)},children:p?"Pause":"Play"}),m("input",{className:e,ref:g,onChange:x=>{const E=Number(x.target.value),N=i[E];N&&(f.current=E,s.setEditorState(N[1]))},type:"range",min:"1",max:C-1}),m("button",{className:n,onClick:()=>{const x=s.getRootElement();if(x!==null){x.contentEditable="true";const E=i.length-1,N=i[E];s.setEditorState(N[1]);const k=g.current;k!==null&&(k.value=String(E)),d(!1),_(!1)}},children:"Exit"})]})]})}function m_(t){let e="";const n=Vc(t);e+=`: range ${n!==""?`{ ${n} }`:""}`;const o=t.anchor,r=t.focus,s=o.offset,i=r.offset;return e+=`
  \u251C anchor { key: ${o.key}, offset: ${s===null?"null":s}, type: ${o.type} }`,e+=`
  \u2514 focus { key: ${r.key}, offset: ${i===null?"null":i}, type: ${r.type} }`,e}function __(t){return`: node
  \u2514 [${Array.from(t._nodes).join(", ")}]`}function x_(t){return`: grid
  \u2514 { grid: ${t.gridKey}, anchorCell: ${t.anchor.key}, focusCell: ${t.focus.key} }`}function ul(t){let e=` root
`;const n=t.read(()=>{const o=T();return qc(se(),(r,s)=>{const l=`(${r.getKey()})`,a=r.getType()||"",c=r.isSelected();e+=`${c?Ye.selectedLine:" "} ${s.join(" ")} ${l} ${a} ${C_(r)}
`,e+=k_({indent:s,isSelected:c,node:r,nodeKeyDisplay:l,selection:o,typeDisplay:a})}),o===null?": null":w(o)?m_(o):Z(o)?x_(o):__(o)});return e+`
 selection`+n}function qc(t,e,n=[]){const o=t.getChildren(),r=o.length;o.forEach((s,i)=>{e(s,n.concat(i===r-1?Ye.isLastChild:Ye.hasNextSibling)),S(s)&&qc(s,e,n.concat(i===r-1?Ye.ancestorIsLastChild:Ye.ancestorHasNextSibling))})}function y_(t){return Object.entries(Yc).reduce((e,[n,o])=>e.replace(new RegExp(n,"g"),String(o)),t)}function C_(t){if(b(t)){const e=t.getTextContent(!0),n=e.length===0?"(empty)":`"${y_(e)}"`,o=w_(t);return[n,o.length!==0?`{ ${o} }`:null].filter(Boolean).join(" ").trim()}return""}const E_=[t=>t.hasFormat("bold")&&"Bold",t=>t.hasFormat("code")&&"Code",t=>t.hasFormat("italic")&&"Italic",t=>t.hasFormat("strikethrough")&&"Strikethrough",t=>t.hasFormat("subscript")&&"Subscript",t=>t.hasFormat("superscript")&&"Superscript",t=>t.hasFormat("underline")&&"Underline"],N_=[t=>t.isDirectionless()&&"Directionless",t=>t.isUnmergeable()&&"Unmergeable"],T_=[t=>t.isToken()&&"Token",t=>t.isSegmented()&&"Segmented",t=>t.isInert()&&"Inert"];function w_(t){return[Vc(t),b_(t),S_(t)].filter(Boolean).join(", ")}function b_(t){let e=N_.map(n=>n(t)).filter(Boolean).join(", ").toLocaleLowerCase();return e!==""&&(e="detail: "+e),e}function S_(t){let e=T_.map(n=>n(t)).filter(Boolean).join(", ").toLocaleLowerCase();return e!==""&&(e="mode: "+e),e}function Vc(t){let e=E_.map(n=>n(t)).filter(Boolean).join(", ").toLocaleLowerCase();return e!==""&&(e="format: "+e),e}function k_({indent:t,isSelected:e,node:n,nodeKeyDisplay:o,selection:r,typeDisplay:s}){if(!b(n)||!w(r)||!e||S(n))return"";const i=r.anchor,l=r.focus;if(n.getTextContent()===""||i.getNode()===r.focus.getNode()&&i.offset===l.offset)return"";const[a,c]=v_(n,r);if(a===c)return"";const u=t[t.length-1]===Ye.hasNextSibling?Ye.ancestorHasNextSibling:Ye.ancestorIsLastChild,d=[...t.slice(0,t.length-1),u],f=Array(a).fill(" "),h=Array(c-a).fill(Ye.selectedChar),g=s.length+3,p=Array(o.length+g).fill(" ");return[Ye.selectedLine,d.join(" "),[...p,...f,...h].join("")].join(" ")+`
`}function v_(t,e){const n=e.anchor,o=e.focus,r=t.getTextContent(!0),s=r.length;let i=-1,l=-1;if(n.type==="text"&&o.type==="text"){const u=n.getNode(),d=o.getNode();u===d&&t===u&&n.offset!==o.offset?[i,l]=n.offset<o.offset?[n.offset,o.offset]:[o.offset,n.offset]:t===u?[i,l]=u.isBefore(d)?[n.offset,s]:[0,n.offset]:t===d?[i,l]=d.isBefore(u)?[o.offset,s]:[0,o.offset]:[i,l]=[0,s]}const a=(r.slice(0,i).match(cl)||[]).length,c=(r.slice(i,l).match(cl)||[]).length;return[i+a,l+a+c]}function D_(){const[t]=$();return m(p_,{viewClassName:"tree-view-output",timeTravelPanelClassName:"debug-timetravel-panel",timeTravelButtonClassName:"debug-timetravel-button",timeTravelPanelSliderClassName:"debug-timetravel-panel-slider",timeTravelPanelButtonClassName:"debug-timetravel-panel-button",editor:t})}function L_({ariaActiveDescendantID:t,ariaAutoComplete:e,ariaControls:n,ariaDescribedBy:o,ariaExpanded:r,ariaLabel:s,ariaLabelledBy:i,ariaMultiline:l,ariaOwneeID:a,ariaRequired:c,autoCapitalize:u,autoComplete:d,autoCorrect:f,className:h,id:g,role:p="textbox",spellCheck:_=!0,style:C,tabIndex:x,testid:E}){const[N]=$(),[k,D]=y.exports.useState(!0),A=y.exports.useCallback(L=>{N.setRootElement(L)},[N]);return Qe(()=>(D(N.isReadOnly()),N.registerReadOnlyListener(L=>{D(L)})),[N]),m("div",{"aria-activedescendant":k?null:t,"aria-autocomplete":k?null:e,"aria-controls":k?null:n,"aria-describedby":o,"aria-expanded":k?null:p==="combobox"?!!r:null,"aria-label":s,"aria-labelledby":i,"aria-multiline":l,"aria-owns":k?null:a,"aria-required":c,autoCapitalize:u,autoComplete:d,autoCorrect:f,className:h,contentEditable:!k,"data-testid":E,id:g,ref:A,role:k?null:p,spellCheck:_,style:C,tabIndex:x})}function Io({className:t}){return m(L_,{className:t||"ContentEditable__root"})}function Ss({children:t,className:e}){return m("div",{className:e||"Placeholder__root",children:t})}const dl=new Set;function O_(t){if(!dl.has(t))throw new Promise(e=>{const n=new Image;n.src=t,n.onload=()=>{dl.add(t),e()}})}function A_({altText:t,className:e,imageRef:n,src:o,width:r,height:s,maxWidth:i}){return O_(o),m("img",{className:e,src:o,alt:t,ref:n,style:{height:s,maxWidth:i,width:r}})}function P_({src:t,altText:e,nodeKey:n,width:o,height:r,maxWidth:s,resizable:i,showCaption:l,caption:a}){const c=y.exports.useRef(null),[u,d,f]=ws(n),[h,g]=y.exports.useState(!1),{yjsDocMap:p}=jn(),[_]=$(),C=p.get("main")!==void 0,[x,E]=y.exports.useState(null),N=y.exports.useCallback(B=>(u&&Le(T())&&(B.preventDefault(),_.update(()=>{const q=M(n);_r(q)&&q.remove(),d(!1)})),!1),[_,u,n,d]);y.exports.useEffect(()=>ue(_.registerUpdateListener(({editorState:B})=>{E(B.read(()=>T()))}),_.registerCommand(In,B=>{const H=B;return h?!0:H.target===c.current?(H.shiftKey||f(),d(!u),!0):!1},J),_.registerCommand(Jt,N,J),_.registerCommand(vt,N,J)),[f,_,h,u,n,N,d]);const k=()=>{_.update(()=>{const B=M(n);_r(B)&&B.setShowCaption(!0)})},D=(B,H)=>{const q=_.getRootElement();q!==null&&q.style.setProperty("cursor","default"),setTimeout(()=>{g(!1)},200),_.update(()=>{const ne=M(n);_r(ne)&&ne.setWidthAndHeight(B,H)})},A=()=>{const B=_.getRootElement();B!==null&&B.style.setProperty("cursor","nwse-resize","important"),g(!0)},{historyState:L}=ds(),{settings:{showNestedEditorTreeView:R}}=cs();return m(y.exports.Suspense,{fallback:null,children:v(X,{children:[m(A_,{className:u||h?"focused":null,src:t,altText:e,imageRef:c,width:o,height:r,maxWidth:s}),l&&m("div",{className:"image-caption-container",children:v($c,{initialEditor:a,children:[m(f_,{}),m(Dc,{}),m(Gc,{}),m(Xc,{}),m(Va,{}),m(Mc,{}),m(qa,{}),m(Hc,{}),C?m(_s,{id:a.getKey(),providerFactory:Ts,shouldBootstrap:!0}):m(Oo,{externalHistoryState:L}),m(wc,{contentEditable:m(Io,{className:"ImageNode__contentEditable"}),placeholder:m(Ss,{className:"ImageNode__placeholder",children:"Enter a caption..."}),initialEditorState:null}),R&&m(D_,{})]})}),i&&Le(x)&&(u||h)&&m(Bc,{showCaption:l,setShowCaption:k,editor:_,imageRef:c,onResizeStart:A,onResizeEnd:D})]})})}class rn extends gt{static getType(){return"image"}static clone(e){return new rn(e.__src,e.__altText,e.__maxWidth,e.__width,e.__height,e.__showCaption,e.__caption,e.__key)}constructor(e,n,o,r,s,i,l,a){super(a);this.__src=e,this.__altText=n,this.__maxWidth=o,this.__width=r||"inherit",this.__height=s||"inherit",this.__showCaption=i||!1,this.__caption=l||Un()}setWidthAndHeight(e,n){const o=this.getWritable();o.__width=e,o.__height=n}setShowCaption(e){const n=this.getWritable();n.__showCaption=e}createDOM(e){const n=document.createElement("span"),r=e.theme.image;return r!==void 0&&(n.className=r),n}updateDOM(){return!1}decorate(){return m(P_,{src:this.__src,altText:this.__altText,width:this.__width,height:this.__height,maxWidth:this.__maxWidth,nodeKey:this.getKey(),showCaption:this.__showCaption,caption:this.__caption,resizable:!0})}}function F_(t,e,n){return new rn(t,e,n)}function _r(t){return t instanceof rn}const ks=I();function Xc(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([rn]))throw new Error("ImagesPlugin: ImageNode not registered on editor");return t.registerCommand(ks,e=>{const n=T();if(w(n)){V(n.anchor.getNode())&&n.insertParagraph();const o=F_(e.src,e.altText,500);n.insertNodes([o])}return!0},F)},[t]),null}function M_(t){const e=t.getNodes();return e.length===0?new Set([t.anchor.getNode().getParentOrThrow(),t.focus.getNode().getParentOrThrow()]):new Set(e.map(n=>S(n)?n:n.getParentOrThrow()))}function R_(t){const e=T();if(!w(e))return!1;const n=M_(e);let o=0;for(const r of n)if(G(r))o=Math.max(Pr(r)+1,o);else if(te(r)){const s=r.getParent();if(!G(s))throw new Error("ListMaxIndentLevelPlugin: A ListItemNode must have a ListNode for a parent.");o=Math.max(Pr(s)+1,o)}return o<=t}function I_({maxDepth:t}){const[e]=$();return y.exports.useEffect(()=>e.registerCommand(ut,()=>!R_(t!=null?t:7),me),[e,t]),null}function B_(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function $r(t=""){return{text:t,uid:B_(),votes:[]}}function fl(t,e,n){return{text:e,uid:t.uid,votes:n||Array.from(t.votes)}}function K_(t){return t.reduce((e,n)=>e+n.votes.length,0)}function $_({option:t,index:e,options:n,totalVotes:o,withPollNode:r}){const{clientID:s}=jn(),i=y.exports.useRef(null),l=t.votes,c=l.indexOf(s)!==-1,u=l.length,d=t.text;return v("div",{className:"PollNode__optionContainer",children:[m("div",{className:Kr("PollNode__optionCheckboxWrapper",c&&"PollNode__optionCheckboxChecked"),children:m("input",{ref:i,className:"PollNode__optionCheckbox",type:"checkbox",onChange:f=>{r(h=>{h.toggleVote(t,s)})},checked:c})}),v("div",{className:"PollNode__optionInputWrapper",children:[m("div",{className:"PollNode__optionInputVotes",style:{width:`${u===0?0:u/o*100}%`}}),m("span",{className:"PollNode__optionInputVotesCount",children:u>0&&(u===1?"1 vote":`${u} votes`)}),m("input",{className:"PollNode__optionInput",type:"text",value:d,onChange:f=>{r(h=>{h.setOptionText(t,f.target.value)})},placeholder:`Option ${e+1}`})]}),m("button",{disabled:n.length<3,className:Kr("PollNode__optionDelete",n.length<3&&"PollNode__optionDeleteDisabled"),"arial-label":"Remove",onClick:()=>{r(f=>{f.deleteOption(t)})}})]})}function H_({question:t,options:e,nodeKey:n}){const[o]=$(),r=y.exports.useMemo(()=>K_(e),[e]),s=y.exports.useCallback(l=>{o.update(()=>{const a=M(n);W_(a)&&l(a)})},[o,n]),i=y.exports.useCallback(()=>{s(l=>{l.addOption($r())})},[s]);return v("div",{className:"PollNode__container",children:[m("h2",{className:"PollNode__heading",children:t}),e.map((l,a)=>{const c=l.uid;return m($_,{withPollNode:s,option:l,index:a,options:e,totalVotes:r},c)}),m("div",{className:"PollNode__footer",children:m(De,{onClick:i,small:!0,children:"Add Option"})})]})}class sn extends gt{static getType(){return"poll"}static clone(e){return new sn(e.__question,e.__options,e.__key)}constructor(e,n,o){super(o);this.__question=e,this.__options=n||[$r(),$r()]}addOption(e){const n=this.getWritable(),o=Array.from(n.__options);o.push(e),n.__options=o}deleteOption(e){const n=this.getWritable(),o=Array.from(n.__options),r=o.indexOf(e);o.splice(r,1),n.__options=o}setOptionText(e,n){const o=this.getWritable(),r=fl(e,n),s=Array.from(o.__options),i=s.indexOf(e);s[i]=r,o.__options=s}toggleVote(e,n){const o=this.getWritable(),r=e.votes,s=Array.from(r),i=r.indexOf(n);i===-1?s.push(n):s.splice(i,1);const l=fl(e,e.text,s),a=Array.from(o.__options),c=a.indexOf(e);a[c]=l,o.__options=a}createDOM(){const e=document.createElement("span");return e.style.display="inline-block",e}updateDOM(){return!1}decorate(){return m(H_,{question:this.__question,options:this.__options,nodeKey:this.__key})}}function z_(t){return new sn(t)}function W_(t){return t instanceof sn}const Jc=I();function U_(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([sn]))throw new Error("PollPlugin: PollNode not registered on editor");return t.registerCommand(Jc,e=>{const n=T();if(w(n)){const r=z_(e);V(n.anchor.getNode())&&n.insertParagraph(),n.insertNodes([r])}return!0},F)},[t]),null}const j_=33,G_=50;function Y_({editor:t}){const e=y.exports.useRef(null),n=y.exports.useRef(null),o=y.exports.useRef(null),r=y.exports.useRef(null),[s,i]=y.exports.useState(null),[l,a]=y.exports.useState(null),[c,u]=y.exports.useState(!1),[d,f]=y.exports.useState(null);y.exports.useEffect(()=>t.registerUpdateListener(({editorState:N})=>{N.read(()=>{const k=T(),D=Z(k);c!==D&&u(D)})}));const h=y.exports.useCallback(()=>{a(null),e.current=null,f(null),r.current=null,o.current=null},[]);y.exports.useEffect(()=>{const N=k=>{setTimeout(()=>{const D=k.target;if(d){i({x:k.clientX,y:k.clientY});return}if(!(n.current&&n.current.contains(D))&&e.current!==D){e.current=D;const A=_o(D);A&&l!==A?t.update(()=>{const L=Me(A.elem);if(!L)throw new Error("TableCellResizer: Table cell node not found.");const R=ke(L),B=t.getElementByKey(R.getKey());if(!B)throw new Error("TableCellResizer: Table element not found.");e.current=D,o.current=B.getBoundingClientRect(),a(A)}):A==null&&h()}},0)};return document.addEventListener("mousemove",N),()=>{document.removeEventListener("mousemove",N)}},[l,d,t,h]);const g=N=>N==="bottom",p=y.exports.useCallback(N=>{if(!l)throw new Error("TableCellResizer: Expected active cell.");t.update(()=>{const k=Me(l.elem);if(!W(k))throw new Error("TableCellResizer: Table cell node not found.");const D=ke(k),A=yo(k),L=D.getChildren();if(A>=L.length||A<0)throw new Error("Expected table cell to be inside of table row.");const R=L[A];if(!Xe(R))throw new Error("Expected table row");R.setHeight(N)})},[l,t]),_=y.exports.useCallback(N=>{if(!l)throw new Error("TableCellResizer: Expected active cell.");t.update(()=>{const k=Me(l.elem);if(!W(k))throw new Error("TableCellResizer: Table cell node not found.");const D=ke(k),A=Co(k),L=D.getChildren();for(let R=0;R<L.length;R++){const B=L[R];if(!Xe(B))throw new Error("Expected table row");const H=B.getChildren();if(A>=H.length||A<0)throw new Error("Expected table cell to be inside of table row.");const q=H[A];if(!W(q))throw new Error("Expected table cell");q.setWidth(N)}})},[l,t]),C=y.exports.useCallback(N=>k=>{if(k.preventDefault(),k.stopPropagation(),!l)throw new Error("TableCellResizer: Expected active cell.");if(d===N&&r.current){const{x:D,y:A}=r.current;if(!l)return;const{height:L,width:R}=l.elem.getBoundingClientRect();if(g(N)){const B=Math.abs(k.clientY-A),H=N==="bottom"&&A>k.clientY;p(Math.max(H?L-B:B+L,j_))}else{const B=Math.abs(k.clientX-D),H=N==="right"&&D>k.clientX;_(Math.max(H?R-B:B+R,G_))}h()}else r.current={x:k.clientX,y:k.clientY},i(r.current),f(N)},[l,d,h,_,p]),E=y.exports.useCallback(()=>{if(l){const{height:N,width:k,top:D,left:A}=l.elem.getBoundingClientRect(),L={bottom:{backgroundColor:"none",cursor:"row-resize",height:"10px",left:`${window.pageXOffset+A}px`,top:`${window.pageYOffset+D+N}px`,width:`${k}px`},right:{backgroundColor:"none",cursor:"col-resize",height:`${N}px`,left:`${window.pageXOffset+A+k}px`,top:`${window.pageYOffset+D}px`,width:"10px"}},R=o.current;return d&&s&&R&&(g(d)?(L[d].left=`${window.pageXOffset+R.left}px`,L[d].top=`${window.pageYOffset+s.y}px`,L[d].height="3px",L[d].width=`${R.width}px`):(L[d].top=`${window.pageYOffset+R.top}px`,L[d].left=`${window.pageXOffset+s.x}px`,L[d].width="3px",L[d].height=`${R.height}px`),L[d].backgroundColor="#adf"),L}return{bottom:null,left:null,right:null,top:null}},[l,d,s])();return m("div",{ref:n,children:l!=null&&!c&&v(X,{children:[m("div",{className:"TableCellResizer__resizer TableCellResizer__ui",style:E.right,onMouseDown:C("right"),onMouseUp:C("right")}),m("div",{className:"TableCellResizer__resizer TableCellResizer__ui",style:E.bottom,onMouseDown:C("bottom"),onMouseUp:C("bottom")})]})})}function q_(){const[t]=$();return y.exports.useMemo(()=>Ie.exports.createPortal(m(Y_,{editor:t}),document.body),[t])}var V_="/assets/cat-typing.29244fe9.gif",X_="/assets/yellow-flower.bf6d0400.jpg";const J_={characterLimit:"PlaygroundEditorTheme__characterLimit",code:"PlaygroundEditorTheme__code",codeHighlight:{atrule:"PlaygroundEditorTheme__tokenAttr",attr:"PlaygroundEditorTheme__tokenAttr",boolean:"PlaygroundEditorTheme__tokenProperty",builtin:"PlaygroundEditorTheme__tokenSelector",cdata:"PlaygroundEditorTheme__tokenComment",char:"PlaygroundEditorTheme__tokenSelector",class:"PlaygroundEditorTheme__tokenFunction","class-name":"PlaygroundEditorTheme__tokenFunction",comment:"PlaygroundEditorTheme__tokenComment",constant:"PlaygroundEditorTheme__tokenProperty",deleted:"PlaygroundEditorTheme__tokenProperty",doctype:"PlaygroundEditorTheme__tokenComment",entity:"PlaygroundEditorTheme__tokenOperator",function:"PlaygroundEditorTheme__tokenFunction",important:"PlaygroundEditorTheme__tokenVariable",inserted:"PlaygroundEditorTheme__tokenSelector",keyword:"PlaygroundEditorTheme__tokenAttr",namespace:"PlaygroundEditorTheme__tokenVariable",number:"PlaygroundEditorTheme__tokenProperty",operator:"PlaygroundEditorTheme__tokenOperator",prolog:"PlaygroundEditorTheme__tokenComment",property:"PlaygroundEditorTheme__tokenProperty",punctuation:"PlaygroundEditorTheme__tokenPunctuation",regex:"PlaygroundEditorTheme__tokenVariable",selector:"PlaygroundEditorTheme__tokenSelector",string:"PlaygroundEditorTheme__tokenSelector",symbol:"PlaygroundEditorTheme__tokenProperty",tag:"PlaygroundEditorTheme__tokenProperty",url:"PlaygroundEditorTheme__tokenOperator",variable:"PlaygroundEditorTheme__tokenVariable"},hashtag:"PlaygroundEditorTheme__hashtag",heading:{h1:"PlaygroundEditorTheme__h1",h2:"PlaygroundEditorTheme__h2",h3:"PlaygroundEditorTheme__h3",h4:"PlaygroundEditorTheme__h4",h5:"PlaygroundEditorTheme__h5"},image:"editor-image",link:"PlaygroundEditorTheme__link",list:{listitem:"PlaygroundEditorTheme__listItem",nested:{listitem:"PlaygroundEditorTheme__nestedListItem"},olDepth:["PlaygroundEditorTheme__ol1","PlaygroundEditorTheme__ol2","PlaygroundEditorTheme__ol3","PlaygroundEditorTheme__ol4","PlaygroundEditorTheme__ol5"],ul:"PlaygroundEditorTheme__ul"},ltr:"PlaygroundEditorTheme__ltr",paragraph:"PlaygroundEditorTheme__paragraph",quote:"PlaygroundEditorTheme__quote",rtl:"PlaygroundEditorTheme__rtl",table:"PlaygroundEditorTheme__table",tableCell:"PlaygroundEditorTheme__tableCell",tableCellHeader:"PlaygroundEditorTheme__tableCellHeader",text:{bold:"PlaygroundEditorTheme__textBold",code:"PlaygroundEditorTheme__textCode",italic:"PlaygroundEditorTheme__textItalic",strikethrough:"PlaygroundEditorTheme__textStrikethrough",underline:"PlaygroundEditorTheme__textUnderline",underlineStrikethrough:"PlaygroundEditorTheme__textUnderlineStrikethrough"}},Q_=j(z({},J_),{paragraph:"StickyEditorTheme__paragraph"});function ao(t,e){const n=t.style,o=e.rootElementRect,r=o!==null?o.left:0,s=o!==null?o.top:0;n.top=s+e.y+"px",n.left=r+e.x+"px"}function Z_({x:t,y:e,nodeKey:n,color:o,caption:r}){const[s]=$(),i=y.exports.useRef(null),l=y.exports.useRef({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:null,x:0,y:0}),{yjsDocMap:a}=jn(),c=a.get("main")!==void 0;y.exports.useEffect(()=>{const p=l.current;p.x=t,p.y=e;const _=i.current;_!==null&&ao(_,p)},[t,e]),Qe(()=>{const p=l.current,_=new ResizeObserver(E=>{for(let N=0;N<E.length;N++){const k=E[N],{target:D}=k;p.rootElementRect=D.getBoundingClientRect();const A=i.current;A!==null&&ao(A,p)}}),C=s.registerRootListener((E,N)=>{N!==null&&_.unobserve(N),E!==null&&_.observe(E)}),x=()=>{const E=s.getRootElement(),N=i.current;E!==null&&N!==null&&(p.rootElementRect=E.getBoundingClientRect(),ao(N,p))};return window.addEventListener("resize",x),()=>{window.removeEventListener("resize",x),C()}},[s]),y.exports.useEffect(()=>{const p=i.current;p!==null&&setTimeout(()=>{p.style.setProperty("transition","top 0.3s ease 0s, left 0.3s ease 0s")},500)},[]);const u=p=>{const _=i.current,C=l.current,x=C.rootElementRect;_!==null&&C.isDragging&&x!==null&&(C.x=p.pageX-C.offsetX-x.left,C.y=p.pageY-C.offsetY-x.top,ao(_,C))},d=p=>{const _=i.current,C=l.current;_!==null&&(C.isDragging=!1,_.classList.remove("dragging"),s.update(()=>{const x=M(n);xr(x)&&x.setPosition(C.x,C.y)})),document.removeEventListener("pointermove",u),document.removeEventListener("pointerup",d)},f=()=>{s.update(()=>{const p=M(n);xr(p)&&p.remove()})},h=()=>{s.update(()=>{const p=M(n);xr(p)&&p.toggleColor()})},{historyState:g}=ds();return v("div",{ref:i,className:`sticky-note ${o}`,onPointerDown:p=>{if(p.button===2||p.target!==i.current)return;const _=i.current,C=l.current;if(_!==null){const{top:x,left:E}=_.getBoundingClientRect();C.offsetX=p.clientX-E+30,C.offsetY=p.clientY-x+20,C.isDragging=!0,_.classList.add("dragging"),document.addEventListener("pointermove",u),document.addEventListener("pointerup",d),p.preventDefault()}},children:[m("button",{onClick:f,className:"delete",children:"X"}),m("button",{onClick:h,className:"color",children:m("i",{className:"bucket"})}),v($c,{initialEditor:r,initialTheme:Q_,children:[c?m(_s,{id:r.getKey(),providerFactory:Ts,shouldBootstrap:!0}):m(Oo,{externalHistoryState:g}),m(Tc,{contentEditable:m(Io,{className:"StickyNode__contentEditable"}),placeholder:m(Ss,{className:"StickyNode__placeholder",children:"What's up?"}),initialEditorState:null})]})]})}class Zn extends gt{static getType(){return"sticky"}static clone(e){return new Zn(e.__x,e.__y,e.__color,e.__caption,e.__key)}constructor(e,n,o,r,s){super(s);this.__x=e,this.__y=n,this.__caption=r||Un(),this.__color=o}createDOM(e){const n=document.createElement("div");return n.style.display="contents",n}updateDOM(){return!1}setPosition(e,n){const o=this.getWritable();o.__x=e,o.__y=n,ie(null)}toggleColor(){const e=this.getWritable();e.__color=e.__color==="pink"?"yellow":"pink"}decorate(e){return Ie.exports.createPortal(m(Z_,{color:this.__color,x:this.__x,y:this.__y,nodeKey:this.getKey(),caption:this.__caption}),document.body)}isIsolated(){return!0}}function xr(t){return t instanceof Zn}function ex(t,e){return new Zn(t,e,"yellow")}function Hr({buttonLabel:t,buttonAriaLabel:e,buttonClassName:n,buttonIconClassName:o,children:r}){const s=y.exports.useRef(null),i=y.exports.useRef(null),[l,a]=y.exports.useState(!1);return y.exports.useEffect(()=>{const c=i.current,u=s.current;if(l&&c!==null&&u!==null){const{top:d,left:f}=c.getBoundingClientRect();u.style.top=`${d+40}px`,u.style.left=`${Math.min(f,window.innerWidth-u.offsetWidth-20)}px`}},[s,i,l]),y.exports.useEffect(()=>{const c=i.current;if(c!==null&&l){const u=d=>{const f=d.target;c.contains(f)||a(!1)};return document.addEventListener("click",u),()=>{document.removeEventListener("click",u)}}},[s,i,l]),v(X,{children:[v("button",{"aria-label":e||t,className:n,onClick:()=>a(!l),ref:i,children:[o&&m("span",{className:o}),t&&m("span",{className:"text dropdown-button-text",children:t}),m("i",{className:"chevron-down"})]}),l&&Ie.exports.createPortal(m("div",{className:"dropdown",ref:s,children:r}),document.body)]})}function tx({accept:t,label:e,onChange:n,"data-test-id":o}){return v("div",{className:"Input__wrapper",children:[m("label",{className:"Input__label",children:e}),m("input",{type:"file",accept:t,className:"Input__input",onChange:r=>n(r.target.files),"data-test-id":o})]})}function nx({onConfirm:t,initialEquation:e=""}){const[n,o]=y.exports.useState(e),[r,s]=y.exports.useState(!0),i=y.exports.useCallback(()=>{t(n,r)},[t,n,r]),l=y.exports.useCallback(()=>{s(!r)},[s,r]);return v(X,{children:[v("div",{className:"KatexEquationAlterer_defaultRow",children:["Inline",m("input",{type:"checkbox",checked:r,onChange:l})]}),m("div",{className:"KatexEquationAlterer_defaultRow",children:"Equation "}),m("div",{className:"KatexEquationAlterer_centerRow",children:r?m("input",{onChange:a=>{o(a.target.value)},value:n,className:"KatexEquationAlterer_textArea"}):m("textarea",{onChange:a=>{o(a.target.value)},value:n,className:"KatexEquationAlterer_textArea"})}),m("div",{className:"KatexEquationAlterer_defaultRow",children:"Visualization "}),m("div",{className:"KatexEquationAlterer_centerRow",children:m(Rc,{equation:n,inline:!1,onClick:()=>{}})}),m("div",{className:"KatexEquationAlterer_dialogActions",children:m(De,{onClick:i,children:"Confirm"})})]})}const co={},ox=/((https?:\/\/(www\.)?)|(www\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;function rx(t){let e=co[t];if(!t.match(ox))return{preview:null};if(e||(e=co[t]=fetch(`/api/link-preview?url=${encodeURI(t)}`).then(n=>n.json()).then(n=>(co[t]=n,n)).catch(()=>{co[t]={preview:null}})),e instanceof Promise)throw e;return e}function sx({url:t}){const{preview:e}=rx(t);return e===null?null:v("div",{className:"LinkPreview__container",children:[e.img&&m("div",{className:"LinkPreview__imageWrapper",children:m("img",{src:e.img,alt:e.title,className:"LinkPreview__image"})}),e.domain&&m("div",{className:"LinkPreview__domain",children:e.domain}),e.title&&m("div",{className:"LinkPreview__title",children:e.title}),e.description&&m("div",{className:"LinkPreview__description",children:e.description})]})}function yr(t){return m("div",j(z({className:"LinkPreview__glimmer"},t),{style:z({animationDelay:(t.index||0)*300},t.style||{})}))}function ix({url:t}){return m(y.exports.Suspense,{fallback:v(X,{children:[m(yr,{style:{height:"80px"},index:0}),m(yr,{style:{width:"60%"},index:1}),m(yr,{style:{width:"80%"},index:2})]}),children:m(sx,{url:t})})}function ft({label:t,value:e,onChange:n,placeholder:o="","data-test-id":r}){return v("div",{className:"Input__wrapper",children:[m("label",{className:"Input__label",children:t}),m("input",{type:"text",className:"Input__input",placeholder:o,value:e,onChange:s=>{n(s.target.value)},"data-test-id":r})]})}class vs extends gt{constructor(e,n){super(n);this.__format=e}createDOM(){return document.createElement("div")}updateDOM(){return!1}setFormat(e){const n=this.getWritable();n.__format=e}}function hl(t){return t instanceof vs}function Qc({children:t,format:e,nodeKey:n}){const[o]=$(),[r,s,i]=ws(n),l=y.exports.useRef(),a=y.exports.useCallback(c=>(r&&Le(T())&&(c.preventDefault(),o.update(()=>{const d=M(n);re(d)&&d.isTopLevel()&&d.remove(),s(!1)})),!1),[o,r,n,s]);return y.exports.useEffect(()=>ue(o.registerCommand(Mt,c=>{if(r){const u=T();if(Le(u)){const d=M(n);hl(d)&&d.setFormat(c)}else if(w(u)){const d=u.getNodes();for(const f of d)hl(f)?f.setFormat(c):pn(f).setFormat(c)}return!0}return!1},J),o.registerCommand(In,c=>{const u=c;return u.preventDefault(),u.target===l.current?(u.shiftKey||i(),s(!r),!0):!1},J),o.registerCommand(Jt,a,J),o.registerCommand(vt,a,J)),[i,o,r,n,a,s]),m("div",{className:`embed-block${r?" focused":""}`,ref:l,style:{textAlign:e},children:t})}const Zc="https://platform.twitter.com/widgets.js",lx=()=>document.querySelector(`script[src="${Zc}"]`);function ax({format:t,loadingComponent:e,nodeKey:n,onError:o,onLoad:r,tweetID:s}){const i=y.exports.useRef(null),l=y.exports.useRef(null),[a,c]=y.exports.useState(!1),u=y.exports.useCallback(async()=>{try{await window.twttr.widgets.createTweet(s,i.current),c(!1),r&&r()}catch(d){o&&o(d)}},[o,r,s]);return y.exports.useEffect(()=>{var d;if(s!==l.current){if(c(!0),lx())u();else{const f=document.createElement("script");f.src=Zc,f.async=!0,(d=document.body)==null||d.appendChild(f),f.onload=u,f.onerror=o}l.current=s}},[u,o,s]),v(Qc,{format:t,nodeKey:n,children:[a?e:null,m("div",{style:{display:"inline-block",width:"550px"},ref:i})]})}class eo extends vs{static getType(){return"tweet"}static clone(e){return new eo(e.__id,e.__format,e.__key)}constructor(e,n,o){super(n,o);this.__id=e}decorate(){return m(ax,{format:this.__format,loadingComponent:"Loading...",nodeKey:this.getKey(),tweetID:this.__id})}}function cx(t){return new eo(t)}const eu=I();function ux(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([eo]))throw new Error("TwitterPlugin: TweetNode not registered on editor");return t.registerCommand(eu,e=>{const n=T();if(w(n)&&n.focus.getNode()!==null){const r=cx(e);n.focus.getNode().getTopLevelElementOrThrow().insertAfter(r);const s=U();r.insertAfter(s),s.select()}return!0},F)},[t]),null}function dx({format:t,nodeKey:e,videoID:n}){return m(Qc,{format:t,nodeKey:e,children:m("iframe",{width:"560",height:"315",src:`https://www.youtube.com/embed/${n}`,frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,title:"YouTube video"})})}class to extends vs{static getType(){return"youtube"}static clone(e){return new to(e.__id,e.__format,e.__key)}constructor(e,n,o){super(n,o);this.__id=e}updateDOM(){return!1}decorate(){return m(dx,{format:this.__format,nodeKey:this.getKey(),videoID:this.__id})}}function fx(t){return new to(t)}const tu=I();function hx(){const[t]=$();return y.exports.useEffect(()=>{if(!t.hasNodes([to]))throw new Error("YouTubePlugin: YouTubeNode not registered on editor");return t.registerCommand(tu,e=>{const n=T();if(w(n)&&n.focus.getNode()!==null){const r=fx(e);n.focus.getNode().getTopLevelElementOrThrow().insertAfter(r);const s=U();r.insertAfter(s),s.select()}return!0},F)},[t]),null}const gx=new Set(["paragraph","quote","code","h1","h2","h3","ul","ol"]),px={code:"Code Block",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",ol:"Numbered List",paragraph:"Normal",quote:"Quote",ul:"Bulleted List"},mx=[["","- Select language -"],["c","C"],["clike","C-like"],["css","CSS"],["html","HTML"],["js","JavaScript"],["markdown","Markdown"],["objc","Objective-C"],["plain","Plain Text"],["py","Python"],["rust","Rust"],["sql","SQL"],["swift","Swift"],["xml","XML"]],_x={javascript:"js",md:"markdown",plaintext:"plain",python:"py",text:"plain"};function nu(t){const e=t.anchor,n=t.focus,o=t.anchor.getNode(),r=t.focus.getNode();return o===r?o:t.isBackward()?qi(n)?o:r:qi(e)?r:o}function gl(t,e){e===null?(t.style.opacity="0",t.style.top="-1000px",t.style.left="-1000px"):(t.style.opacity="1",t.style.top=`${e.top+e.height+window.pageYOffset+10}px`,t.style.left=`${e.left+window.pageXOffset-t.offsetWidth/2+e.width/2}px`)}function xx({editor:t}){const e=y.exports.useRef(null),n=y.exports.useRef(null),o=y.exports.useRef(!1),[r,s]=y.exports.useState(""),[i,l]=y.exports.useState(!1),[a,c]=y.exports.useState(null),u=y.exports.useCallback(()=>{const d=T();if(w(d)){const _=nu(d),C=_.getParent();Pe(C)?s(C.getURL()):Pe(_)?s(_.getURL()):s("")}const f=e.current,h=window.getSelection(),g=document.activeElement;if(f===null)return;const p=t.getRootElement();if(d!==null&&!h.isCollapsed&&p!==null&&p.contains(h.anchorNode)){const _=h.getRangeAt(0);let C;if(h.anchorNode===p){let x=p;for(;x.firstElementChild!=null;)x=x.firstElementChild;C=x.getBoundingClientRect()}else C=_.getBoundingClientRect();o.current||gl(f,C),c(d)}else(!g||g.className!=="link-input")&&(gl(f,null),c(null),l(!1),s(""));return!0},[t]);return y.exports.useEffect(()=>ue(t.registerUpdateListener(({editorState:d})=>{d.read(()=>{u()})}),t.registerCommand(nt,()=>(u(),!0),J)),[t,u]),y.exports.useEffect(()=>{t.getEditorState().read(()=>{u()})},[t,u]),y.exports.useEffect(()=>{i&&n.current&&n.current.focus()},[i]),m("div",{ref:e,className:"link-editor",children:i?m("input",{ref:n,className:"link-input",value:r,onChange:d=>{s(d.target.value)},onKeyDown:d=>{d.key==="Enter"?(d.preventDefault(),a!==null&&(r!==""&&t.dispatchCommand(xt,r),l(!1))):d.key==="Escape"&&(d.preventDefault(),l(!1))}}):v(X,{children:[v("div",{className:"link-input",children:[m("a",{href:r,target:"_blank",rel:"noopener noreferrer",children:r}),m("div",{className:"link-edit",role:"button",tabIndex:0,onMouseDown:d=>d.preventDefault(),onClick:()=>{l(!0)}})]}),m(ix,{url:r})]})})}function yx({onClick:t}){const[e,n]=y.exports.useState(""),[o,r]=y.exports.useState("");return v(X,{children:[m(ft,{label:"Image URL",placeholder:"i.e. https://source.unsplash.com/random",onChange:n,value:e,"data-test-id":"image-modal-url-input"}),m(ft,{label:"Alt Text",placeholder:"Random unsplash image",onChange:r,value:o,"data-test-id":"image-modal-alt-text-input"}),m("div",{className:"ToolbarPlugin__dialogActions",children:m(De,{"data-test-id":"image-modal-confirm-btn",disabled:e==="",onClick:()=>t({altText:o,src:e}),children:"Confirm"})})]})}function Cx({onClick:t}){const[e,n]=y.exports.useState(""),[o,r]=y.exports.useState("");return v(X,{children:[m(tx,{label:"Image Upload",onChange:l=>{const a=new FileReader;a.onload=function(){return typeof a.result=="string"&&n(a.result),""},a.readAsDataURL(l[0])},accept:"image/*","data-test-id":"image-modal-file-upload"}),m(ft,{label:"Alt Text",placeholder:"Descriptive alternative text",onChange:r,value:o,"data-test-id":"image-modal-alt-text-input"}),m("div",{className:"ToolbarPlugin__dialogActions",children:m(De,{"data-test-id":"image-modal-file-upload-btn",disabled:e==="",onClick:()=>t({altText:o,src:e}),children:"Confirm"})})]})}function pl({activeEditor:t,onClose:e}){const[n,o]=y.exports.useState(null),r=s=>{t.dispatchCommand(ks,s),e()};return v(X,{children:[!n&&v("div",{className:"ToolbarPlugin__dialogButtonsList",children:[m(De,{"data-test-id":"image-modal-option-sample",onClick:()=>r({altText:"Yellow flower in tilt shift lens",src:X_}),children:"Sample"}),m(De,{"data-test-id":"image-modal-option-url",onClick:()=>o("url"),children:"URL"}),m(De,{"data-test-id":"image-modal-option-file",onClick:()=>o("file"),children:"File"})]}),n==="url"&&m(yx,{onClick:r}),n==="file"&&m(Cx,{onClick:r})]})}function ml({activeEditor:t,onClose:e}){const[n,o]=y.exports.useState("5"),[r,s]=y.exports.useState("5");return v(X,{children:[m(ft,{label:"No of rows",onChange:o,value:n}),m(ft,{label:"No of columns",onChange:s,value:r}),m("div",{className:"ToolbarPlugin__dialogActions","data-test-id":"table-model-confirm-insert",children:m(De,{onClick:()=>{t.dispatchCommand(vc,{columns:r,rows:n}),e()},children:"Confirm"})})]})}function Ex({activeEditor:t,onClose:e}){const[n,o]=y.exports.useState(""),r=()=>{t.dispatchCommand(Jc,n),e()};return v(X,{children:[m(ft,{label:"Question",onChange:o,value:n}),m("div",{className:"ToolbarPlugin__dialogActions",children:m(De,{disabled:n.trim()==="",onClick:r,children:"Confirm"})})]})}const Nx=/twitter.com\/[0-9a-zA-Z]{1,20}\/status\/([0-9]*)/g;function Tx({activeEditor:t,onClose:e}){const[n,o]=y.exports.useState(""),r=()=>{var l,a,c;const i=(c=(a=(l=n.split("status/"))==null?void 0:l[1])==null?void 0:a.split("?"))==null?void 0:c[0];t.dispatchCommand(eu,i),e()},s=n===""||!n.match(Nx);return v(X,{children:[m(ft,{label:"Tweet URL",placeholder:"i.e. https://twitter.com/jack/status/20",onChange:o,value:n}),m("div",{className:"ToolbarPlugin__dialogActions",children:m(De,{disabled:s,onClick:r,children:"Confirm"})})]})}const wx=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,_l=t=>{const e=t.match(wx);return(e==null?void 0:e[2].length)===11?e[2]:null};function bx({activeEditor:t,onClose:e}){const[n,o]=y.exports.useState(""),r=()=>{const i=_l(n);i&&t.dispatchCommand(tu,i),e()},s=n===""||!_l(n);return v(X,{children:[m(ft,{"data-test-id":"youtube-embed-modal-url",label:"YouTube URL",placeholder:"i.e. https://www.youtube.com/watch?v=jNQXAC9IVRw",onChange:o,value:n}),m("div",{className:"ToolbarPlugin__dialogActions",children:m(De,{"data-test-id":"youtube-embed-modal-submit-btn",disabled:s,onClick:r,children:"Confirm"})})]})}function xl({activeEditor:t,onClose:e}){const n=y.exports.useCallback((o,r)=>{t.dispatchCommand(Ic,{equation:o,inline:r}),e()},[t,e]);return m(nx,{onConfirm:n})}function Sx({editor:t,blockType:e}){const n=()=>{e!=="paragraph"&&t.update(()=>{const a=T();w(a)&&tt(a,()=>U())})},o=a=>{e!==a&&t.update(()=>{const c=T();w(c)&&tt(c,()=>Ge(a))})},r=()=>{e!=="ul"?t.dispatchCommand(Ia):t.dispatchCommand(Mr)},s=()=>{e!=="ol"?t.dispatchCommand(Ba):t.dispatchCommand(Mr)},i=()=>{e!=="quote"&&t.update(()=>{const a=T();w(a)&&tt(a,()=>Jo())})},l=()=>{e!=="code"&&t.update(()=>{const a=T();if(w(a))if(a.isCollapsed())tt(a,()=>ot());else{const c=a.getTextContent(),u=ot();a.removeText(),a.insertNodes([u]),a.insertRawText(c)}})};return v(Hr,{buttonClassName:"toolbar-item block-controls",buttonIconClassName:"icon block-type "+e,buttonLabel:px[e],buttonAriaLabel:"Formatting options for text style",children:[v("button",{className:"item",onClick:n,children:[m("span",{className:"icon paragraph"}),m("span",{className:"text",children:"Normal"}),e==="paragraph"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:()=>o("h1"),children:[m("span",{className:"icon h1"}),m("span",{className:"text",children:"Heading 1"}),e==="h1"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:()=>o("h2"),children:[m("span",{className:"icon h2"}),m("span",{className:"text",children:"Heading 2"}),e==="h2"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:()=>o("h3"),children:[m("span",{className:"icon h3"}),m("span",{className:"text",children:"Heading 3"}),e==="h3"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:r,children:[m("span",{className:"icon bullet-list"}),m("span",{className:"text",children:"Bullet List"}),e==="ul"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:s,children:[m("span",{className:"icon numbered-list"}),m("span",{className:"text",children:"Numbered List"}),e==="ol"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:i,children:[m("span",{className:"icon quote"}),m("span",{className:"text",children:"Quote"}),e==="quote"&&m("span",{className:"active"})]}),v("button",{className:"item",onClick:l,children:[m("span",{className:"icon code"}),m("span",{className:"text",children:"Code Block"}),e==="code"&&m("span",{className:"active"})]})]})}function Pt(){return m("div",{className:"divider"})}function Cr({onChange:t,className:e,options:n,value:o}){return m("select",{className:e,onChange:t,value:o,children:n.map(([r,s])=>m("option",{value:r,children:s},r))})}function kx(){const[t]=$(),[e,n]=y.exports.useState(t),[o,r]=y.exports.useState("paragraph"),[s,i]=y.exports.useState(null),[l,a]=y.exports.useState("15px"),[c,u]=y.exports.useState("Arial"),[d,f]=y.exports.useState(!1),[h,g]=y.exports.useState(!1),[p,_]=y.exports.useState(!1),[C,x]=y.exports.useState(!1),[E,N]=y.exports.useState(!1),[k,D]=y.exports.useState(!1),[A,L]=y.exports.useState(!1),[R,B]=y.exports.useState(!1),[H,q]=em(),[ne,Q]=y.exports.useState(!1),[oe,He]=y.exports.useState(""),de=y.exports.useCallback(()=>{const O=T();if(w(O)){const pe=O.anchor.getNode(),ze=pe.getKey()==="root"?pe:pe.getTopLevelElementOrThrow(),Ds=ze.getKey(),su=e.getElementByKey(Ds);g(O.hasFormat("bold")),_(O.hasFormat("italic")),x(O.hasFormat("underline")),N(O.hasFormat("strikethrough")),D(O.hasFormat("code")),Q(tc(O));const Ls=nu(O),iu=Ls.getParent();if(Pe(iu)||Pe(Ls)?f(!0):f(!1),su!==null)if(i(Ds),G(ze)){const no=va(pe,Zt),un=no?no.getTag():ze.getTag();r(un)}else{const no=ac(ze)?ze.getTag():ze.getType();if(r(no),Fn(ze)){const un=ze.getLanguage();He(un?_x[un]||un:"");return}}a(Gi(O,"font-size","15px")),u(Gi(O,"font-family","Arial"))}},[e]);y.exports.useEffect(()=>t.registerCommand(nt,(O,pe)=>(de(),n(pe),!1),me),[t,de]),y.exports.useEffect(()=>ue(e.registerUpdateListener(({editorState:O})=>{O.read(()=>{de()})}),e.registerCommand(Uo,O=>(L(O),!1),me),e.registerCommand(ns,O=>(B(O),!1),me)),[e,de]);const ee=y.exports.useCallback(O=>{e.update(()=>{const pe=T();w(pe)&&ag(pe,O)})},[e]),At=y.exports.useCallback(O=>{ee({"font-size":O.target.value})},[ee]),ln=y.exports.useCallback(O=>{ee({"font-family":O.target.value})},[ee]),an=y.exports.useCallback(()=>{d?t.dispatchCommand(xt,null):t.dispatchCommand(xt,"https://")},[t,d]),cn=y.exports.useCallback(O=>{e.update(()=>{if(s!==null){const pe=M(s);Fn(pe)&&pe.setLanguage(O.target.value)}})},[e,s]),ru=O=>{e.dispatchCommand(ks,O)};return document.editorHandle=t,document.sayHello=()=>{console.log("hello")},document.formatBold=()=>{t.dispatchCommand(he,"bold")},document.formatItalic=()=>{t.dispatchCommand(he,"italic")},document.formatUnderline=()=>{t.dispatchCommand(he,"underline")},document.formatCodeInline=()=>{e.dispatchCommand(he,"code")},document.formatParagraph=()=>{o!=="paragraph"&&t.update(()=>{const O=T();w(O)&&tt(O,()=>U())})},document.formatHeading1=()=>{o!=="h1"&&t.update(()=>{const O=T();w(O)&&tt(O,()=>Ge("h1"))})},document.formatHeading2=()=>{o!=="h2"&&t.update(()=>{const O=T();w(O)&&tt(O,()=>Ge("h2"))})},document.formatQuote=()=>{o!=="quote"&&t.update(()=>{const O=T();w(O)&&tt(O,()=>Jo())})},document.formatCodeBlock=()=>{o!=="code"&&t.update(()=>{const O=T();if(w(O))if(O.isCollapsed())tt(O,()=>ot());else{const pe=O.getTextContent(),ze=ot();ze.setLanguage("clike"),O.removeText(),O.insertNodes([ze]),O.insertRawText(pe)}})},document.toggleLink=()=>{d?t.dispatchCommand(xt,null):t.dispatchCommand(xt,"https://")},document.tableButtonRef=y.exports.useRef(2),document.tableButtonObject=()=>m("button",{ref:document.tableButtonRef,className:"item",onClick:()=>{q("Insert Table",O=>m(ml,{activeEditor:e,onClose:O}))},children:"table"}),document.imageButtonRef=y.exports.useRef(3),document.imageButtonObject=()=>m("button",{ref:document.imageButtonRef,className:"item",onClick:()=>{q("Insert Image",O=>m(pl,{activeEditor:e,onClose:O}))},children:"img"}),document.equationButtonRef=y.exports.useRef(4),document.equationButtonObject=()=>m("button",{ref:document.equationButtonRef,className:"item",onClick:()=>{q("Insert Equation",O=>m(xl,{activeEditor:e,onClose:O}))},children:"equ"}),v("div",{className:"toolbar",style:{display:"none"},children:[document.tableButtonObject(),document.imageButtonObject(),document.equationButtonObject(),m("button",{disabled:!A,onClick:()=>{e.dispatchCommand(Vt)},title:ge?"Undo (\u2318Z)":"Undo (Ctrl+Z)",className:"toolbar-item spaced","aria-label":"Undo",children:m("i",{className:"format undo"})}),m("button",{disabled:!R,onClick:()=>{e.dispatchCommand(Xt)},title:ge?"Redo (\u2318Y)":"Undo (Ctrl+Y)",className:"toolbar-item","aria-label":"Redo",children:m("i",{className:"format redo"})}),m(Pt,{}),gx.has(o)&&e===t&&v(X,{children:[m(Sx,{blockType:o,editor:t}),m(Pt,{})]}),o==="code"?v(X,{children:[m(Cr,{className:"toolbar-item code-language",onChange:cn,options:mx,value:oe}),m("i",{className:"chevron-down inside"})]}):v(X,{children:[v(X,{children:[m(Cr,{className:"toolbar-item font-family",onChange:ln,options:[["Arial","Arial"],["Courier New","Courier New"],["Georgia","Georgia"],["Times New Roman","Times New Roman"],["Trebuchet MS","Trebuchet MS"],["Verdana","Verdana"]],value:c}),m("i",{className:"chevron-down inside"})]}),v(X,{children:[m(Cr,{className:"toolbar-item font-size",onChange:At,options:[["10px","10px"],["11px","11px"],["12px","12px"],["13px","13px"],["14px","14px"],["15px","15px"],["16px","16px"],["17px","17px"],["18px","18px"],["19px","19px"],["20px","20px"]],value:l}),m("i",{className:"chevron-down inside"})]}),m(Pt,{}),m("button",{onClick:()=>{e.dispatchCommand(he,"bold")},className:"toolbar-item spaced "+(h?"active":""),title:ge?"Bold (\u2318B)":"Bold (Ctrl+B)","aria-label":`Format text as bold. Shortcut: ${ge?"\u2318B":"Ctrl+B"}`,children:m("i",{className:"format bold"})}),m("button",{onClick:()=>{e.dispatchCommand(he,"italic")},className:"toolbar-item spaced "+(p?"active":""),title:ge?"Italic (\u2318I)":"Italic (Ctrl+I)","aria-label":`Format text as italics. Shortcut: ${ge?"\u2318I":"Ctrl+I"}`,children:m("i",{className:"format italic"})}),m("button",{onClick:()=>{e.dispatchCommand(he,"underline")},className:"toolbar-item spaced "+(C?"active":""),title:ge?"Underline (\u2318U)":"Underline (Ctrl+U)","aria-label":`Format text to underlined. Shortcut: ${ge?"\u2318U":"Ctrl+U"}`,children:m("i",{className:"format underline"})}),m("button",{onClick:()=>{e.dispatchCommand(he,"strikethrough")},className:"toolbar-item spaced "+(E?"active":""),title:"Strikethrough","aria-label":"Format text with a strikethrough",children:m("i",{className:"format strikethrough"})}),m("button",{onClick:()=>{e.dispatchCommand(he,"code")},className:"toolbar-item spaced "+(k?"active":""),title:"Insert code block","aria-label":"Insert code block",children:m("i",{className:"format code"})}),m("button",{onClick:an,className:"toolbar-item spaced "+(d?"active":""),"aria-label":"Insert link",type:"Insert link",children:m("i",{className:"format link"})}),d&&Ie.exports.createPortal(m(xx,{editor:e}),document.body),m(Pt,{}),v(Hr,{buttonClassName:"toolbar-item spaced",buttonLabel:"Insert",buttonAriaLabel:"Insert specialized editor node",buttonIconClassName:"icon plus",children:[v("button",{onClick:()=>{e.dispatchCommand(_c)},className:"item",children:[m("i",{className:"icon horizontal-rule"}),m("span",{className:"text",children:"Horizontal Rule"})]}),v("button",{onClick:()=>{q("Insert Image",O=>m(pl,{activeEditor:e,onClose:O}))},className:"item",children:[m("i",{className:"icon image"}),m("span",{className:"text",children:"Image"})]}),v("button",{onClick:()=>ru({altText:"Cat typing on a laptop",src:V_}),className:"item",children:[m("i",{className:"icon gif"}),m("span",{className:"text",children:"GIF"})]}),v("button",{onClick:()=>{e.dispatchCommand(Kc)},className:"item",children:[m("i",{className:"icon diagram-2"}),m("span",{className:"text",children:"Excalidraw"})]}),v("button",{onClick:()=>{q("Insert Table",O=>m(ml,{activeEditor:e,onClose:O}))},className:"item",children:[m("i",{className:"icon table"}),m("span",{className:"text",children:"Table"})]}),v("button",{onClick:()=>{q("Insert Poll",O=>m(Ex,{activeEditor:e,onClose:O}))},className:"item",children:[m("i",{className:"icon poll"}),m("span",{className:"text",children:"Poll"})]}),v("button",{onClick:()=>{q("Insert Tweet",O=>m(Tx,{activeEditor:e,onClose:O}))},className:"item",children:[m("i",{className:"icon tweet"}),m("span",{className:"text",children:"Tweet"})]}),v("button",{onClick:()=>{q("Insert YouTube Video",O=>m(bx,{activeEditor:e,onClose:O}))},className:"item",children:[m("i",{className:"icon youtube"}),m("span",{className:"text",children:"YouTube Video"})]}),v("button",{onClick:()=>{q("Insert Equation",O=>m(xl,{activeEditor:e,onClose:O}))},className:"item",children:[m("i",{className:"icon equation"}),m("span",{className:"text",children:"Equation"})]}),v("button",{onClick:()=>{t.update(()=>{const O=se(),pe=ex(0,0);O.append(pe)})},className:"item",children:[m("i",{className:"icon sticky"}),m("span",{className:"text",children:"Sticky Note"})]})]})]}),m(Pt,{}),v(Hr,{buttonLabel:"Align",buttonIconClassName:"icon left-align",buttonClassName:"toolbar-item spaced alignment",buttonAriaLabel:"Formatting options for text alignment",children:[v("button",{onClick:()=>{e.dispatchCommand(Mt,"left")},className:"item",children:[m("i",{className:"icon left-align"}),m("span",{className:"text",children:"Left Align"})]}),v("button",{onClick:()=>{e.dispatchCommand(Mt,"center")},className:"item",children:[m("i",{className:"icon center-align"}),m("span",{className:"text",children:"Center Align"})]}),v("button",{onClick:()=>{e.dispatchCommand(Mt,"right")},className:"item",children:[m("i",{className:"icon right-align"}),m("span",{className:"text",children:"Right Align"})]}),v("button",{onClick:()=>{e.dispatchCommand(Mt,"justify")},className:"item",children:[m("i",{className:"icon justify-align"}),m("span",{className:"text",children:"Justify Align"})]}),m(Pt,{}),v("button",{onClick:()=>{e.dispatchCommand(yt)},className:"item",children:[m("i",{className:"icon "+(ne?"indent":"outdent")}),m("span",{className:"text",children:"Outdent"})]}),v("button",{onClick:()=>{e.dispatchCommand(ut)},className:"item",children:[m("i",{className:"icon "+(ne?"outdent":"indent")}),m("span",{className:"text",children:"Indent"})]})]}),H]})}const vx=window.parent!=null&&window.parent.frames.right===window;function Dx(){const t=se();if(t.getFirstChild()===null){const e=Ge("h1");e.append(K("Welcome to the playground")),t.append(e);const n=Jo();n.append(K("In case you were wondering what the black box at the bottom is \u2013 it's the debug view, showing the current state of editor. You can hide it by pressing on the settings control in the bottom-right of your screen and toggling the debug view setting.")),t.append(n);const o=U();o.append(K("The playground is a demo environment built with "),K("@lexical/react").toggleFormat("code"),K("."),K(" Try typing in "),K("some text").toggleFormat("bold"),K(" with "),K("different").toggleFormat("italic"),K(" formats.")),t.append(o);const r=U();r.append(K("Make sure to check out the various plugins in the toolbar. You can also use #hashtags or @-mentions too!")),t.append(r);const s=U();s.append(K("If you'd like to find out more about Lexical, you can:")),t.append(s);const i=Ke("ul");i.append(Ce().append(K("Visit the "),_t("https://lexical.dev/").append(K("Lexical website")),K(" for documentation and more information.")),Ce().append(K("Check out the code on our "),_t("https://github.com/facebook/lexical").append(K("GitHub repository")),K(".")),Ce().append(K("Playground code can be found "),_t("https://github.com/facebook/lexical/tree/main/packages/lexical-playground").append(K("here")),K(".")),Ce().append(K("Join our "),_t("https://discord.com/invite/KmG4wQnnD9").append(K("Discord Server")),K(" and chat with the team."))),t.append(i);const l=U();l.append(K("Lastly, we're constantly adding cool new features to this playground. So make sure you check back here when you next get a chance :).")),t.append(l)}}function Lx(){const{historyState:t}=ds(),{settings:{isCollab:e,isAutocomplete:n,isCharLimit:o,isCharLimitUtf8:r,isRichText:s,showTreeView:i,emptyEditor:l}}=cs(),c=m(Ss,{children:e?"Enter some collaborative rich text...":s?"Enter some rich text...":"Enter some plain text..."}),u=y.exports.useRef(null);return v(X,{children:[s&&m(kx,{}),v("div",{className:`editor-container ${i?"tree-view":""} ${s?"":"plain-text"}`,ref:u,children:[m(eh,{}),m(ph,{}),m(Mc,{}),m(Bm,{}),m(qa,{}),m(Hc,{}),m(Km,{}),m(sm,{}),m(xm,{}),m(Am,{}),m(th,{scrollRef:u}),s?v(X,{children:[e?m(_s,{id:"main",providerFactory:Ts,shouldBootstrap:!vx}):m(Oo,{externalHistoryState:t}),m(wc,{contentEditable:m(Io,{}),placeholder:"",initialEditorState:e?null:l?void 0:Dx}),m(Sp,{}),m(Em,{}),m(Yh,{}),m(I_,{maxDepth:7}),m(Dc,{}),m(Gc,{}),m(q_,{}),m(Xc,{}),m(Va,{}),m(U_,{}),m(ux,{}),m(hx,{}),m(ym,{})]}):v(X,{children:[m(Tc,{contentEditable:m(Io,{}),placeholder:c}),m(Oo,{externalHistoryState:t})]}),(o||r)&&m(gh,{charset:o?"UTF-16":"UTF-8"}),n&&m(um,{})]})]})}const Ox=[Yn,Zt,Qt,Gn,ct,kt,Ot,tn,Yt,St,bt,Lt,en,sn,Zn,rn,Qn,Jn,on,nn,Et,qt,Qo,eo,to],Ax=new Set(["insertText","insertCompositionText","insertFromComposition","insertLineBreak","insertParagraph","deleteCompositionText","deleteContentBackward","deleteByComposition","deleteContent","deleteContentForward","deleteWordBackward","deleteWordForward","deleteHardLineBackward","deleteSoftLineBackward","deleteHardLineForward","deleteSoftLineForward"]);function Px(){const t=Oc();return y.exports.useEffect(()=>{let e=0,n=null,o=null,r=[],s=!1;const i=function(){o!=null&&(s?s=!1:r.push(performance.now()-e),clearTimeout(o),o=null)},l=function(){n!=null&&(clearTimeout(n),n=null),o=window.setTimeout(i,0),n=setTimeout(()=>{const h=r.reduce((p,_)=>p+_,0),g="Typing Perf: "+Math.round(h/r.length*100)/100+"ms";t(g),r=[]},2e3),e=performance.now()},a=function(h){if(!Ax.has(h.inputType)||s){s=!1;return}l()},c=function(h){const g=h.keyCode;(g===8||g===13)&&l()},u=function(){s=!0},d=function(){s=!0};return window.addEventListener("keydown",c,!0),window.addEventListener("selectionchange",i,!0),window.addEventListener("beforeinput",a,!0),window.addEventListener("paste",u,!0),window.addEventListener("cut",d,!0),()=>{window.removeEventListener("keydown",c,!0),window.removeEventListener("selectionchange",i,!0),window.removeEventListener("beforeinput",a,!0),window.removeEventListener("paste",u,!0),window.removeEventListener("cut",d,!0)}},[t]),null}const Fx={characterLimit:"NetLexicalTheme__characterLimit",code:"NetLexicalTheme__code",codeHighlight:{atrule:"NetLexicalTheme__tokenAttr",attr:"NetLexicalTheme__tokenAttr",boolean:"NetLexicalTheme__tokenProperty",builtin:"NetLexicalTheme__tokenSelector",cdata:"NetLexicalTheme__tokenComment",char:"NetLexicalTheme__tokenSelector",class:"NetLexicalTheme__tokenFunction","class-name":"NetLexicalTheme__tokenFunction",comment:"NetLexicalTheme__tokenComment",constant:"NetLexicalTheme__tokenProperty",deleted:"NetLexicalTheme__tokenProperty",doctype:"NetLexicalTheme__tokenComment",entity:"NetLexicalTheme__tokenOperator",function:"NetLexicalTheme__tokenFunction",important:"NetLexicalTheme__tokenVariable",inserted:"NetLexicalTheme__tokenSelector",keyword:"NetLexicalTheme__tokenAttr",namespace:"NetLexicalTheme__tokenVariable",number:"NetLexicalTheme__tokenProperty",operator:"NetLexicalTheme__tokenOperator",prolog:"NetLexicalTheme__tokenComment",property:"NetLexicalTheme__tokenProperty",punctuation:"NetLexicalTheme__tokenPunctuation",regex:"NetLexicalTheme__tokenVariable",selector:"NetLexicalTheme__tokenSelector",string:"NetLexicalTheme__tokenSelector",symbol:"NetLexicalTheme__tokenProperty",tag:"NetLexicalTheme__tokenProperty",url:"NetLexicalTheme__tokenOperator",variable:"NetLexicalTheme__tokenVariable"},hashtag:"NetLexicalTheme__hashtag",heading:{h1:"NetLexicalTheme__h1",h2:"NetLexicalTheme__h2",h3:"NetLexicalTheme__h3",h4:"NetLexicalTheme__h4",h5:"NetLexicalTheme__h5"},image:"editor-image",link:"NetLexicalTheme__link",list:{listitem:"NetLexicalTheme__listItem",nested:{listitem:"NetLexicalTheme__nestedListItem"},olDepth:["NetLexicalTheme__ol1","NetLexicalTheme__ol2","NetLexicalTheme__ol3","NetLexicalTheme__ol4","NetLexicalTheme__ol5"],ul:"NetLexicalTheme__ul"},ltr:"NetLexicalTheme__ltr",paragraph:"NetLexicalTheme__paragraph",quote:"NetLexicalTheme__quote",rtl:"NetLexicalTheme__rtl",table:"NetLexicalTheme__table",tableCell:"NetLexicalTheme__tableCell",tableCellHeader:"NetLexicalTheme__tableCellHeader",text:{bold:"NetLexicalTheme__textBold",code:"NetLexicalTheme__textCode",italic:"NetLexicalTheme__textItalic",strikethrough:"NetLexicalTheme__textStrikethrough",underline:"NetLexicalTheme__textUnderline",underlineStrikethrough:"NetLexicalTheme__textUnderlineStrikethrough"}};function Mx(){const{settings:t}=cs(),{measureTypingPerf:e}=t,n={namespace:"PlaygroundEditor",nodes:[...Ox],onError:o=>{throw o},theme:Fx};return m(Lf,{initialConfig:n,children:v(Uf,{children:[m("div",{className:"editor-shell",children:m(Lx,{})}),e&&m(Px,{})]})})}function Rx(){return m(Of,{children:m(Mx,{})})}const ou=t=>{const e=customElements.get("vite-error-overlay");if(!e)return;const n=new e(t),o=document.body;o!==null&&o.appendChild(n)};window.addEventListener("error",ou);window.addEventListener("unhandledrejection",({reason:t})=>ou(t));Nu(document.getElementById("root")).render(m(Tu.StrictMode,{children:m(Rx,{})}));
